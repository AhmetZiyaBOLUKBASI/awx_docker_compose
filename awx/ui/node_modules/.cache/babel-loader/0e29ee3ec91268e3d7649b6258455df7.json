{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{useLocation}from'react-router-dom';import{Card}from'@patternfly/react-core';import{OrganizationsAPI}from'api';import{getQSConfig,parseQueryString}from'util/qs';import useRequest from'hooks/useRequest';import PaginatedTable,{HeaderRow,HeaderCell,getSearchableKeys}from'components/PaginatedTable';import DatalistToolbar from'components/DataListToolbar';import OrganizationExecEnvListItem from'./OrganizationExecEnvListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('organizations',{page:1,page_size:20,order_by:'name'});function OrganizationExecEnvList(_ref){var organization=_ref.organization;var id=organization.id;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _responseActions$data,_responseActions$data2;var params,_yield$Promise$all,_yield$Promise$all2,response,responseActions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([OrganizationsAPI.readExecutionEnvironments(id,params),OrganizationsAPI.readExecutionEnvironmentsOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);response=_yield$Promise$all2[0];responseActions=_yield$Promise$all2[1];return _context.abrupt(\"return\",{executionEnvironments:response.data.results,executionEnvironmentsCount:response.data.count,actions:responseActions.data.actions,relatedSearchableKeys:((responseActions===null||responseActions===void 0?void 0:(_responseActions$data=responseActions.data)===null||_responseActions$data===void 0?void 0:_responseActions$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_responseActions$data2=responseActions.data.actions)===null||_responseActions$data2===void 0?void 0:_responseActions$data2.GET)});case 8:case\"end\":return _context.stop();}}},_callee);})),[location,id]),{executionEnvironments:[],executionEnvironmentsCount:0,actions:{},relatedSearchableKeys:[],searchableKeys:[]}),contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchExecutionEnvironments=_useRequest.request,_useRequest$result=_useRequest.result,executionEnvironments=_useRequest$result.executionEnvironments,executionEnvironmentsCount=_useRequest$result.executionEnvironmentsCount,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys;useEffect(function(){fetchExecutionEnvironments();},[fetchExecutionEnvironments]);return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(PaginatedTable,{contentError:contentError,hasContentLoading:isLoading,items:executionEnvironments,itemCount:executionEnvironmentsCount,pluralizedItemName:/*i18n*/i18n._(\"Execution Environments\"),qsConfig:QS_CONFIG,toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Image\"),key:'image__icontains',isDefault:false},{name:/*i18n*/i18n._(\"Created By (Username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified By (Username)\"),key:'modified_by__username__icontains'}],renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DatalistToolbar,_objectSpread(_objectSpread({},props),{},{qsConfig:QS_CONFIG}));},headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"image\",children:/*i18n*/i18n._(\"Image\")})]}),renderRow:function renderRow(executionEnvironment,index){return/*#__PURE__*/_jsx(OrganizationExecEnvListItem,{executionEnvironment:executionEnvironment,detailUrl:\"/execution_environments/\".concat(executionEnvironment.id),rowIndex:index},executionEnvironment.id);}})});}export default OrganizationExecEnvList;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Organization/OrganizationExecEnvList/OrganizationExecEnvList.js"],"names":["React","useEffect","useCallback","useLocation","Card","OrganizationsAPI","getQSConfig","parseQueryString","useRequest","PaginatedTable","HeaderRow","HeaderCell","getSearchableKeys","DatalistToolbar","OrganizationExecEnvListItem","QS_CONFIG","page","page_size","order_by","OrganizationExecEnvList","organization","id","location","params","search","Promise","all","readExecutionEnvironments","readExecutionEnvironmentsOptions","response","responseActions","executionEnvironments","data","results","executionEnvironmentsCount","count","actions","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","GET","contentError","error","isLoading","fetchExecutionEnvironments","request","result","name","key","isDefault","props","executionEnvironment","index"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Card } from '@patternfly/react-core';\n\nimport { OrganizationsAPI } from 'api';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport DatalistToolbar from 'components/DataListToolbar';\n\nimport OrganizationExecEnvListItem from './OrganizationExecEnvListItem';\n\nconst QS_CONFIG = getQSConfig('organizations', {\n  page: 1,\n  page_size: 20,\n  order_by: 'name',\n});\n\nfunction OrganizationExecEnvList({ organization }) {\n  const { id } = organization;\n  const location = useLocation();\n\n  const {\n    error: contentError,\n    isLoading,\n    request: fetchExecutionEnvironments,\n    result: {\n      executionEnvironments,\n      executionEnvironmentsCount,\n      relatedSearchableKeys,\n      searchableKeys,\n    },\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n\n      const [response, responseActions] = await Promise.all([\n        OrganizationsAPI.readExecutionEnvironments(id, params),\n        OrganizationsAPI.readExecutionEnvironmentsOptions(id),\n      ]);\n\n      return {\n        executionEnvironments: response.data.results,\n        executionEnvironmentsCount: response.data.count,\n        actions: responseActions.data.actions,\n        relatedSearchableKeys: (\n          responseActions?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(responseActions.data.actions?.GET),\n      };\n    }, [location, id]),\n    {\n      executionEnvironments: [],\n      executionEnvironmentsCount: 0,\n      actions: {},\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchExecutionEnvironments();\n  }, [fetchExecutionEnvironments]);\n\n  return (\n    <Card>\n      <PaginatedTable\n        contentError={contentError}\n        hasContentLoading={isLoading}\n        items={executionEnvironments}\n        itemCount={executionEnvironmentsCount}\n        pluralizedItemName={t`Execution Environments`}\n        qsConfig={QS_CONFIG}\n        toolbarSearchableKeys={searchableKeys}\n        toolbarRelatedSearchableKeys={relatedSearchableKeys}\n        toolbarSearchColumns={[\n          {\n            name: t`Name`,\n            key: 'name__icontains',\n            isDefault: true,\n          },\n          {\n            name: t`Image`,\n            key: 'image__icontains',\n            isDefault: false,\n          },\n          {\n            name: t`Created By (Username)`,\n            key: 'created_by__username__icontains',\n          },\n          {\n            name: t`Modified By (Username)`,\n            key: 'modified_by__username__icontains',\n          },\n        ]}\n        renderToolbar={(props) => (\n          <DatalistToolbar {...props} qsConfig={QS_CONFIG} />\n        )}\n        headerRow={\n          <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n            <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n            <HeaderCell sortKey=\"image\">{t`Image`}</HeaderCell>\n          </HeaderRow>\n        }\n        renderRow={(executionEnvironment, index) => (\n          <OrganizationExecEnvListItem\n            key={executionEnvironment.id}\n            executionEnvironment={executionEnvironment}\n            detailUrl={`/execution_environments/${executionEnvironment.id}`}\n            rowIndex={index}\n          />\n        )}\n      />\n    </Card>\n  );\n}\n\nexport default OrganizationExecEnvList;\n"]},"metadata":{},"sourceType":"module"}