{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Link,Redirect,useRouteMatch}from'react-router-dom';import{Button}from'@patternfly/react-core';import{CaretLeftIcon}from'@patternfly/react-icons';import{CardBody,CardActionsRow}from'components/Card';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import{DetailList}from'components/DetailList';import RoutedTabs from'components/RoutedTabs';import{SettingsAPI}from'api';import useRequest from'hooks/useRequest';import{useConfig}from'contexts/Config';import{useSettings}from'contexts/Settings';import{SettingDetail}from'../../shared';import{sortNestedDetails}from'../../shared/settingUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function filterByPrefix(data,prefix){return Object.keys(data).filter(function(key){return key.includes(prefix);}).reduce(function(obj,key){obj[key]=data[key];return obj;},{});}function LDAPDetail(){var _Object$values;var _useConfig=useConfig(),me=_useConfig.me;var _useSettings=useSettings(),options=_useSettings.GET;var _useRouteMatch=useRouteMatch('/settings/ldap/:category/details'),path=_useRouteMatch.path,category=_useRouteMatch.params.category;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$SettingsAPI$re,data,mergedData,ldap1,ldap2,ldap3,ldap4,ldap5,ldapDefault;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SettingsAPI.readCategory('ldap');case 2:_yield$SettingsAPI$re=_context.sent;data=_yield$SettingsAPI$re.data;mergedData={};Object.keys(data).forEach(function(key){if(key.includes('_CONNECTION_OPTIONS')){return;}mergedData[key]=options[key];mergedData[key].value=data[key];});ldap1=filterByPrefix(mergedData,'AUTH_LDAP_1_');ldap2=filterByPrefix(mergedData,'AUTH_LDAP_2_');ldap3=filterByPrefix(mergedData,'AUTH_LDAP_3_');ldap4=filterByPrefix(mergedData,'AUTH_LDAP_4_');ldap5=filterByPrefix(mergedData,'AUTH_LDAP_5_');ldapDefault=_objectSpread({},mergedData);Object.keys(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},ldap1),ldap2),ldap3),ldap4),ldap5)).forEach(function(keyToOmit){delete ldapDefault[keyToOmit];});return _context.abrupt(\"return\",{default:sortNestedDetails(ldapDefault),1:sortNestedDetails(ldap1),2:sortNestedDetails(ldap2),3:sortNestedDetails(ldap3),4:sortNestedDetails(ldap4),5:sortNestedDetails(ldap5)});case 14:case\"end\":return _context.stop();}}},_callee);})),[options]),{default:null,1:null,2:null,3:null,4:null,5:null}),isLoading=_useRequest.isLoading,error=_useRequest.error,request=_useRequest.request,LDAPDetails=_useRequest.result;useEffect(function(){request();},[request]);var baseURL='/settings/ldap';var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Settings\")]}),link:\"/settings\",id:99},{name:/*i18n*/i18n._(\"Default\"),link:\"\".concat(baseURL,\"/default/details\"),id:0},{name:/*i18n*/i18n._(\"LDAP1\"),link:\"\".concat(baseURL,\"/1/details\"),id:1},{name:/*i18n*/i18n._(\"LDAP2\"),link:\"\".concat(baseURL,\"/2/details\"),id:2},{name:/*i18n*/i18n._(\"LDAP3\"),link:\"\".concat(baseURL,\"/3/details\"),id:3},{name:/*i18n*/i18n._(\"LDAP4\"),link:\"\".concat(baseURL,\"/4/details\"),id:4},{name:/*i18n*/i18n._(\"LDAP5\"),link:\"\".concat(baseURL,\"/5/details\"),id:5}];if(!Object.keys(LDAPDetails).includes(category)){return/*#__PURE__*/_jsx(Redirect,{from:path,to:\"\".concat(baseURL,\"/default/details\"),exact:true});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading&&/*#__PURE__*/_jsx(ContentLoading,{}),!isLoading&&error&&/*#__PURE__*/_jsx(ContentError,{error:error}),!isLoading&&!((_Object$values=Object.values(LDAPDetails))!==null&&_Object$values!==void 0&&_Object$values.includes(null))&&/*#__PURE__*/_jsx(DetailList,{children:LDAPDetails[category].map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],detail=_ref3[1];return/*#__PURE__*/_jsx(SettingDetail,{id:key,helpText:detail===null||detail===void 0?void 0:detail.help_text,label:detail===null||detail===void 0?void 0:detail.label,type:detail===null||detail===void 0?void 0:detail.type,unit:detail===null||detail===void 0?void 0:detail.unit,value:detail===null||detail===void 0?void 0:detail.value},key);})})]}),(me===null||me===void 0?void 0:me.is_superuser)&&/*#__PURE__*/_jsx(CardActionsRow,{children:/*#__PURE__*/_jsx(Button,{ouiaId:\"ldap-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"Edit\"),component:Link,to:\"\".concat(baseURL,\"/\").concat(category,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")})})]})]});}export default LDAPDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Setting/LDAP/LDAPDetail/LDAPDetail.js"],"names":["React","useEffect","useCallback","Link","Redirect","useRouteMatch","Button","CaretLeftIcon","CardBody","CardActionsRow","ContentError","ContentLoading","DetailList","RoutedTabs","SettingsAPI","useRequest","useConfig","useSettings","SettingDetail","sortNestedDetails","filterByPrefix","data","prefix","Object","keys","filter","key","includes","reduce","obj","LDAPDetail","me","options","GET","path","category","params","readCategory","mergedData","forEach","value","ldap1","ldap2","ldap3","ldap4","ldap5","ldapDefault","keyToOmit","default","isLoading","error","request","LDAPDetails","result","baseURL","tabsArray","name","link","id","values","map","detail","help_text","label","type","unit","is_superuser"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { Link, Redirect, useRouteMatch } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport { DetailList } from 'components/DetailList';\nimport RoutedTabs from 'components/RoutedTabs';\nimport { SettingsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport { useConfig } from 'contexts/Config';\nimport { useSettings } from 'contexts/Settings';\nimport { SettingDetail } from '../../shared';\nimport { sortNestedDetails } from '../../shared/settingUtils';\n\nfunction filterByPrefix(data, prefix) {\n  return Object.keys(data)\n    .filter((key) => key.includes(prefix))\n    .reduce((obj, key) => {\n      obj[key] = data[key];\n      return obj;\n    }, {});\n}\n\nfunction LDAPDetail() {\n  const { me } = useConfig();\n  const { GET: options } = useSettings();\n  const {\n    path,\n    params: { category },\n  } = useRouteMatch('/settings/ldap/:category/details');\n\n  const {\n    isLoading,\n    error,\n    request,\n    result: LDAPDetails,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await SettingsAPI.readCategory('ldap');\n\n      const mergedData = {};\n      Object.keys(data).forEach((key) => {\n        if (key.includes('_CONNECTION_OPTIONS')) {\n          return;\n        }\n        mergedData[key] = options[key];\n        mergedData[key].value = data[key];\n      });\n\n      const ldap1 = filterByPrefix(mergedData, 'AUTH_LDAP_1_');\n      const ldap2 = filterByPrefix(mergedData, 'AUTH_LDAP_2_');\n      const ldap3 = filterByPrefix(mergedData, 'AUTH_LDAP_3_');\n      const ldap4 = filterByPrefix(mergedData, 'AUTH_LDAP_4_');\n      const ldap5 = filterByPrefix(mergedData, 'AUTH_LDAP_5_');\n      const ldapDefault = { ...mergedData };\n      Object.keys({ ...ldap1, ...ldap2, ...ldap3, ...ldap4, ...ldap5 }).forEach(\n        (keyToOmit) => {\n          delete ldapDefault[keyToOmit];\n        }\n      );\n\n      return {\n        default: sortNestedDetails(ldapDefault),\n        1: sortNestedDetails(ldap1),\n        2: sortNestedDetails(ldap2),\n        3: sortNestedDetails(ldap3),\n        4: sortNestedDetails(ldap4),\n        5: sortNestedDetails(ldap5),\n      };\n    }, [options]),\n    {\n      default: null,\n      1: null,\n      2: null,\n      3: null,\n      4: null,\n      5: null,\n    }\n  );\n\n  useEffect(() => {\n    request();\n  }, [request]);\n\n  const baseURL = '/settings/ldap';\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Settings`}\n        </>\n      ),\n      link: `/settings`,\n      id: 99,\n    },\n    {\n      name: t`Default`,\n      link: `${baseURL}/default/details`,\n      id: 0,\n    },\n    {\n      name: t`LDAP1`,\n      link: `${baseURL}/1/details`,\n      id: 1,\n    },\n    {\n      name: t`LDAP2`,\n      link: `${baseURL}/2/details`,\n      id: 2,\n    },\n    {\n      name: t`LDAP3`,\n      link: `${baseURL}/3/details`,\n      id: 3,\n    },\n    {\n      name: t`LDAP4`,\n      link: `${baseURL}/4/details`,\n      id: 4,\n    },\n    {\n      name: t`LDAP5`,\n      link: `${baseURL}/5/details`,\n      id: 5,\n    },\n  ];\n\n  if (!Object.keys(LDAPDetails).includes(category)) {\n    return <Redirect from={path} to={`${baseURL}/default/details`} exact />;\n  }\n\n  return (\n    <>\n      <RoutedTabs tabsArray={tabsArray} />\n      <CardBody>\n        <>\n          {isLoading && <ContentLoading />}\n          {!isLoading && error && <ContentError error={error} />}\n          {!isLoading && !Object.values(LDAPDetails)?.includes(null) && (\n            <DetailList>\n              {LDAPDetails[category].map(([key, detail]) => (\n                <SettingDetail\n                  key={key}\n                  id={key}\n                  helpText={detail?.help_text}\n                  label={detail?.label}\n                  type={detail?.type}\n                  unit={detail?.unit}\n                  value={detail?.value}\n                />\n              ))}\n            </DetailList>\n          )}\n        </>\n        {me?.is_superuser && (\n          <CardActionsRow>\n            <Button\n              ouiaId=\"ldap-detail-edit-button\"\n              aria-label={t`Edit`}\n              component={Link}\n              to={`${baseURL}/${category}/edit`}\n            >\n              {t`Edit`}\n            </Button>\n          </CardActionsRow>\n        )}\n      </CardBody>\n    </>\n  );\n}\n\nexport default LDAPDetail;\n"]},"metadata":{},"sourceType":"module"}