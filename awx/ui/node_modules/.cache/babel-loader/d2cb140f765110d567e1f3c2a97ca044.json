{"ast":null,"code":"import _defineProperty from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;/* eslint-disable react/jsx-no-useless-fragment */import React,{useState}from'react';import{useHistory,useLocation}from'react-router-dom';import styled from'styled-components';import{Toolbar,ToolbarContent}from'@patternfly/react-core';import{parseQueryString,mergeParams,removeParams,updateQueryString}from'util/qs';import{QSConfig,SearchColumns,SortColumns,SearchableKeys}from'types';import DataListToolbar from'../DataListToolbar';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var EmptyStateControlsWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  margin-top: 20px;\\n  margin-right: 20px;\\n  margin-bottom: 20px;\\n  justify-content: flex-end;\\n\\n  & > :not(:first-child) {\\n    margin-left: 20px;\\n  }\\n\"])));function ListHeader(props){var _useLocation=useLocation(),search=_useLocation.search,pathname=_useLocation.pathname;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFilterCleared=_useState2[0],setIsFilterCleared=_useState2[1];var history=useHistory();var emptyStateControls=props.emptyStateControls,itemCount=props.itemCount,pagination=props.pagination,qsConfig=props.qsConfig,relatedSearchableKeys=props.relatedSearchableKeys,renderToolbar=props.renderToolbar,searchColumns=props.searchColumns,searchableKeys=props.searchableKeys,sortColumns=props.sortColumns;var handleSearch=function handleSearch(key,value){var params=parseQueryString(qsConfig,search);var qs=updateQueryString(qsConfig,search,_objectSpread(_objectSpread({},mergeParams(params,_defineProperty({},key,value))),{},{page:1}));pushHistoryState(qs);};var handleReplaceSearch=function handleReplaceSearch(key,value){var qs=updateQueryString(qsConfig,search,_defineProperty({},key,value));pushHistoryState(qs);};var handleRemove=function handleRemove(key,value){var oldParams=parseQueryString(qsConfig,search);var updatedParams=removeParams(qsConfig,oldParams,_defineProperty({},key,value));var qs=updateQueryString(qsConfig,search,updatedParams);pushHistoryState(qs);};var handleRemoveAll=function handleRemoveAll(){var oldParams=parseQueryString(qsConfig,search);Object.keys(oldParams).forEach(function(key){oldParams[key]=null;});delete oldParams.page_size;delete oldParams.order_by;var qs=updateQueryString(qsConfig,search,oldParams);setIsFilterCleared(true);pushHistoryState(qs);};var handleSort=function handleSort(key,order){var qs=updateQueryString(qsConfig,search,{order_by:order==='ascending'?key:\"-\".concat(key),page:null});pushHistoryState(qs);};var pushHistoryState=function pushHistoryState(queryString){history.push(queryString?\"\".concat(pathname,\"?\").concat(queryString):pathname);};var params=parseQueryString(qsConfig,search);var isEmpty=itemCount===0&&Object.keys(params).length===0;return/*#__PURE__*/_jsx(_Fragment,{children:isEmpty?/*#__PURE__*/_jsx(Toolbar,{id:\"\".concat(qsConfig.namespace,\"-list-toolbar\"),clearAllFilters:handleRemoveAll,collapseListedFiltersBreakpoint:\"lg\",ouiaId:\"\".concat(qsConfig.namespace,\"-list-toolbar\"),children:/*#__PURE__*/_jsx(ToolbarContent,{children:/*#__PURE__*/_jsx(EmptyStateControlsWrapper,{children:emptyStateControls})})}):/*#__PURE__*/_jsx(_Fragment,{children:renderToolbar({itemCount:itemCount,searchColumns:searchColumns,sortColumns:sortColumns,searchableKeys:searchableKeys,relatedSearchableKeys:relatedSearchableKeys,onSearch:handleSearch,onReplaceSearch:handleReplaceSearch,onSort:handleSort,onRemove:handleRemove,clearAllFilters:handleRemoveAll,qsConfig:qsConfig,pagination:pagination,isFilterCleared:isFilterCleared})})});}ListHeader.defaultProps={renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DataListToolbar,_objectSpread({},props));},searchableKeys:[],sortColumns:null,relatedSearchableKeys:[]};export default ListHeader;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/ListHeader/ListHeader.js"],"names":["React","useState","useHistory","useLocation","styled","Toolbar","ToolbarContent","parseQueryString","mergeParams","removeParams","updateQueryString","QSConfig","SearchColumns","SortColumns","SearchableKeys","DataListToolbar","EmptyStateControlsWrapper","div","ListHeader","props","search","pathname","isFilterCleared","setIsFilterCleared","history","emptyStateControls","itemCount","pagination","qsConfig","relatedSearchableKeys","renderToolbar","searchColumns","searchableKeys","sortColumns","handleSearch","key","value","params","qs","page","pushHistoryState","handleReplaceSearch","handleRemove","oldParams","updatedParams","handleRemoveAll","Object","keys","forEach","page_size","order_by","handleSort","order","queryString","push","isEmpty","length","namespace","onSearch","onReplaceSearch","onSort","onRemove","clearAllFilters","defaultProps"],"mappings":"icAAA,kDACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,OAASC,UAAT,CAAqBC,WAArB,KAAwC,kBAAxC,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAASC,OAAT,CAAkBC,cAAlB,KAAwC,wBAAxC,CAEA,OACEC,gBADF,CAEEC,WAFF,CAGEC,YAHF,CAIEC,iBAJF,KAKO,SALP,CAMA,OAASC,QAAT,CAAmBC,aAAnB,CAAkCC,WAAlC,CAA+CC,cAA/C,KAAqE,OAArE,CACA,MAAOC,CAAAA,eAAP,KAA4B,oBAA5B,C,gGAEA,GAAMC,CAAAA,yBAAyB,CAAGZ,MAAM,CAACa,GAAV,kPAA/B,CAWA,QAASC,CAAAA,UAAT,CAAoBC,KAApB,CAA2B,CACzB,iBAA6BhB,WAAW,EAAxC,CAAQiB,MAAR,cAAQA,MAAR,CAAgBC,QAAhB,cAAgBA,QAAhB,CACA,cAA8CpB,QAAQ,CAAC,KAAD,CAAtD,wCAAOqB,eAAP,eAAwBC,kBAAxB,eACA,GAAMC,CAAAA,OAAO,CAAGtB,UAAU,EAA1B,CACA,GACEuB,CAAAA,kBADF,CAUIN,KAVJ,CACEM,kBADF,CAEEC,SAFF,CAUIP,KAVJ,CAEEO,SAFF,CAGEC,UAHF,CAUIR,KAVJ,CAGEQ,UAHF,CAIEC,QAJF,CAUIT,KAVJ,CAIES,QAJF,CAKEC,qBALF,CAUIV,KAVJ,CAKEU,qBALF,CAMEC,aANF,CAUIX,KAVJ,CAMEW,aANF,CAOEC,aAPF,CAUIZ,KAVJ,CAOEY,aAPF,CAQEC,cARF,CAUIb,KAVJ,CAQEa,cARF,CASEC,WATF,CAUId,KAVJ,CASEc,WATF,CAYA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,GAAD,CAAMC,KAAN,CAAgB,CACnC,GAAMC,CAAAA,MAAM,CAAG9B,gBAAgB,CAACqB,QAAD,CAAWR,MAAX,CAA/B,CACA,GAAMkB,CAAAA,EAAE,CAAG5B,iBAAiB,CAACkB,QAAD,CAAWR,MAAX,gCACvBZ,WAAW,CAAC6B,MAAD,oBAAYF,GAAZ,CAAkBC,KAAlB,EADY,MAE1BG,IAAI,CAAE,CAFoB,GAA5B,CAIAC,gBAAgB,CAACF,EAAD,CAAhB,CACD,CAPD,CASA,GAAMG,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACN,GAAD,CAAMC,KAAN,CAAgB,CAC1C,GAAME,CAAAA,EAAE,CAAG5B,iBAAiB,CAACkB,QAAD,CAAWR,MAAX,oBACzBe,GADyB,CACnBC,KADmB,EAA5B,CAGAI,gBAAgB,CAACF,EAAD,CAAhB,CACD,CALD,CAOA,GAAMI,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACP,GAAD,CAAMC,KAAN,CAAgB,CACnC,GAAMO,CAAAA,SAAS,CAAGpC,gBAAgB,CAACqB,QAAD,CAAWR,MAAX,CAAlC,CACA,GAAMwB,CAAAA,aAAa,CAAGnC,YAAY,CAACmB,QAAD,CAAWe,SAAX,oBAC/BR,GAD+B,CACzBC,KADyB,EAAlC,CAGA,GAAME,CAAAA,EAAE,CAAG5B,iBAAiB,CAACkB,QAAD,CAAWR,MAAX,CAAmBwB,aAAnB,CAA5B,CACAJ,gBAAgB,CAACF,EAAD,CAAhB,CACD,CAPD,CASA,GAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5B,GAAMF,CAAAA,SAAS,CAAGpC,gBAAgB,CAACqB,QAAD,CAAWR,MAAX,CAAlC,CACA0B,MAAM,CAACC,IAAP,CAAYJ,SAAZ,EAAuBK,OAAvB,CAA+B,SAACb,GAAD,CAAS,CACtCQ,SAAS,CAACR,GAAD,CAAT,CAAiB,IAAjB,CACD,CAFD,EAGA,MAAOQ,CAAAA,SAAS,CAACM,SAAjB,CACA,MAAON,CAAAA,SAAS,CAACO,QAAjB,CACA,GAAMZ,CAAAA,EAAE,CAAG5B,iBAAiB,CAACkB,QAAD,CAAWR,MAAX,CAAmBuB,SAAnB,CAA5B,CACApB,kBAAkB,CAAC,IAAD,CAAlB,CACAiB,gBAAgB,CAACF,EAAD,CAAhB,CACD,CAVD,CAYA,GAAMa,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAChB,GAAD,CAAMiB,KAAN,CAAgB,CACjC,GAAMd,CAAAA,EAAE,CAAG5B,iBAAiB,CAACkB,QAAD,CAAWR,MAAX,CAAmB,CAC7C8B,QAAQ,CAAEE,KAAK,GAAK,WAAV,CAAwBjB,GAAxB,YAAkCA,GAAlC,CADmC,CAE7CI,IAAI,CAAE,IAFuC,CAAnB,CAA5B,CAIAC,gBAAgB,CAACF,EAAD,CAAhB,CACD,CAND,CAQA,GAAME,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACa,WAAD,CAAiB,CACxC7B,OAAO,CAAC8B,IAAR,CAAaD,WAAW,WAAMhC,QAAN,aAAkBgC,WAAlB,EAAkChC,QAA1D,EACD,CAFD,CAIA,GAAMgB,CAAAA,MAAM,CAAG9B,gBAAgB,CAACqB,QAAD,CAAWR,MAAX,CAA/B,CACA,GAAMmC,CAAAA,OAAO,CAAG7B,SAAS,GAAK,CAAd,EAAmBoB,MAAM,CAACC,IAAP,CAAYV,MAAZ,EAAoBmB,MAApB,GAA+B,CAAlE,CACA,mBACE,yBACGD,OAAO,cACN,KAAC,OAAD,EACE,EAAE,WAAK3B,QAAQ,CAAC6B,SAAd,iBADJ,CAEE,eAAe,CAAEZ,eAFnB,CAGE,+BAA+B,CAAC,IAHlC,CAIE,MAAM,WAAKjB,QAAQ,CAAC6B,SAAd,iBAJR,uBAME,KAAC,cAAD,wBACE,KAAC,yBAAD,WACGhC,kBADH,EADF,EANF,EADM,cAcN,yBACGK,aAAa,CAAC,CACbJ,SAAS,CAATA,SADa,CAEbK,aAAa,CAAbA,aAFa,CAGbE,WAAW,CAAXA,WAHa,CAIbD,cAAc,CAAdA,cAJa,CAKbH,qBAAqB,CAArBA,qBALa,CAMb6B,QAAQ,CAAExB,YANG,CAObyB,eAAe,CAAElB,mBAPJ,CAQbmB,MAAM,CAAET,UARK,CASbU,QAAQ,CAAEnB,YATG,CAUboB,eAAe,CAAEjB,eAVJ,CAWbjB,QAAQ,CAARA,QAXa,CAYbD,UAAU,CAAVA,UAZa,CAabL,eAAe,CAAfA,eAba,CAAD,CADhB,EAfJ,EADF,CAoCD,CAYDJ,UAAU,CAAC6C,YAAX,CAA0B,CACxBjC,aAAa,CAAE,uBAACX,KAAD,qBAAW,KAAC,eAAD,kBAAqBA,KAArB,EAAX,EADS,CAExBa,cAAc,CAAE,EAFQ,CAGxBC,WAAW,CAAE,IAHW,CAIxBJ,qBAAqB,CAAE,EAJC,CAA1B,CAOA,cAAeX,CAAAA,UAAf","sourcesContent":["/* eslint-disable react/jsx-no-useless-fragment */\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { Toolbar, ToolbarContent } from '@patternfly/react-core';\n\nimport {\n  parseQueryString,\n  mergeParams,\n  removeParams,\n  updateQueryString,\n} from 'util/qs';\nimport { QSConfig, SearchColumns, SortColumns, SearchableKeys } from 'types';\nimport DataListToolbar from '../DataListToolbar';\n\nconst EmptyStateControlsWrapper = styled.div`\n  display: flex;\n  margin-top: 20px;\n  margin-right: 20px;\n  margin-bottom: 20px;\n  justify-content: flex-end;\n\n  & > :not(:first-child) {\n    margin-left: 20px;\n  }\n`;\nfunction ListHeader(props) {\n  const { search, pathname } = useLocation();\n  const [isFilterCleared, setIsFilterCleared] = useState(false);\n  const history = useHistory();\n  const {\n    emptyStateControls,\n    itemCount,\n    pagination,\n    qsConfig,\n    relatedSearchableKeys,\n    renderToolbar,\n    searchColumns,\n    searchableKeys,\n    sortColumns,\n  } = props;\n\n  const handleSearch = (key, value) => {\n    const params = parseQueryString(qsConfig, search);\n    const qs = updateQueryString(qsConfig, search, {\n      ...mergeParams(params, { [key]: value }),\n      page: 1,\n    });\n    pushHistoryState(qs);\n  };\n\n  const handleReplaceSearch = (key, value) => {\n    const qs = updateQueryString(qsConfig, search, {\n      [key]: value,\n    });\n    pushHistoryState(qs);\n  };\n\n  const handleRemove = (key, value) => {\n    const oldParams = parseQueryString(qsConfig, search);\n    const updatedParams = removeParams(qsConfig, oldParams, {\n      [key]: value,\n    });\n    const qs = updateQueryString(qsConfig, search, updatedParams);\n    pushHistoryState(qs);\n  };\n\n  const handleRemoveAll = () => {\n    const oldParams = parseQueryString(qsConfig, search);\n    Object.keys(oldParams).forEach((key) => {\n      oldParams[key] = null;\n    });\n    delete oldParams.page_size;\n    delete oldParams.order_by;\n    const qs = updateQueryString(qsConfig, search, oldParams);\n    setIsFilterCleared(true);\n    pushHistoryState(qs);\n  };\n\n  const handleSort = (key, order) => {\n    const qs = updateQueryString(qsConfig, search, {\n      order_by: order === 'ascending' ? key : `-${key}`,\n      page: null,\n    });\n    pushHistoryState(qs);\n  };\n\n  const pushHistoryState = (queryString) => {\n    history.push(queryString ? `${pathname}?${queryString}` : pathname);\n  };\n\n  const params = parseQueryString(qsConfig, search);\n  const isEmpty = itemCount === 0 && Object.keys(params).length === 0;\n  return (\n    <>\n      {isEmpty ? (\n        <Toolbar\n          id={`${qsConfig.namespace}-list-toolbar`}\n          clearAllFilters={handleRemoveAll}\n          collapseListedFiltersBreakpoint=\"lg\"\n          ouiaId={`${qsConfig.namespace}-list-toolbar`}\n        >\n          <ToolbarContent>\n            <EmptyStateControlsWrapper>\n              {emptyStateControls}\n            </EmptyStateControlsWrapper>\n          </ToolbarContent>\n        </Toolbar>\n      ) : (\n        <>\n          {renderToolbar({\n            itemCount,\n            searchColumns,\n            sortColumns,\n            searchableKeys,\n            relatedSearchableKeys,\n            onSearch: handleSearch,\n            onReplaceSearch: handleReplaceSearch,\n            onSort: handleSort,\n            onRemove: handleRemove,\n            clearAllFilters: handleRemoveAll,\n            qsConfig,\n            pagination,\n            isFilterCleared,\n          })}\n        </>\n      )}\n    </>\n  );\n}\n\nListHeader.propTypes = {\n  itemCount: PropTypes.number.isRequired,\n  qsConfig: QSConfig.isRequired,\n  searchColumns: SearchColumns.isRequired,\n  searchableKeys: SearchableKeys,\n  relatedSearchableKeys: PropTypes.arrayOf(PropTypes.string),\n  sortColumns: SortColumns,\n  renderToolbar: PropTypes.func,\n};\n\nListHeader.defaultProps = {\n  renderToolbar: (props) => <DataListToolbar {...props} />,\n  searchableKeys: [],\n  sortColumns: null,\n  relatedSearchableKeys: [],\n};\n\nexport default ListHeader;\n"]},"metadata":{},"sourceType":"module"}