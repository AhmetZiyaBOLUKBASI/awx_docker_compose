{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState,useCallback}from'react';import{string,bool,func}from'prop-types';import{Link}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Tr,Td}from'@patternfly/react-table';import{PencilAltIcon}from'@patternfly/react-icons';import{ActionsTd,ActionItem,TdBreakWord}from'components/PaginatedTable';import CopyButton from'components/CopyButton';import{ExecutionEnvironment}from'types';import{ExecutionEnvironmentsAPI}from'api';import{timeOfDay}from'util/dates';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ExecutionEnvironmentListItem(_ref){var _executionEnvironment,_executionEnvironment2,_executionEnvironment3,_executionEnvironment4;var executionEnvironment=_ref.executionEnvironment,detailUrl=_ref.detailUrl,isSelected=_ref.isSelected,onSelect=_ref.onSelect,onCopy=_ref.onCopy,rowIndex=_ref.rowIndex,fetchExecutionEnvironments=_ref.fetchExecutionEnvironments;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDisabled=_useState2[0],setIsDisabled=_useState2[1];var copyExecutionEnvironment=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ExecutionEnvironmentsAPI.copy(executionEnvironment.id,{name:\"\".concat(executionEnvironment.name,\" @ \").concat(timeOfDay())});case 2:response=_context.sent;if(response.status===201){onCopy(response.data.id);}_context.next=6;return fetchExecutionEnvironments();case 6:case\"end\":return _context.stop();}}},_callee);})),[executionEnvironment.id,executionEnvironment.name,fetchExecutionEnvironments,onCopy]);var handleCopyStart=useCallback(function(){setIsDisabled(true);},[]);var handleCopyFinish=useCallback(function(){setIsDisabled(false);},[]);return/*#__PURE__*/_jsxs(Tr,{id:\"ee-row-\".concat(executionEnvironment.id),ouiaId:\"ee-row-\".concat(executionEnvironment.id),children:[/*#__PURE__*/_jsx(Td,{select:{rowIndex:rowIndex,isSelected:isSelected,onSelect:onSelect,disable:false},dataLabel:/*i18n*/i18n._(\"Selected\")}),/*#__PURE__*/_jsx(TdBreakWord,{id:\"ee-name-\".concat(executionEnvironment.id),dataLabel:/*i18n*/i18n._(\"Name\"),children:/*#__PURE__*/_jsx(Link,{to:\"\".concat(detailUrl),children:/*#__PURE__*/_jsx(\"b\",{children:executionEnvironment.name})})}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Image\"),children:executionEnvironment.image}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Organization\"),children:executionEnvironment.organization?/*#__PURE__*/_jsx(Link,{to:\"/organizations/\".concat(executionEnvironment===null||executionEnvironment===void 0?void 0:(_executionEnvironment=executionEnvironment.summary_fields)===null||_executionEnvironment===void 0?void 0:(_executionEnvironment2=_executionEnvironment.organization)===null||_executionEnvironment2===void 0?void 0:_executionEnvironment2.id,\"/details\"),children:/*#__PURE__*/_jsx(\"b\",{children:executionEnvironment===null||executionEnvironment===void 0?void 0:(_executionEnvironment3=executionEnvironment.summary_fields)===null||_executionEnvironment3===void 0?void 0:(_executionEnvironment4=_executionEnvironment3.organization)===null||_executionEnvironment4===void 0?void 0:_executionEnvironment4.name})}):/*i18n*/i18n._(\"Globally Available\")}),/*#__PURE__*/_jsxs(ActionsTd,{dataLabel:/*i18n*/i18n._(\"Actions\"),gridColumns:\"auto 40px\",children:[/*#__PURE__*/_jsx(ActionItem,{visible:executionEnvironment.summary_fields.user_capabilities.edit,tooltip:/*i18n*/i18n._(\"Edit Execution Environment\"),children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(executionEnvironment.id,\"-edit-button\"),\"aria-label\":/*i18n*/i18n._(\"Edit Execution Environment\"),variant:\"plain\",component:Link,to:\"/execution_environments/\".concat(executionEnvironment.id,\"/edit\"),children:/*#__PURE__*/_jsx(PencilAltIcon,{})})}),/*#__PURE__*/_jsx(ActionItem,{visible:executionEnvironment.summary_fields.user_capabilities.copy,tooltip:/*i18n*/i18n._(\"Copy Execution Environment\"),children:/*#__PURE__*/_jsx(CopyButton,{ouiaId:\"copy-ee-\".concat(executionEnvironment.id),isDisabled:isDisabled,onCopyStart:handleCopyStart,onCopyFinish:handleCopyFinish,copyItem:copyExecutionEnvironment,errorMessage:/*i18n*/i18n._(\"Failed to copy execution environment\")})})]})]});}ExecutionEnvironmentListItem.prototype={executionEnvironment:ExecutionEnvironment.isRequired,detailUrl:string.isRequired,isSelected:bool.isRequired,onSelect:func.isRequired,onCopy:func.isRequired};export default ExecutionEnvironmentListItem;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/ExecutionEnvironment/ExecutionEnvironmentList/ExecutionEnvironmentListItem.js"],"names":["React","useState","useCallback","string","bool","func","Link","Button","Tr","Td","PencilAltIcon","ActionsTd","ActionItem","TdBreakWord","CopyButton","ExecutionEnvironment","ExecutionEnvironmentsAPI","timeOfDay","ExecutionEnvironmentListItem","executionEnvironment","detailUrl","isSelected","onSelect","onCopy","rowIndex","fetchExecutionEnvironments","isDisabled","setIsDisabled","copyExecutionEnvironment","copy","id","name","response","status","data","handleCopyStart","handleCopyFinish","disable","image","organization","summary_fields","user_capabilities","edit","prototype","isRequired"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { string, bool, func } from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport { Link } from 'react-router-dom';\nimport { Button } from '@patternfly/react-core';\nimport { Tr, Td } from '@patternfly/react-table';\nimport { PencilAltIcon } from '@patternfly/react-icons';\n\nimport { ActionsTd, ActionItem, TdBreakWord } from 'components/PaginatedTable';\nimport CopyButton from 'components/CopyButton';\nimport { ExecutionEnvironment } from 'types';\nimport { ExecutionEnvironmentsAPI } from 'api';\nimport { timeOfDay } from 'util/dates';\n\nfunction ExecutionEnvironmentListItem({\n  executionEnvironment,\n  detailUrl,\n  isSelected,\n  onSelect,\n  onCopy,\n  rowIndex,\n  fetchExecutionEnvironments,\n}) {\n  const [isDisabled, setIsDisabled] = useState(false);\n\n  const copyExecutionEnvironment = useCallback(async () => {\n    const response = await ExecutionEnvironmentsAPI.copy(\n      executionEnvironment.id,\n      {\n        name: `${executionEnvironment.name} @ ${timeOfDay()}`,\n      }\n    );\n    if (response.status === 201) {\n      onCopy(response.data.id);\n    }\n    await fetchExecutionEnvironments();\n  }, [\n    executionEnvironment.id,\n    executionEnvironment.name,\n    fetchExecutionEnvironments,\n    onCopy,\n  ]);\n\n  const handleCopyStart = useCallback(() => {\n    setIsDisabled(true);\n  }, []);\n\n  const handleCopyFinish = useCallback(() => {\n    setIsDisabled(false);\n  }, []);\n\n  return (\n    <Tr\n      id={`ee-row-${executionEnvironment.id}`}\n      ouiaId={`ee-row-${executionEnvironment.id}`}\n    >\n      <Td\n        select={{\n          rowIndex,\n          isSelected,\n          onSelect,\n          disable: false,\n        }}\n        dataLabel={t`Selected`}\n      />\n      <TdBreakWord\n        id={`ee-name-${executionEnvironment.id}`}\n        dataLabel={t`Name`}\n      >\n        <Link to={`${detailUrl}`}>\n          <b>{executionEnvironment.name}</b>\n        </Link>\n      </TdBreakWord>\n      <Td dataLabel={t`Image`}>{executionEnvironment.image}</Td>\n      <Td dataLabel={t`Organization`}>\n        {executionEnvironment.organization ? (\n          <Link\n            to={`/organizations/${executionEnvironment?.summary_fields?.organization?.id}/details`}\n          >\n            <b>{executionEnvironment?.summary_fields?.organization?.name}</b>\n          </Link>\n        ) : (\n          t`Globally Available`\n        )}\n      </Td>\n      <ActionsTd dataLabel={t`Actions`} gridColumns=\"auto 40px\">\n        <ActionItem\n          visible={executionEnvironment.summary_fields.user_capabilities.edit}\n          tooltip={t`Edit Execution Environment`}\n        >\n          <Button\n            ouiaId={`${executionEnvironment.id}-edit-button`}\n            aria-label={t`Edit Execution Environment`}\n            variant=\"plain\"\n            component={Link}\n            to={`/execution_environments/${executionEnvironment.id}/edit`}\n          >\n            <PencilAltIcon />\n          </Button>\n        </ActionItem>\n        <ActionItem\n          visible={executionEnvironment.summary_fields.user_capabilities.copy}\n          tooltip={t`Copy Execution Environment`}\n        >\n          <CopyButton\n            ouiaId={`copy-ee-${executionEnvironment.id}`}\n            isDisabled={isDisabled}\n            onCopyStart={handleCopyStart}\n            onCopyFinish={handleCopyFinish}\n            copyItem={copyExecutionEnvironment}\n            errorMessage={t`Failed to copy execution environment`}\n          />\n        </ActionItem>\n      </ActionsTd>\n    </Tr>\n  );\n}\n\nExecutionEnvironmentListItem.prototype = {\n  executionEnvironment: ExecutionEnvironment.isRequired,\n  detailUrl: string.isRequired,\n  isSelected: bool.isRequired,\n  onSelect: func.isRequired,\n  onCopy: func.isRequired,\n};\n\nexport default ExecutionEnvironmentListItem;\n"]},"metadata":{},"sourceType":"module"}