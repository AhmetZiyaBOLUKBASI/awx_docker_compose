{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useCallback}from'react';import{useHistory}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import{CardBody}from'components/Card';import{InstanceGroupsAPI}from'api';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import ContainerGroupForm from'../shared/ContainerGroupForm';import{jsx as _jsx}from\"react/jsx-runtime\";function ContainerGroupEdit(_ref){var instanceGroup=_ref.instanceGroup;var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),submitError=_useState2[0],setSubmitError=_useState2[1];var detailsIUrl=\"/instance_groups/container_group/\".concat(instanceGroup.id,\"/details\");var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InstanceGroups,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InstanceGroupsAPI.readOptions();case 2:_yield$InstanceGroups=_context.sent;data=_yield$InstanceGroups.data;return _context.abrupt(\"return\",data.actions.POST.pod_spec_override.default);case 5:case\"end\":return _context.stop();}}},_callee);})),[]),{initialPodSpec:{}}),fetchError=_useRequest.error,isLoading=_useRequest.isLoading,fetchInitialPodSpec=_useRequest.request,initialPodSpec=_useRequest.result;useEffect(function(){fetchInitialPodSpec();},[fetchInitialPodSpec]);var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return InstanceGroupsAPI.update(instanceGroup.id,{name:values.name,credential:values.credential?values.credential.id:null,pod_spec_override:values.override?values.pod_spec_override:null,is_container_group:true});case 3:history.push(detailsIUrl);_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);setSubmitError(_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(detailsIUrl);};if(fetchError){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentError,{error:fetchError})})})});}if(isLoading){return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentLoading,{})});}return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContainerGroupForm,{instanceGroup:instanceGroup,initialPodSpec:initialPodSpec,onSubmit:handleSubmit,submitError:submitError,onCancel:handleCancel})});}export default ContainerGroupEdit;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/InstanceGroup/ContainerGroupEdit/ContainerGroupEdit.js"],"names":["React","useState","useEffect","useCallback","useHistory","Card","PageSection","CardBody","InstanceGroupsAPI","useRequest","ContentError","ContentLoading","ContainerGroupForm","ContainerGroupEdit","instanceGroup","history","submitError","setSubmitError","detailsIUrl","id","readOptions","data","actions","POST","pod_spec_override","default","initialPodSpec","fetchError","error","isLoading","fetchInitialPodSpec","request","result","handleSubmit","values","update","name","credential","override","is_container_group","push","handleCancel"],"mappings":"wTAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,IAAT,CAAeC,WAAf,KAAkC,wBAAlC,CAEA,OAASC,QAAT,KAAyB,iBAAzB,CACA,OAASC,iBAAT,KAAkC,KAAlC,CACA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,yBAAzB,CACA,MAAOC,CAAAA,cAAP,KAA2B,2BAA3B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,8BAA/B,C,2CAEA,QAASC,CAAAA,kBAAT,MAA+C,IAAjBC,CAAAA,aAAiB,MAAjBA,aAAiB,CAC7C,GAAMC,CAAAA,OAAO,CAAGX,UAAU,EAA1B,CACA,cAAsCH,QAAQ,CAAC,IAAD,CAA9C,wCAAOe,WAAP,eAAoBC,cAApB,eACA,GAAMC,CAAAA,WAAW,4CAAuCJ,aAAa,CAACK,EAArD,YAAjB,CAEA,gBAKIV,UAAU,CACZN,WAAW,sEAAC,wLACaK,CAAAA,iBAAiB,CAACY,WAAlB,EADb,4CACFC,IADE,uBACFA,IADE,iCAEHA,IAAI,CAACC,OAAL,CAAaC,IAAb,CAAkBC,iBAAlB,CAAoCC,OAFjC,wDAAD,GAGR,EAHQ,CADC,CAKZ,CACEC,cAAc,CAAE,EADlB,CALY,CALd,CACSC,UADT,aACEC,KADF,CAEEC,SAFF,aAEEA,SAFF,CAGWC,mBAHX,aAGEC,OAHF,CAIUL,cAJV,aAIEM,MAJF,CAeA9B,SAAS,CAAC,UAAM,CACd4B,mBAAmB,GACpB,CAFQ,CAEN,CAACA,mBAAD,CAFM,CAAT,CAIA,GAAMG,CAAAA,YAAY,2FAAG,kBAAOC,MAAP,8JAEX1B,CAAAA,iBAAiB,CAAC2B,MAAlB,CAAyBrB,aAAa,CAACK,EAAvC,CAA2C,CAC/CiB,IAAI,CAAEF,MAAM,CAACE,IADkC,CAE/CC,UAAU,CAAEH,MAAM,CAACG,UAAP,CAAoBH,MAAM,CAACG,UAAP,CAAkBlB,EAAtC,CAA2C,IAFR,CAG/CK,iBAAiB,CAAEU,MAAM,CAACI,QAAP,CAAkBJ,MAAM,CAACV,iBAAzB,CAA6C,IAHjB,CAI/Ce,kBAAkB,CAAE,IAJ2B,CAA3C,CAFW,QAQjBxB,OAAO,CAACyB,IAAR,CAAatB,WAAb,EARiB,kFAUjBD,cAAc,cAAd,CAViB,qEAAH,kBAAZgB,CAAAA,YAAY,6CAAlB,CAaA,GAAMQ,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB1B,OAAO,CAACyB,IAAR,CAAatB,WAAb,EACD,CAFD,CAIA,GAAIS,UAAJ,CAAgB,CACd,mBACE,KAAC,WAAD,wBACE,KAAC,IAAD,wBACE,KAAC,QAAD,wBACE,KAAC,YAAD,EAAc,KAAK,CAAEA,UAArB,EADF,EADF,EADF,EADF,CASD,CAED,GAAIE,SAAJ,CAAe,CACb,mBACE,KAAC,QAAD,wBACE,KAAC,cAAD,IADF,EADF,CAKD,CAED,mBACE,KAAC,QAAD,wBACE,KAAC,kBAAD,EACE,aAAa,CAAEf,aADjB,CAEE,cAAc,CAAEY,cAFlB,CAGE,QAAQ,CAAEO,YAHZ,CAIE,WAAW,CAAEjB,WAJf,CAKE,QAAQ,CAAEyB,YALZ,EADF,EADF,CAWD,CAED,cAAe5B,CAAAA,kBAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { Card, PageSection } from '@patternfly/react-core';\n\nimport { CardBody } from 'components/Card';\nimport { InstanceGroupsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport ContainerGroupForm from '../shared/ContainerGroupForm';\n\nfunction ContainerGroupEdit({ instanceGroup }) {\n  const history = useHistory();\n  const [submitError, setSubmitError] = useState(null);\n  const detailsIUrl = `/instance_groups/container_group/${instanceGroup.id}/details`;\n\n  const {\n    error: fetchError,\n    isLoading,\n    request: fetchInitialPodSpec,\n    result: initialPodSpec,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await InstanceGroupsAPI.readOptions();\n      return data.actions.POST.pod_spec_override.default;\n    }, []),\n    {\n      initialPodSpec: {},\n    }\n  );\n\n  useEffect(() => {\n    fetchInitialPodSpec();\n  }, [fetchInitialPodSpec]);\n\n  const handleSubmit = async (values) => {\n    try {\n      await InstanceGroupsAPI.update(instanceGroup.id, {\n        name: values.name,\n        credential: values.credential ? values.credential.id : null,\n        pod_spec_override: values.override ? values.pod_spec_override : null,\n        is_container_group: true,\n      });\n      history.push(detailsIUrl);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  };\n  const handleCancel = () => {\n    history.push(detailsIUrl);\n  };\n\n  if (fetchError) {\n    return (\n      <PageSection>\n        <Card>\n          <CardBody>\n            <ContentError error={fetchError} />\n          </CardBody>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <CardBody>\n        <ContentLoading />\n      </CardBody>\n    );\n  }\n\n  return (\n    <CardBody>\n      <ContainerGroupForm\n        instanceGroup={instanceGroup}\n        initialPodSpec={initialPodSpec}\n        onSubmit={handleSubmit}\n        submitError={submitError}\n        onCancel={handleCancel}\n      />\n    </CardBody>\n  );\n}\n\nexport default ContainerGroupEdit;\n"]},"metadata":{},"sourceType":"module"}