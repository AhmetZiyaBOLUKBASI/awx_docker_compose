{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{Link,useHistory}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Host}from'types';import{CardBody,CardActionsRow}from'components/Card';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import Sparkline from'components/Sparkline';import DeleteButton from'components/DeleteButton';import{HostsAPI}from'api';import HostToggle from'components/HostToggle';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _StyledHostToggle=_styled(HostToggle).withConfig({displayName:\"HostDetail___StyledHostToggle\",componentId:\"sc-1g4ujma-0\"})([\"padding-bottom:40px\"]);function HostDetail(_ref){var host=_ref.host;var created=host.created,description=host.description,id=host.id,modified=host.modified,name=host.name,variables=host.variables,_host$summary_fields=host.summary_fields,inventory=_host$summary_fields.inventory,recentJobs=_host$summary_fields.recent_jobs,created_by=_host$summary_fields.created_by,modified_by=_host$summary_fields.modified_by,user_capabilities=_host$summary_fields.user_capabilities;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsloading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deletionError=_useState4[0],setDeletionError=_useState4[1];var history=useHistory();var handleHostDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsloading(true);_context.prev=1;_context.next=4;return HostsAPI.destroy(id);case 4:history.push('/hosts');_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);setDeletionError(_context.t0);case 10:_context.prev=10;setIsloading(false);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,7,10,13]]);}));return function handleHostDelete(){return _ref2.apply(this,arguments);};}();if(!isLoading&&deletionError){return/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(false);},children:[/*i18n*/i18n._(\"Failed to delete {name}.\",{name:name}),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]});}return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(_StyledHostToggle,{host:host}),/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name,dataCy:\"host-name\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Activity\"),value:/*#__PURE__*/_jsx(Sparkline,{jobs:recentJobs}),isEmpty:(recentJobs===null||recentJobs===void 0?void 0:recentJobs.length)===0}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Inventory\"),dataCy:\"host-inventory\",helpText:/*i18n*/i18n._(\"The inventory that this host belongs to.\"),value:/*#__PURE__*/_jsx(Link,{to:\"/inventories/inventory/\".concat(inventory.id,\"/details\"),children:inventory.name})}),/*#__PURE__*/_jsx(UserDateDetail,{date:created,label:/*i18n*/i18n._(\"Created\"),user:created_by}),/*#__PURE__*/_jsx(UserDateDetail,{date:modified,label:/*i18n*/i18n._(\"Last Modified\"),user:modified_by}),/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Variables\"),rows:4,value:variables,name:\"variables\",dataCy:\"host-detail-variables\"})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.edit)&&/*#__PURE__*/_jsx(Button,{ouiaId:\"host-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"edit\"),component:Link,to:\"/hosts/\".concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.delete)&&/*#__PURE__*/_jsx(DeleteButton,{onConfirm:function onConfirm(){return handleHostDelete();},modalTitle:/*i18n*/i18n._(\"Delete Host\"),name:name})]}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(null);},children:[/*i18n*/i18n._(\"Failed to delete host.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default HostDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Host/HostDetail/HostDetail.js"],"names":["React","useState","Link","useHistory","Button","Host","CardBody","CardActionsRow","AlertModal","ErrorDetail","DetailList","Detail","UserDateDetail","VariablesDetail","Sparkline","DeleteButton","HostsAPI","HostToggle","HostDetail","host","created","description","id","modified","name","variables","summary_fields","inventory","recentJobs","recent_jobs","created_by","modified_by","user_capabilities","isLoading","setIsloading","deletionError","setDeletionError","history","handleHostDelete","destroy","push","length","edit","delete"],"mappings":"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","sourcesContent":["import 'styled-components/macro';\nimport React, { useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { Host } from 'types';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport Sparkline from 'components/Sparkline';\nimport DeleteButton from 'components/DeleteButton';\nimport { HostsAPI } from 'api';\nimport HostToggle from 'components/HostToggle';\n\nfunction HostDetail({ host }) {\n  const {\n    created,\n    description,\n    id,\n    modified,\n    name,\n    variables,\n    summary_fields: {\n      inventory,\n      recent_jobs: recentJobs,\n      created_by,\n      modified_by,\n      user_capabilities,\n    },\n  } = host;\n\n  const [isLoading, setIsloading] = useState(false);\n  const [deletionError, setDeletionError] = useState(false);\n  const history = useHistory();\n\n  const handleHostDelete = async () => {\n    setIsloading(true);\n    try {\n      await HostsAPI.destroy(id);\n      history.push('/hosts');\n    } catch (err) {\n      setDeletionError(err);\n    } finally {\n      setIsloading(false);\n    }\n  };\n\n  if (!isLoading && deletionError) {\n    return (\n      <AlertModal\n        isOpen={deletionError}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => setDeletionError(false)}\n      >\n        {t`Failed to delete ${name}.`}\n        <ErrorDetail error={deletionError} />\n      </AlertModal>\n    );\n  }\n\n  return (\n    <CardBody>\n      <HostToggle host={host} css=\"padding-bottom: 40px\" />\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} dataCy=\"host-name\" />\n        <Detail\n          label={t`Activity`}\n          value={<Sparkline jobs={recentJobs} />}\n          isEmpty={recentJobs?.length === 0}\n        />\n        <Detail label={t`Description`} value={description} />\n        <Detail\n          label={t`Inventory`}\n          dataCy=\"host-inventory\"\n          helpText={t`The inventory that this host belongs to.`}\n          value={\n            <Link to={`/inventories/inventory/${inventory.id}/details`}>\n              {inventory.name}\n            </Link>\n          }\n        />\n        <UserDateDetail date={created} label={t`Created`} user={created_by} />\n        <UserDateDetail\n          date={modified}\n          label={t`Last Modified`}\n          user={modified_by}\n        />\n        <VariablesDetail\n          label={t`Variables`}\n          rows={4}\n          value={variables}\n          name=\"variables\"\n          dataCy=\"host-detail-variables\"\n        />\n      </DetailList>\n      <CardActionsRow>\n        {user_capabilities?.edit && (\n          <Button\n            ouiaId=\"host-detail-edit-button\"\n            aria-label={t`edit`}\n            component={Link}\n            to={`/hosts/${id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {user_capabilities?.delete && (\n          <DeleteButton\n            onConfirm={() => handleHostDelete()}\n            modalTitle={t`Delete Host`}\n            name={name}\n          />\n        )}\n      </CardActionsRow>\n      {deletionError && (\n        <AlertModal\n          isOpen={deletionError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={() => setDeletionError(null)}\n        >\n          {t`Failed to delete host.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nHostDetail.propTypes = {\n  host: Host.isRequired,\n};\n\nexport default HostDetail;\n"]},"metadata":{},"sourceType":"module"}