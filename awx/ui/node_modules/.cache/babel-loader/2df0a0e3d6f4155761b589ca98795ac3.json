{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{useRouteMatch}from'react-router-dom';import{Button,Tooltip}from'@patternfly/react-core';import{SyncIcon}from'@patternfly/react-icons';import useRequest,{useDismissableError}from'hooks/useRequest';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{ProjectsAPI}from'api';import projectHelpStrings from'./Project.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function ProjectSyncButton(_ref){var projectId=_ref.projectId,_ref$lastJobStatus=_ref.lastJobStatus,lastJobStatus=_ref$lastJobStatus===void 0?null:_ref$lastJobStatus;var match=useRouteMatch();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ProjectsAPI.sync(projectId);case 2:case\"end\":return _context.stop();}}},_callee);})),[projectId]),null),handleSync=_useRequest.request,syncError=_useRequest.error;var _useDismissableError=useDismissableError(syncError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var isDetailsView=match.url.endsWith('/details');var isDisabled=['pending','waiting','running'].includes(lastJobStatus);return/*#__PURE__*/_jsxs(_Fragment,{children:[isDisabled?/*#__PURE__*/_jsx(Tooltip,{content:projectHelpStrings.syncButtonDisabled,position:\"top\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(projectId,\"-sync-button\"),\"aria-label\":/*i18n*/i18n._(\"Sync Project\"),variant:isDetailsView?'secondary':'plain',isDisabled:isDisabled,children:match.url.endsWith('/details')?/*i18n*/i18n._(\"Sync\"):/*#__PURE__*/_jsx(SyncIcon,{})})})}):/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(projectId,\"-sync-button\"),\"aria-label\":/*i18n*/i18n._(\"Sync Project\"),variant:isDetailsView?'secondary':'plain',isDisabled:isDisabled,onClick:handleSync,children:match.url.endsWith('/details')?/*i18n*/i18n._(\"Sync\"):/*#__PURE__*/_jsx(SyncIcon,{})}),error&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to sync project.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:error})]})]});}export default ProjectSyncButton;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Project/shared/ProjectSyncButton.js"],"names":["React","useCallback","useRouteMatch","Button","Tooltip","SyncIcon","useRequest","useDismissableError","AlertModal","ErrorDetail","ProjectsAPI","projectHelpStrings","ProjectSyncButton","projectId","lastJobStatus","match","sync","handleSync","request","syncError","error","dismissError","isDetailsView","url","endsWith","isDisabled","includes","syncButtonDisabled"],"mappings":"gPAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,KAAmC,OAAnC,CACA,OAASC,aAAT,KAA8B,kBAA9B,CACA,OAASC,MAAT,CAAiBC,OAAjB,KAAgC,wBAAhC,CACA,OAASC,QAAT,KAAyB,yBAAzB,CAKA,MAAOC,CAAAA,UAAP,EAAqBC,mBAArB,KAAgD,kBAAhD,CAEA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,OAASC,WAAT,KAA4B,KAA5B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,oBAA/B,C,6IAEA,QAASC,CAAAA,iBAAT,MAAgE,IAAnCC,CAAAA,SAAmC,MAAnCA,SAAmC,yBAAxBC,aAAwB,CAAxBA,aAAwB,6BAAR,IAAQ,oBAC9D,GAAMC,CAAAA,KAAK,CAAGb,aAAa,EAA3B,CAEA,gBAAkDI,UAAU,CAC1DL,WAAW,sEAAC,yJACJS,CAAAA,WAAW,CAACM,IAAZ,CAAiBH,SAAjB,CADI,uDAAD,GAER,CAACA,SAAD,CAFQ,CAD+C,CAI1D,IAJ0D,CAA5D,CAAiBI,UAAjB,aAAQC,OAAR,CAAoCC,SAApC,aAA6BC,KAA7B,CAMA,yBAAgCb,mBAAmB,CAACY,SAAD,CAAnD,CAAQC,KAAR,sBAAQA,KAAR,CAAeC,YAAf,sBAAeA,YAAf,CACA,GAAMC,CAAAA,aAAa,CAAGP,KAAK,CAACQ,GAAN,CAAUC,QAAV,CAAmB,UAAnB,CAAtB,CACA,GAAMC,CAAAA,UAAU,CAAG,CAAC,SAAD,CAAY,SAAZ,CAAuB,SAAvB,EAAkCC,QAAlC,CAA2CZ,aAA3C,CAAnB,CAEA,mBACE,2BACGW,UAAU,cACT,KAAC,OAAD,EAAS,OAAO,CAAEd,kBAAkB,CAACgB,kBAArC,CAAyD,QAAQ,CAAC,KAAlE,uBACE,kCACE,KAAC,MAAD,EACE,MAAM,WAAKd,SAAL,gBADR,CAEE,qBAAY,sBAFd,CAGE,OAAO,CAAES,aAAa,CAAG,WAAH,CAAiB,OAHzC,CAIE,UAAU,CAAEG,UAJd,UAMGV,KAAK,CAACQ,GAAN,CAAUC,QAAV,CAAmB,UAAnB,UAAiC,cAAjC,cAA2C,KAAC,QAAD,IAN9C,EADF,EADF,EADS,cAcT,KAAC,MAAD,EACE,MAAM,WAAKX,SAAL,gBADR,CAEE,qBAAY,sBAFd,CAGE,OAAO,CAAES,aAAa,CAAG,WAAH,CAAiB,OAHzC,CAIE,UAAU,CAAEG,UAJd,CAKE,OAAO,CAAER,UALX,UAOGF,KAAK,CAACQ,GAAN,CAAUC,QAAV,CAAmB,UAAnB,UAAiC,cAAjC,cAA2C,KAAC,QAAD,IAP9C,EAfJ,CAyBGJ,KAAK,eACJ,MAAC,UAAD,EACE,MAAM,CAAEA,KADV,CAEE,OAAO,CAAC,OAFV,CAGE,KAAK,SAAE,gBAHT,CAIE,OAAO,CAAEC,YAJX,mBAMG,iCANH,cAOE,KAAC,WAAD,EAAa,KAAK,CAAED,KAApB,EAPF,GA1BJ,GADF,CAuCD,CAMD,cAAeR,CAAAA,iBAAf","sourcesContent":["import React, { useCallback } from 'react';\nimport { useRouteMatch } from 'react-router-dom';\nimport { Button, Tooltip } from '@patternfly/react-core';\nimport { SyncIcon } from '@patternfly/react-icons';\n\nimport { number } from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\n\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { ProjectsAPI } from 'api';\nimport projectHelpStrings from './Project.helptext';\n\nfunction ProjectSyncButton({ projectId, lastJobStatus = null }) {\n  const match = useRouteMatch();\n\n  const { request: handleSync, error: syncError } = useRequest(\n    useCallback(async () => {\n      await ProjectsAPI.sync(projectId);\n    }, [projectId]),\n    null\n  );\n  const { error, dismissError } = useDismissableError(syncError);\n  const isDetailsView = match.url.endsWith('/details');\n  const isDisabled = ['pending', 'waiting', 'running'].includes(lastJobStatus);\n\n  return (\n    <>\n      {isDisabled ? (\n        <Tooltip content={projectHelpStrings.syncButtonDisabled} position=\"top\">\n          <div>\n            <Button\n              ouiaId={`${projectId}-sync-button`}\n              aria-label={t`Sync Project`}\n              variant={isDetailsView ? 'secondary' : 'plain'}\n              isDisabled={isDisabled}\n            >\n              {match.url.endsWith('/details') ? t`Sync` : <SyncIcon />}\n            </Button>\n          </div>\n        </Tooltip>\n      ) : (\n        <Button\n          ouiaId={`${projectId}-sync-button`}\n          aria-label={t`Sync Project`}\n          variant={isDetailsView ? 'secondary' : 'plain'}\n          isDisabled={isDisabled}\n          onClick={handleSync}\n        >\n          {match.url.endsWith('/details') ? t`Sync` : <SyncIcon />}\n        </Button>\n      )}\n      {error && (\n        <AlertModal\n          isOpen={error}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissError}\n        >\n          {t`Failed to sync project.`}\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nProjectSyncButton.propTypes = {\n  projectId: number.isRequired,\n};\n\nexport default ProjectSyncButton;\n"]},"metadata":{},"sourceType":"module"}