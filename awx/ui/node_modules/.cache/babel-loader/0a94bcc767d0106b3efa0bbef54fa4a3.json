{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useCallback,useEffect,useState}from'react';import{useHistory}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import{ApplicationsAPI}from'api';import{CardBody}from'components/Card';import ApplicationForm from'../shared/ApplicationForm';import{jsx as _jsx}from\"react/jsx-runtime\";function ApplicationAdd(_ref){var onSuccessfulAdd=_ref.onSuccessfulAdd;var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),submitError=_useState2[0],setSubmitError=_useState2[1];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$ApplicationsAP,_yield$ApplicationsAP2,authChoices,clientChoices,authorization,clientType;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ApplicationsAPI.readOptions();case 2:_yield$ApplicationsAP=_context.sent;_yield$ApplicationsAP2=_yield$ApplicationsAP.data.actions.GET;authChoices=_yield$ApplicationsAP2.authorization_grant_type.choices;clientChoices=_yield$ApplicationsAP2.client_type.choices;authorization=authChoices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});clientType=clientChoices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});return _context.abrupt(\"return\",{authorizationOptions:authorization,clientTypeOptions:clientType});case 9:case\"end\":return _context.stop();}}},_callee);})),[]),{authorizationOptions:[],clientTypeOptions:[]}),error=_useRequest.error,fetchOptions=_useRequest.request,_useRequest$result=_useRequest.result,authorizationOptions=_useRequest$result.authorizationOptions,clientTypeOptions=_useRequest$result.clientTypeOptions;var handleSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3){var values,_yield$ApplicationsAP3,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:values=Object.assign({},_ref3);values.organization=values.organization.id;_context2.prev=2;_context2.next=5;return ApplicationsAPI.create(values);case 5:_yield$ApplicationsAP3=_context2.sent;data=_yield$ApplicationsAP3.data;onSuccessfulAdd(data);history.push(\"/applications/\".concat(data.id,\"/details\"));_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);setSubmitError(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[2,11]]);}));return function handleSubmit(_x){return _ref4.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(\"/applications\");};useEffect(function(){fetchOptions();},[fetchOptions]);if(error){return/*#__PURE__*/_jsx(ContentError,{error:error});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ApplicationForm,{onSubmit:handleSubmit,onCancel:handleCancel,authorizationOptions:authorizationOptions,clientTypeOptions:clientTypeOptions,submitError:submitError})})})});}export default ApplicationAdd;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Application/ApplicationAdd/ApplicationAdd.js"],"names":["React","useCallback","useEffect","useState","useHistory","Card","PageSection","useRequest","ContentError","ApplicationsAPI","CardBody","ApplicationForm","ApplicationAdd","onSuccessfulAdd","history","submitError","setSubmitError","readOptions","data","actions","GET","authChoices","authorization_grant_type","choices","clientChoices","client_type","authorization","map","choice","value","label","key","clientType","authorizationOptions","clientTypeOptions","error","fetchOptions","request","result","handleSubmit","values","organization","id","create","push","handleCancel"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\n\nimport { Card, PageSection } from '@patternfly/react-core';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport { ApplicationsAPI } from 'api';\nimport { CardBody } from 'components/Card';\nimport ApplicationForm from '../shared/ApplicationForm';\n\nfunction ApplicationAdd({ onSuccessfulAdd }) {\n  const history = useHistory();\n  const [submitError, setSubmitError] = useState(null);\n\n  const {\n    error,\n    request: fetchOptions,\n    result: { authorizationOptions, clientTypeOptions },\n  } = useRequest(\n    useCallback(async () => {\n      const {\n        data: {\n          actions: {\n            GET: {\n              authorization_grant_type: { choices: authChoices },\n              client_type: { choices: clientChoices },\n            },\n          },\n        },\n      } = await ApplicationsAPI.readOptions();\n\n      const authorization = authChoices.map((choice) => ({\n        value: choice[0],\n        label: choice[1],\n        key: choice[0],\n      }));\n      const clientType = clientChoices.map((choice) => ({\n        value: choice[0],\n        label: choice[1],\n        key: choice[0],\n      }));\n\n      return {\n        authorizationOptions: authorization,\n        clientTypeOptions: clientType,\n      };\n    }, []),\n    {\n      authorizationOptions: [],\n      clientTypeOptions: [],\n    }\n  );\n  const handleSubmit = async ({ ...values }) => {\n    values.organization = values.organization.id;\n    try {\n      const { data } = await ApplicationsAPI.create(values);\n      onSuccessfulAdd(data);\n      history.push(`/applications/${data.id}/details`);\n    } catch (err) {\n      setSubmitError(err);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push(`/applications`);\n  };\n\n  useEffect(() => {\n    fetchOptions();\n  }, [fetchOptions]);\n\n  if (error) {\n    return <ContentError error={error} />;\n  }\n  return (\n    <PageSection>\n      <Card>\n        <CardBody>\n          <ApplicationForm\n            onSubmit={handleSubmit}\n            onCancel={handleCancel}\n            authorizationOptions={authorizationOptions}\n            clientTypeOptions={clientTypeOptions}\n            submitError={submitError}\n          />\n        </CardBody>\n      </Card>\n    </PageSection>\n  );\n}\nexport default ApplicationAdd;\n"]},"metadata":{},"sourceType":"module"}