{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Card,PageSection}from'@patternfly/react-core';import{CaretLeftIcon}from'@patternfly/react-icons';import{Link,Switch,Route,Redirect,useParams,useRouteMatch,useLocation}from'react-router-dom';import useRequest from'hooks/useRequest';import RoutedTabs from'components/RoutedTabs';import ContentError from'components/ContentError';import{NotificationTemplatesAPI}from'api';import ContentLoading from'components/ContentLoading';import NotificationTemplateDetail from'./NotificationTemplateDetail';import NotificationTemplateEdit from'./NotificationTemplateEdit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function NotificationTemplate(_ref){var setBreadcrumb=_ref.setBreadcrumb;var _useParams=useParams(),templateId=_useParams.id;var match=useRouteMatch();var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _options$data$actions,_options$data$actions2;var _yield$Promise$all,_yield$Promise$all2,detail,options;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([NotificationTemplatesAPI.readDetail(templateId),NotificationTemplatesAPI.readOptions()]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);detail=_yield$Promise$all2[0];options=_yield$Promise$all2[1];setBreadcrumb(detail.data);return _context.abrupt(\"return\",{template:detail.data,defaultMessages:(_options$data$actions=options.data.actions)===null||_options$data$actions===void 0?void 0:(_options$data$actions2=_options$data$actions.POST)===null||_options$data$actions2===void 0?void 0:_options$data$actions2.messages});case 8:case\"end\":return _context.stop();}}},_callee);})),[templateId,setBreadcrumb]),{template:null,defaultMessages:null}),_useRequest$result=_useRequest.result,template=_useRequest$result.template,defaultMessages=_useRequest$result.defaultMessages,isLoading=_useRequest.isLoading,error=_useRequest.error,fetchTemplate=_useRequest.request;useEffect(function(){fetchTemplate();},[fetchTemplate,location.pathname]);if(!isLoading&&error){var _error$response;return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Notification Template not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/notification_templates\",children:/*i18n*/i18n._(\"View all Notification Templates.\")})]})})})});}var showCardHeader=!location.pathname.endsWith('edit');var tabs=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Notifications\")]}),link:\"/notification_templates\",id:99,isBackButton:true},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(match.url,\"/details\"),id:0}];return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabs}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/notification_templates/:id\",to:\"/notification_templates/:id/details\",exact:true}),isLoading&&/*#__PURE__*/_jsx(ContentLoading,{}),template&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/notification_templates/:id/edit\",children:/*#__PURE__*/_jsx(NotificationTemplateEdit,{template:template,defaultMessages:defaultMessages})}),/*#__PURE__*/_jsx(Route,{path:\"/notification_templates/:id/details\",children:/*#__PURE__*/_jsx(NotificationTemplateDetail,{template:template,defaultMessages:defaultMessages})})]})]})]})});}export default NotificationTemplate;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/NotificationTemplate/NotificationTemplate.js"],"names":["React","useEffect","useCallback","Card","PageSection","CaretLeftIcon","Link","Switch","Route","Redirect","useParams","useRouteMatch","useLocation","useRequest","RoutedTabs","ContentError","NotificationTemplatesAPI","ContentLoading","NotificationTemplateDetail","NotificationTemplateEdit","NotificationTemplate","setBreadcrumb","templateId","id","match","location","Promise","all","readDetail","readOptions","detail","options","data","template","defaultMessages","actions","POST","messages","result","isLoading","error","fetchTemplate","request","pathname","response","status","showCardHeader","endsWith","tabs","name","link","isBackButton","url"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { t } from '@lingui/macro';\n\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport {\n  Link,\n  Switch,\n  Route,\n  Redirect,\n  useParams,\n  useRouteMatch,\n  useLocation,\n} from 'react-router-dom';\nimport useRequest from 'hooks/useRequest';\nimport RoutedTabs from 'components/RoutedTabs';\nimport ContentError from 'components/ContentError';\nimport { NotificationTemplatesAPI } from 'api';\nimport ContentLoading from 'components/ContentLoading';\nimport NotificationTemplateDetail from './NotificationTemplateDetail';\nimport NotificationTemplateEdit from './NotificationTemplateEdit';\n\nfunction NotificationTemplate({ setBreadcrumb }) {\n  const { id: templateId } = useParams();\n  const match = useRouteMatch();\n  const location = useLocation();\n  const {\n    result: { template, defaultMessages },\n    isLoading,\n    error,\n    request: fetchTemplate,\n  } = useRequest(\n    useCallback(async () => {\n      const [detail, options] = await Promise.all([\n        NotificationTemplatesAPI.readDetail(templateId),\n        NotificationTemplatesAPI.readOptions(),\n      ]);\n      setBreadcrumb(detail.data);\n      return {\n        template: detail.data,\n        defaultMessages: options.data.actions?.POST?.messages,\n      };\n    }, [templateId, setBreadcrumb]),\n    { template: null, defaultMessages: null }\n  );\n\n  useEffect(() => {\n    fetchTemplate();\n  }, [fetchTemplate, location.pathname]);\n\n  if (!isLoading && error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response?.status === 404 && (\n              <span>\n                {t`Notification Template not found.`}{' '}\n                <Link to=\"/notification_templates\">\n                  {t`View all Notification Templates.`}\n                </Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  const showCardHeader = !location.pathname.endsWith('edit');\n  const tabs = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Notifications`}\n        </>\n      ),\n      link: `/notification_templates`,\n      id: 99,\n      isBackButton: true,\n    },\n    {\n      name: t`Details`,\n      link: `${match.url}/details`,\n      id: 0,\n    },\n  ];\n  return (\n    <PageSection>\n      <Card>\n        {showCardHeader && <RoutedTabs tabsArray={tabs} />}\n        <Switch>\n          <Redirect\n            from=\"/notification_templates/:id\"\n            to=\"/notification_templates/:id/details\"\n            exact\n          />\n          {isLoading && <ContentLoading />}\n          {template && (\n            <>\n              <Route path=\"/notification_templates/:id/edit\">\n                <NotificationTemplateEdit\n                  template={template}\n                  defaultMessages={defaultMessages}\n                />\n              </Route>\n              <Route path=\"/notification_templates/:id/details\">\n                <NotificationTemplateDetail\n                  template={template}\n                  defaultMessages={defaultMessages}\n                />\n              </Route>\n            </>\n          )}\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default NotificationTemplate;\n"]},"metadata":{},"sourceType":"module"}