{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{useLocation}from'react-router-dom';import{Card}from'@patternfly/react-core';import{ExecutionEnvironmentsAPI}from'api';import{getQSConfig,parseQueryString}from'util/qs';import useRequest from'hooks/useRequest';import DatalistToolbar from'components/DataListToolbar';import PaginatedTable,{HeaderCell,HeaderRow,getSearchableKeys}from'components/PaginatedTable';import ExecutionEnvironmentTemplateListItem from'./ExecutionEnvironmentTemplateListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('execution_environments',{page:1,page_size:20,order_by:'name',type:'job_template,workflow_job_template'},['id','page','page_size']);function ExecutionEnvironmentTemplateList(_ref){var executionEnvironment=_ref.executionEnvironment;var id=executionEnvironment.id;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _responseActions$data,_responseActions$data2;var params,_yield$Promise$all,_yield$Promise$all2,response,responseActions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([ExecutionEnvironmentsAPI.readUnifiedJobTemplates(id,params),ExecutionEnvironmentsAPI.readUnifiedJobTemplateOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);response=_yield$Promise$all2[0];responseActions=_yield$Promise$all2[1];return _context.abrupt(\"return\",{templates:response.data.results,templatesCount:response.data.count,actions:responseActions.data.actions,relatedSearchableKeys:((responseActions===null||responseActions===void 0?void 0:(_responseActions$data=responseActions.data)===null||_responseActions$data===void 0?void 0:_responseActions$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_responseActions$data2=responseActions.data.actions)===null||_responseActions$data2===void 0?void 0:_responseActions$data2.GET)});case 8:case\"end\":return _context.stop();}}},_callee);})),[location,id]),{templates:[],templatesCount:0,actions:{},relatedSearchableKeys:[],searchableKeys:[]}),contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchTemplates=_useRequest.request,_useRequest$result=_useRequest.result,templates=_useRequest$result.templates,templatesCount=_useRequest$result.templatesCount,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys;useEffect(function(){fetchTemplates();},[fetchTemplates]);return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(PaginatedTable,{contentError:contentError,hasContentLoading:isLoading,items:templates,itemCount:templatesCount,pluralizedItemName:/*i18n*/i18n._(\"Templates\"),qsConfig:QS_CONFIG,toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Type\"),key:'or__type',options:[[\"job_template\",/*i18n*/i18n._(\"Job Template\")],[\"workflow_job_template\",/*i18n*/i18n._(\"Workflow Template\")]]},{name:/*i18n*/i18n._(\"Created By (Username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified By (Username)\"),key:'modified_by__username__icontains'}],renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DatalistToolbar,_objectSpread(_objectSpread({},props),{},{qsConfig:QS_CONFIG}));},headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Type\")})]}),renderRow:function renderRow(template){return/*#__PURE__*/_jsx(ExecutionEnvironmentTemplateListItem,{template:template,detailUrl:\"/templates/\".concat(template.type,\"/\").concat(template.id,\"/details\")},template.id);}})});}export default ExecutionEnvironmentTemplateList;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/ExecutionEnvironment/ExecutionEnvironmentTemplate/ExecutionEnvironmentTemplateList.js"],"names":["React","useEffect","useCallback","useLocation","Card","ExecutionEnvironmentsAPI","getQSConfig","parseQueryString","useRequest","DatalistToolbar","PaginatedTable","HeaderCell","HeaderRow","getSearchableKeys","ExecutionEnvironmentTemplateListItem","QS_CONFIG","page","page_size","order_by","type","ExecutionEnvironmentTemplateList","executionEnvironment","id","location","params","search","Promise","all","readUnifiedJobTemplates","readUnifiedJobTemplateOptions","response","responseActions","templates","data","results","templatesCount","count","actions","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","GET","contentError","error","isLoading","fetchTemplates","request","result","name","key","isDefault","options","props","template"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Card } from '@patternfly/react-core';\n\nimport { ExecutionEnvironmentsAPI } from 'api';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport DatalistToolbar from 'components/DataListToolbar';\nimport PaginatedTable, {\n  HeaderCell,\n  HeaderRow,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\n\nimport ExecutionEnvironmentTemplateListItem from './ExecutionEnvironmentTemplateListItem';\n\nconst QS_CONFIG = getQSConfig(\n  'execution_environments',\n  {\n    page: 1,\n    page_size: 20,\n    order_by: 'name',\n    type: 'job_template,workflow_job_template',\n  },\n  ['id', 'page', 'page_size']\n);\n\nfunction ExecutionEnvironmentTemplateList({ executionEnvironment }) {\n  const { id } = executionEnvironment;\n  const location = useLocation();\n\n  const {\n    error: contentError,\n    isLoading,\n    request: fetchTemplates,\n    result: {\n      templates,\n      templatesCount,\n      relatedSearchableKeys,\n      searchableKeys,\n    },\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n\n      const [response, responseActions] = await Promise.all([\n        ExecutionEnvironmentsAPI.readUnifiedJobTemplates(id, params),\n        ExecutionEnvironmentsAPI.readUnifiedJobTemplateOptions(id),\n      ]);\n\n      return {\n        templates: response.data.results,\n        templatesCount: response.data.count,\n        actions: responseActions.data.actions,\n        relatedSearchableKeys: (\n          responseActions?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(responseActions.data.actions?.GET),\n      };\n    }, [location, id]),\n    {\n      templates: [],\n      templatesCount: 0,\n      actions: {},\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchTemplates();\n  }, [fetchTemplates]);\n\n  return (\n    <Card>\n      <PaginatedTable\n        contentError={contentError}\n        hasContentLoading={isLoading}\n        items={templates}\n        itemCount={templatesCount}\n        pluralizedItemName={t`Templates`}\n        qsConfig={QS_CONFIG}\n        toolbarSearchableKeys={searchableKeys}\n        toolbarRelatedSearchableKeys={relatedSearchableKeys}\n        toolbarSearchColumns={[\n          {\n            name: t`Name`,\n            key: 'name__icontains',\n            isDefault: true,\n          },\n          {\n            name: t`Type`,\n            key: 'or__type',\n            options: [\n              [`job_template`, t`Job Template`],\n              [`workflow_job_template`, t`Workflow Template`],\n            ],\n          },\n          {\n            name: t`Created By (Username)`,\n            key: 'created_by__username__icontains',\n          },\n          {\n            name: t`Modified By (Username)`,\n            key: 'modified_by__username__icontains',\n          },\n        ]}\n        renderToolbar={(props) => (\n          <DatalistToolbar {...props} qsConfig={QS_CONFIG} />\n        )}\n        headerRow={\n          <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n            <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n            <HeaderCell>{t`Type`}</HeaderCell>\n          </HeaderRow>\n        }\n        renderRow={(template) => (\n          <ExecutionEnvironmentTemplateListItem\n            key={template.id}\n            template={template}\n            detailUrl={`/templates/${template.type}/${template.id}/details`}\n          />\n        )}\n      />\n    </Card>\n  );\n}\n\nexport default ExecutionEnvironmentTemplateList;\n"]},"metadata":{},"sourceType":"module"}