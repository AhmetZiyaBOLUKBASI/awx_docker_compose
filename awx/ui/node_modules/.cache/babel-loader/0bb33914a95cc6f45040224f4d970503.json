{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from'react';import{Card,PageSection}from'@patternfly/react-core';import{useHistory}from'react-router-dom';import{ExecutionEnvironmentsAPI}from'api';import{Config}from'contexts/Config';import{CardBody}from'components/Card';import ExecutionEnvironmentForm from'../shared/ExecutionEnvironmentForm';import{jsx as _jsx}from\"react/jsx-runtime\";function ExecutionEnvironmentAdd(){var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),submitError=_useState2[0],setSubmitError=_useState2[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var _values$credential,_values$organization,_yield$ExecutionEnvir,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ExecutionEnvironmentsAPI.create(_objectSpread(_objectSpread({},values),{},{credential:(_values$credential=values.credential)===null||_values$credential===void 0?void 0:_values$credential.id,organization:(_values$organization=values.organization)===null||_values$organization===void 0?void 0:_values$organization.id}));case 3:_yield$ExecutionEnvir=_context.sent;response=_yield$ExecutionEnvir.data;history.push(\"/execution_environments/\".concat(response.id,\"/details\"));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setSubmitError(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(\"/execution_environments\");};var hubParams={description:'',image:'',name:''};history.location.search.replace(/^\\?/,'').split('&').map(function(s){return s.split('=');}).forEach(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],val=_ref3[1];if(!(key in hubParams)){return;}hubParams[key]=decodeURIComponent(val);});return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(Config,{children:function children(_ref4){var me=_ref4.me;return/*#__PURE__*/_jsx(ExecutionEnvironmentForm,{onSubmit:handleSubmit,submitError:submitError,onCancel:handleCancel,me:me||{},executionEnvironment:hubParams});}})})})});}export default ExecutionEnvironmentAdd;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/ExecutionEnvironment/ExecutionEnvironmentAdd/ExecutionEnvironmentAdd.js"],"names":["React","useState","Card","PageSection","useHistory","ExecutionEnvironmentsAPI","Config","CardBody","ExecutionEnvironmentForm","ExecutionEnvironmentAdd","history","submitError","setSubmitError","handleSubmit","values","create","credential","id","organization","response","data","push","handleCancel","hubParams","description","image","name","location","search","replace","split","map","s","forEach","key","val","decodeURIComponent","me"],"mappings":"8ZAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,IAAT,CAAeC,WAAf,KAAkC,wBAAlC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,OAASC,wBAAT,KAAyC,KAAzC,CACA,OAASC,MAAT,KAAuB,iBAAvB,CACA,OAASC,QAAT,KAAyB,iBAAzB,CACA,MAAOC,CAAAA,wBAAP,KAAqC,oCAArC,C,2CAEA,QAASC,CAAAA,uBAAT,EAAmC,CACjC,GAAMC,CAAAA,OAAO,CAAGN,UAAU,EAA1B,CACA,cAAsCH,QAAQ,CAAC,IAAD,CAA9C,wCAAOU,WAAP,eAAoBC,cAApB,eAEA,GAAMC,CAAAA,YAAY,0FAAG,iBAAOC,MAAP,mOAEgBT,CAAAA,wBAAwB,CAACU,MAAzB,gCAC5BD,MAD4B,MAE/BE,UAAU,qBAAEF,MAAM,CAACE,UAAT,6CAAE,mBAAmBC,EAFA,CAG/BC,YAAY,uBAAEJ,MAAM,CAACI,YAAT,+CAAE,qBAAqBD,EAHJ,GAFhB,4CAEHE,QAFG,uBAETC,IAFS,CAOjBV,OAAO,CAACW,IAAR,mCAAwCF,QAAQ,CAACF,EAAjD,cAPiB,+EASjBL,cAAc,aAAd,CATiB,oEAAH,kBAAZC,CAAAA,YAAY,4CAAlB,CAaA,GAAMS,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBZ,OAAO,CAACW,IAAR,4BACD,CAFD,CAIA,GAAME,CAAAA,SAAS,CAAG,CAChBC,WAAW,CAAE,EADG,CAEhBC,KAAK,CAAE,EAFS,CAGhBC,IAAI,CAAE,EAHU,CAAlB,CAMAhB,OAAO,CAACiB,QAAR,CAAiBC,MAAjB,CACGC,OADH,CACW,KADX,CACkB,EADlB,EAEGC,KAFH,CAES,GAFT,EAGGC,GAHH,CAGO,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACF,KAAF,CAAQ,GAAR,CAAP,EAHP,EAIGG,OAJH,CAIW,eAAgB,mCAAdC,GAAc,UAATC,GAAS,UACvB,GAAI,EAAED,GAAG,GAAIX,CAAAA,SAAT,CAAJ,CAAyB,CACvB,OACD,CACDA,SAAS,CAACW,GAAD,CAAT,CAAiBE,kBAAkB,CAACD,GAAD,CAAnC,CACD,CATH,EAWA,mBACE,KAAC,WAAD,wBACE,KAAC,IAAD,wBACE,KAAC,QAAD,wBACE,KAAC,MAAD,WACG,4BAAGE,CAAAA,EAAH,OAAGA,EAAH,oBACC,KAAC,wBAAD,EACE,QAAQ,CAAExB,YADZ,CAEE,WAAW,CAAEF,WAFf,CAGE,QAAQ,CAAEW,YAHZ,CAIE,EAAE,CAAEe,EAAE,EAAI,EAJZ,CAKE,oBAAoB,CAAEd,SALxB,EADD,EADH,EADF,EADF,EADF,EADF,CAmBD,CAED,cAAed,CAAAA,uBAAf","sourcesContent":["import React, { useState } from 'react';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { useHistory } from 'react-router-dom';\n\nimport { ExecutionEnvironmentsAPI } from 'api';\nimport { Config } from 'contexts/Config';\nimport { CardBody } from 'components/Card';\nimport ExecutionEnvironmentForm from '../shared/ExecutionEnvironmentForm';\n\nfunction ExecutionEnvironmentAdd() {\n  const history = useHistory();\n  const [submitError, setSubmitError] = useState(null);\n\n  const handleSubmit = async (values) => {\n    try {\n      const { data: response } = await ExecutionEnvironmentsAPI.create({\n        ...values,\n        credential: values.credential?.id,\n        organization: values.organization?.id,\n      });\n      history.push(`/execution_environments/${response.id}/details`);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push(`/execution_environments`);\n  };\n\n  const hubParams = {\n    description: '',\n    image: '',\n    name: '',\n  };\n\n  history.location.search\n    .replace(/^\\?/, '')\n    .split('&')\n    .map((s) => s.split('='))\n    .forEach(([key, val]) => {\n      if (!(key in hubParams)) {\n        return;\n      }\n      hubParams[key] = decodeURIComponent(val);\n    });\n\n  return (\n    <PageSection>\n      <Card>\n        <CardBody>\n          <Config>\n            {({ me }) => (\n              <ExecutionEnvironmentForm\n                onSubmit={handleSubmit}\n                submitError={submitError}\n                onCancel={handleCancel}\n                me={me || {}}\n                executionEnvironment={hubParams}\n              />\n            )}\n          </Config>\n        </CardBody>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default ExecutionEnvironmentAdd;\n"]},"metadata":{},"sourceType":"module"}