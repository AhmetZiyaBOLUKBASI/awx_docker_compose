{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Switch,Route,Link,Redirect,useLocation,useParams}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{SchedulesAPI}from'api';import useRequest from'hooks/useRequest';import RoutedTabs from'../RoutedTabs';import ContentError from'../ContentError';import ContentLoading from'../ContentLoading';import ScheduleDetail from'./ScheduleDetail';import ScheduleEdit from'./ScheduleEdit';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Schedule(_ref){var _schedule$summary_fie,_schedule$summary_fie2;var setBreadcrumb=_ref.setBreadcrumb,resource=_ref.resource,launchConfig=_ref.launchConfig,surveyConfig=_ref.surveyConfig,hasDaysToKeepField=_ref.hasDaysToKeepField,resourceDefaultCredentials=_ref.resourceDefaultCredentials;var _useParams=useParams(),scheduleId=_useParams.scheduleId;var _useLocation=useLocation(),pathname=_useLocation.pathname;var pathRoot=pathname.substr(0,pathname.indexOf('schedules'));var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$SchedulesAPI$r,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SchedulesAPI.readDetail(scheduleId);case 2:_yield$SchedulesAPI$r=_context.sent;data=_yield$SchedulesAPI$r.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[scheduleId]),null),isLoading=_useRequest.isLoading,error=_useRequest.error,loadData=_useRequest.request,schedule=_useRequest.result;useEffect(function(){loadData();},[loadData,pathname]);useEffect(function(){if(schedule){setBreadcrumb(resource,schedule);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[schedule,resource]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Schedules\")]}),link:\"\".concat(pathRoot,\"schedules\"),id:99},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(pathRoot,\"schedules/\").concat(schedule&&schedule.id,\"/details\"),id:0}];if(!isLoading&&error){return/*#__PURE__*/_jsx(ContentError,{isNotFound:true,error:error,children:error.response&&error.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Schedule not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"schedules\"),children:/*i18n*/i18n._(\"View Schedules\")})]})});}if(isLoading||!(schedule!==null&&schedule!==void 0&&(_schedule$summary_fie=schedule.summary_fields)!==null&&_schedule$summary_fie!==void 0&&(_schedule$summary_fie2=_schedule$summary_fie.unified_job_template)!==null&&_schedule$summary_fie2!==void 0&&_schedule$summary_fie2.id)){return/*#__PURE__*/_jsx(ContentLoading,{});}if((schedule===null||schedule===void 0?void 0:schedule.summary_fields.unified_job_template.id)!==parseInt(resource.id,10)){return/*#__PURE__*/_jsx(ContentError,{children:schedule&&/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"schedules\"),children:/*i18n*/i18n._(\"View Schedules\")})});}if(error){return/*#__PURE__*/_jsx(ContentError,{error:error});}var showCardHeader=true;if(!pathname.includes('schedules/')||pathname.endsWith('edit')){showCardHeader=false;}return/*#__PURE__*/_jsxs(_Fragment,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"\".concat(pathRoot,\"schedules/:scheduleId\"),to:\"\".concat(pathRoot,\"schedules/:scheduleId/details\"),exact:true}),schedule&&[/*#__PURE__*/_jsx(Route,{path:\"\".concat(pathRoot,\"schedules/:id/edit\"),children:/*#__PURE__*/_jsx(ScheduleEdit,{hasDaysToKeepField:hasDaysToKeepField,schedule:schedule,resource:resource,launchConfig:launchConfig,surveyConfig:surveyConfig,resourceDefaultCredentials:resourceDefaultCredentials})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"\".concat(pathRoot,\"schedules/:scheduleId/details\"),children:/*#__PURE__*/_jsx(ScheduleDetail,{hasDaysToKeepField:hasDaysToKeepField,schedule:schedule,surveyConfig:surveyConfig})},\"details\")],/*#__PURE__*/_jsx(Route,{path:\"*\",children:/*#__PURE__*/_jsx(ContentError,{children:resource&&/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"details\"),children:/*i18n*/i18n._(\"View Details\")})})},\"not-found\")]})]});}export{Schedule as _Schedule};export default Schedule;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/Schedule/Schedule.js"],"names":["React","useEffect","useCallback","Switch","Route","Link","Redirect","useLocation","useParams","CaretLeftIcon","SchedulesAPI","useRequest","RoutedTabs","ContentError","ContentLoading","ScheduleDetail","ScheduleEdit","Schedule","setBreadcrumb","resource","launchConfig","surveyConfig","hasDaysToKeepField","resourceDefaultCredentials","scheduleId","pathname","pathRoot","substr","indexOf","readDetail","data","isLoading","error","loadData","request","schedule","result","tabsArray","name","link","id","response","status","summary_fields","unified_job_template","parseInt","showCardHeader","includes","endsWith","_Schedule"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { t } from '@lingui/macro';\n\nimport {\n  Switch,\n  Route,\n  Link,\n  Redirect,\n  useLocation,\n  useParams,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { SchedulesAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport RoutedTabs from '../RoutedTabs';\nimport ContentError from '../ContentError';\nimport ContentLoading from '../ContentLoading';\nimport ScheduleDetail from './ScheduleDetail';\nimport ScheduleEdit from './ScheduleEdit';\n\nfunction Schedule({\n  setBreadcrumb,\n  resource,\n  launchConfig,\n  surveyConfig,\n  hasDaysToKeepField,\n  resourceDefaultCredentials,\n}) {\n  const { scheduleId } = useParams();\n\n  const { pathname } = useLocation();\n\n  const pathRoot = pathname.substr(0, pathname.indexOf('schedules'));\n\n  const {\n    isLoading,\n    error,\n    request: loadData,\n    result: schedule,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await SchedulesAPI.readDetail(scheduleId);\n\n      return data;\n    }, [scheduleId]),\n    null\n  );\n\n  useEffect(() => {\n    loadData();\n  }, [loadData, pathname]);\n\n  useEffect(() => {\n    if (schedule) {\n      setBreadcrumb(resource, schedule);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [schedule, resource]);\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Schedules`}\n        </>\n      ),\n      link: `${pathRoot}schedules`,\n      id: 99,\n    },\n    {\n      name: t`Details`,\n      link: `${pathRoot}schedules/${schedule && schedule.id}/details`,\n      id: 0,\n    },\n  ];\n\n  if (!isLoading && error) {\n    return (\n      <ContentError isNotFound error={error}>\n        {error.response && error.response.status === 404 && (\n          <span>\n            {t`Schedule not found.`}{' '}\n            <Link to={`${pathRoot}schedules`}>{t`View Schedules`}</Link>\n          </span>\n        )}\n      </ContentError>\n    );\n  }\n\n  if (isLoading || !schedule?.summary_fields?.unified_job_template?.id) {\n    return <ContentLoading />;\n  }\n\n  if (\n    schedule?.summary_fields.unified_job_template.id !==\n    parseInt(resource.id, 10)\n  ) {\n    return (\n      <ContentError>\n        {schedule && (\n          <Link to={`${pathRoot}schedules`}>{t`View Schedules`}</Link>\n        )}\n      </ContentError>\n    );\n  }\n\n  if (error) {\n    return <ContentError error={error} />;\n  }\n\n  let showCardHeader = true;\n\n  if (!pathname.includes('schedules/') || pathname.endsWith('edit')) {\n    showCardHeader = false;\n  }\n\n  return (\n    <>\n      {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n      <Switch>\n        <Redirect\n          from={`${pathRoot}schedules/:scheduleId`}\n          to={`${pathRoot}schedules/:scheduleId/details`}\n          exact\n        />\n        {schedule && [\n          <Route key=\"edit\" path={`${pathRoot}schedules/:id/edit`}>\n            <ScheduleEdit\n              hasDaysToKeepField={hasDaysToKeepField}\n              schedule={schedule}\n              resource={resource}\n              launchConfig={launchConfig}\n              surveyConfig={surveyConfig}\n              resourceDefaultCredentials={resourceDefaultCredentials}\n            />\n          </Route>,\n          <Route\n            key=\"details\"\n            path={`${pathRoot}schedules/:scheduleId/details`}\n          >\n            <ScheduleDetail\n              hasDaysToKeepField={hasDaysToKeepField}\n              schedule={schedule}\n              surveyConfig={surveyConfig}\n            />\n          </Route>,\n        ]}\n        <Route key=\"not-found\" path=\"*\">\n          <ContentError>\n            {resource && (\n              <Link to={`${pathRoot}details`}>{t`View Details`}</Link>\n            )}\n          </ContentError>\n        </Route>\n      </Switch>\n    </>\n  );\n}\n\nexport { Schedule as _Schedule };\nexport default Schedule;\n"]},"metadata":{},"sourceType":"module"}