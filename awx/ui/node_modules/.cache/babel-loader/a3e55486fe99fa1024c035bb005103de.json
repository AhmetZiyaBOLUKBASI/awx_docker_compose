{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import{Switch,useParams,useLocation,useRouteMatch,Route,Redirect,Link}from'react-router-dom';import useRequest from'hooks/useRequest';import{ResourceAccessList}from'components/ResourceAccessList';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import RoutedTabs from'components/RoutedTabs';import RelatedTemplateList from'components/RelatedTemplateList';import{CredentialsAPI}from'api';import CredentialDetail from'./CredentialDetail';import CredentialEdit from'./CredentialEdit';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Credential(_ref){var setBreadcrumb=_ref.setBreadcrumb;var _useLocation=useLocation(),pathname=_useLocation.pathname;var match=useRouteMatch({path:'/credentials/:id'});var _useParams=useParams(),id=_useParams.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$CredentialsAPI,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return CredentialsAPI.readDetail(id);case 2:_yield$CredentialsAPI=_context.sent;data=_yield$CredentialsAPI.data;return _context.abrupt(\"return\",{credential:data});case 5:case\"end\":return _context.stop();}}},_callee);})),[id]),{credential:null}),fetchCredential=_useRequest.request,credential=_useRequest.result.credential,hasContentLoading=_useRequest.isLoading,contentError=_useRequest.error;useEffect(function(){fetchCredential();},[fetchCredential,pathname]);useEffect(function(){if(credential){setBreadcrumb(credential);}},[credential,setBreadcrumb]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Credentials\")]}),link:\"/credentials\",id:99,isBackButton:true},{name:/*i18n*/i18n._(\"Details\"),link:\"/credentials/\".concat(id,\"/details\"),id:0},{name:/*i18n*/i18n._(\"Access\"),link:\"/credentials/\".concat(id,\"/access\"),id:1},{name:/*i18n*/i18n._(\"Job Templates\"),link:\"/credentials/\".concat(id,\"/job_templates\"),id:2}];var showCardHeader=true;if(pathname.endsWith('edit')||pathname.endsWith('add')){showCardHeader=false;}if(!hasContentLoading&&contentError){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:contentError,children:contentError.response&&contentError.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Credential not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/credentials\",children:/*i18n*/i18n._(\"View all Credentials.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),hasContentLoading&&/*#__PURE__*/_jsx(ContentLoading,{}),!hasContentLoading&&credential&&/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/credentials/:id\",to:\"/credentials/:id/details\",exact:true}),credential&&[/*#__PURE__*/_jsx(Route,{path:\"/credentials/:id/details\",children:/*#__PURE__*/_jsx(CredentialDetail,{credential:credential})},\"details\"),/*#__PURE__*/_jsx(Route,{path:\"/credentials/:id/edit\",children:/*#__PURE__*/_jsx(CredentialEdit,{credential:credential})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"/credentials/:id/access\",children:/*#__PURE__*/_jsx(ResourceAccessList,{resource:credential,apiModel:CredentialsAPI})},\"access\"),/*#__PURE__*/_jsx(Route,{path:\"/credentials/:id/job_templates\",children:/*#__PURE__*/_jsx(RelatedTemplateList,{searchParams:{credentials__id:credential.id}})},\"job_templates\"),/*#__PURE__*/_jsx(Route,{path:\"*\",children:!hasContentLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:match.params.id&&/*#__PURE__*/_jsx(Link,{to:\"/credentials/\".concat(match.params.id,\"/details\"),children:/*i18n*/i18n._(\"View Credential Details\")})})},\"not-found\")],/*#__PURE__*/_jsx(Route,{path:\"*\",children:!hasContentLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:id&&/*#__PURE__*/_jsx(Link,{to:\"/credentials/\".concat(id,\"/details\"),children:/*i18n*/i18n._(\"View Credential Details\")})})},\"not-found\")]})]})});}export default Credential;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Credential/Credential.js"],"names":["React","useCallback","useEffect","CaretLeftIcon","Card","PageSection","Switch","useParams","useLocation","useRouteMatch","Route","Redirect","Link","useRequest","ResourceAccessList","ContentError","ContentLoading","RoutedTabs","RelatedTemplateList","CredentialsAPI","CredentialDetail","CredentialEdit","Credential","setBreadcrumb","pathname","match","path","id","readDetail","data","credential","fetchCredential","request","result","hasContentLoading","isLoading","contentError","error","tabsArray","name","link","isBackButton","showCardHeader","endsWith","response","status","credentials__id","params"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { t } from '@lingui/macro';\n\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport {\n  Switch,\n  useParams,\n  useLocation,\n  useRouteMatch,\n  Route,\n  Redirect,\n  Link,\n} from 'react-router-dom';\nimport useRequest from 'hooks/useRequest';\nimport { ResourceAccessList } from 'components/ResourceAccessList';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport RoutedTabs from 'components/RoutedTabs';\nimport RelatedTemplateList from 'components/RelatedTemplateList';\nimport { CredentialsAPI } from 'api';\nimport CredentialDetail from './CredentialDetail';\nimport CredentialEdit from './CredentialEdit';\n\nfunction Credential({ setBreadcrumb }) {\n  const { pathname } = useLocation();\n\n  const match = useRouteMatch({\n    path: '/credentials/:id',\n  });\n  const { id } = useParams();\n\n  const {\n    request: fetchCredential,\n    result: { credential },\n    isLoading: hasContentLoading,\n    error: contentError,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await CredentialsAPI.readDetail(id);\n      return {\n        credential: data,\n      };\n    }, [id]),\n    {\n      credential: null,\n    }\n  );\n\n  useEffect(() => {\n    fetchCredential();\n  }, [fetchCredential, pathname]);\n\n  useEffect(() => {\n    if (credential) {\n      setBreadcrumb(credential);\n    }\n  }, [credential, setBreadcrumb]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Credentials`}\n        </>\n      ),\n      link: `/credentials`,\n      id: 99,\n      isBackButton: true,\n    },\n    { name: t`Details`, link: `/credentials/${id}/details`, id: 0 },\n    {\n      name: t`Access`,\n      link: `/credentials/${id}/access`,\n      id: 1,\n    },\n    {\n      name: t`Job Templates`,\n      link: `/credentials/${id}/job_templates`,\n      id: 2,\n    },\n  ];\n\n  let showCardHeader = true;\n\n  if (pathname.endsWith('edit') || pathname.endsWith('add')) {\n    showCardHeader = false;\n  }\n\n  if (!hasContentLoading && contentError) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={contentError}>\n            {contentError.response && contentError.response.status === 404 && (\n              <span>\n                {t`Credential not found.`}{' '}\n                <Link to=\"/credentials\">{t`View all Credentials.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n        {hasContentLoading && <ContentLoading />}\n        {!hasContentLoading && credential && (\n          <Switch>\n            <Redirect\n              from=\"/credentials/:id\"\n              to=\"/credentials/:id/details\"\n              exact\n            />\n            {credential && [\n              <Route key=\"details\" path=\"/credentials/:id/details\">\n                <CredentialDetail credential={credential} />\n              </Route>,\n              <Route key=\"edit\" path=\"/credentials/:id/edit\">\n                <CredentialEdit credential={credential} />\n              </Route>,\n              <Route key=\"access\" path=\"/credentials/:id/access\">\n                <ResourceAccessList\n                  resource={credential}\n                  apiModel={CredentialsAPI}\n                />\n              </Route>,\n              <Route key=\"job_templates\" path=\"/credentials/:id/job_templates\">\n                <RelatedTemplateList\n                  searchParams={{ credentials__id: credential.id }}\n                />\n              </Route>,\n              <Route key=\"not-found\" path=\"*\">\n                {!hasContentLoading && (\n                  <ContentError isNotFound>\n                    {match.params.id && (\n                      <Link to={`/credentials/${match.params.id}/details`}>\n                        {t`View Credential Details`}\n                      </Link>\n                    )}\n                  </ContentError>\n                )}\n              </Route>,\n            ]}\n            <Route key=\"not-found\" path=\"*\">\n              {!hasContentLoading && (\n                <ContentError isNotFound>\n                  {id && (\n                    <Link to={`/credentials/${id}/details`}>\n                      {t`View Credential Details`}\n                    </Link>\n                  )}\n                </ContentError>\n              )}\n            </Route>\n          </Switch>\n        )}\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default Credential;\n"]},"metadata":{},"sourceType":"module"}