{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{ExpandableSection,Wizard}from'@patternfly/react-core';import{useFormikContext}from'formik';import{useDismissableError}from'hooks/useRequest';import AlertModal from'../../AlertModal';import ContentError from'../../ContentError';import ContentLoading from'../../ContentLoading';import useSchedulePromptSteps from'./useSchedulePromptSteps';import{jsx as _jsx}from\"react/jsx-runtime\";function SchedulePromptableFields(_ref){var schedule=_ref.schedule,surveyConfig=_ref.surveyConfig,launchConfig=_ref.launchConfig,onCloseWizard=_ref.onCloseWizard,onSave=_ref.onSave,credentials=_ref.credentials,resource=_ref.resource,resourceDefaultCredentials=_ref.resourceDefaultCredentials;var _useFormikContext=useFormikContext(),setFieldTouched=_useFormikContext.setFieldTouched,values=_useFormikContext.values,initialValues=_useFormikContext.initialValues,resetForm=_useFormikContext.resetForm;var _useSchedulePromptSte=useSchedulePromptSteps(surveyConfig,launchConfig,schedule,resource,credentials,resourceDefaultCredentials),steps=_useSchedulePromptSte.steps,visitStep=_useSchedulePromptSte.visitStep,visitAllSteps=_useSchedulePromptSte.visitAllSteps,validateStep=_useSchedulePromptSte.validateStep,contentError=_useSchedulePromptSte.contentError,isReady=_useSchedulePromptSte.isReady;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showDescription=_useState2[0],setShowDescription=_useState2[1];var _useDismissableError=useDismissableError(contentError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var cancelPromptableValues=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetForm({values:_objectSpread(_objectSpread({},initialValues),{},{description:values.description,frequency:values.frequency,name:values.name,startDateTime:values.startDateTime,timezone:values.timezone})});onCloseWizard();case 2:case\"end\":return _context.stop();}}},_callee);}));return function cancelPromptableValues(){return _ref2.apply(this,arguments);};}();if(error){return/*#__PURE__*/_jsx(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){dismissError();onCloseWizard();},children:/*#__PURE__*/_jsx(ContentError,{error:error})});}return/*#__PURE__*/_jsx(Wizard,{isOpen:true,onClose:cancelPromptableValues,onSave:onSave,onBack:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(nextStep){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:validateStep(nextStep.id);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}(),onNext:/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(nextStep,prevStep){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(nextStep.id==='preview'){visitAllSteps(setFieldTouched);}else{visitStep(prevStep.prevId,setFieldTouched);validateStep(nextStep.id);}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2,_x3){return _ref4.apply(this,arguments);};}(),onGoToStep:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(nextStep,prevStep){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(nextStep.id==='preview'){visitAllSteps(setFieldTouched);}else{visitStep(prevStep.prevId,setFieldTouched);validateStep(nextStep.id);}case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4,_x5){return _ref5.apply(this,arguments);};}(),title:/*i18n*/i18n._(\"Prompt | {0}\",{0:resource.name}),description:resource.description.length>512?/*#__PURE__*/_jsx(ExpandableSection,{toggleText:showDescription?/*i18n*/i18n._(\"Hide description\"):/*i18n*/i18n._(\"Show description\"),onToggle:function onToggle(){setShowDescription(!showDescription);},isExpanded:showDescription,children:resource.description}):resource.description,steps:isReady?steps:[{name:/*i18n*/i18n._(\"Content Loading\"),component:/*#__PURE__*/_jsx(ContentLoading,{})}],backButtonText:/*i18n*/i18n._(\"Back\"),cancelButtonText:/*i18n*/i18n._(\"Cancel\"),nextButtonText:/*i18n*/i18n._(\"Next\")});}export default SchedulePromptableFields;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/Schedule/shared/SchedulePromptableFields.js"],"names":["React","useState","ExpandableSection","Wizard","useFormikContext","useDismissableError","AlertModal","ContentError","ContentLoading","useSchedulePromptSteps","SchedulePromptableFields","schedule","surveyConfig","launchConfig","onCloseWizard","onSave","credentials","resource","resourceDefaultCredentials","setFieldTouched","values","initialValues","resetForm","steps","visitStep","visitAllSteps","validateStep","contentError","isReady","showDescription","setShowDescription","error","dismissError","cancelPromptableValues","description","frequency","name","startDateTime","timezone","nextStep","id","prevStep","prevId","length","component"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { ExpandableSection, Wizard } from '@patternfly/react-core';\nimport { t } from '@lingui/macro';\nimport { useFormikContext } from 'formik';\nimport { useDismissableError } from 'hooks/useRequest';\nimport AlertModal from '../../AlertModal';\nimport ContentError from '../../ContentError';\nimport ContentLoading from '../../ContentLoading';\nimport useSchedulePromptSteps from './useSchedulePromptSteps';\n\nfunction SchedulePromptableFields({\n  schedule,\n  surveyConfig,\n  launchConfig,\n  onCloseWizard,\n  onSave,\n  credentials,\n  resource,\n  resourceDefaultCredentials,\n}) {\n  const { setFieldTouched, values, initialValues, resetForm } =\n    useFormikContext();\n  const {\n    steps,\n    visitStep,\n    visitAllSteps,\n    validateStep,\n    contentError,\n    isReady,\n  } = useSchedulePromptSteps(\n    surveyConfig,\n    launchConfig,\n    schedule,\n    resource,\n    credentials,\n    resourceDefaultCredentials\n  );\n  const [showDescription, setShowDescription] = useState(false);\n  const { error, dismissError } = useDismissableError(contentError);\n  const cancelPromptableValues = async () => {\n    resetForm({\n      values: {\n        ...initialValues,\n        description: values.description,\n        frequency: values.frequency,\n        name: values.name,\n        startDateTime: values.startDateTime,\n        timezone: values.timezone,\n      },\n    });\n    onCloseWizard();\n  };\n\n  if (error) {\n    return (\n      <AlertModal\n        isOpen={error}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => {\n          dismissError();\n          onCloseWizard();\n        }}\n      >\n        <ContentError error={error} />\n      </AlertModal>\n    );\n  }\n  return (\n    <Wizard\n      isOpen\n      onClose={cancelPromptableValues}\n      onSave={onSave}\n      onBack={async (nextStep) => {\n        validateStep(nextStep.id);\n      }}\n      onNext={async (nextStep, prevStep) => {\n        if (nextStep.id === 'preview') {\n          visitAllSteps(setFieldTouched);\n        } else {\n          visitStep(prevStep.prevId, setFieldTouched);\n          validateStep(nextStep.id);\n        }\n      }}\n      onGoToStep={async (nextStep, prevStep) => {\n        if (nextStep.id === 'preview') {\n          visitAllSteps(setFieldTouched);\n        } else {\n          visitStep(prevStep.prevId, setFieldTouched);\n          validateStep(nextStep.id);\n        }\n      }}\n      title={t`Prompt | ${resource.name}`}\n      description={\n        resource.description.length > 512 ? (\n          <ExpandableSection\n            toggleText={\n              showDescription ? t`Hide description` : t`Show description`\n            }\n            onToggle={() => {\n              setShowDescription(!showDescription);\n            }}\n            isExpanded={showDescription}\n          >\n            {resource.description}\n          </ExpandableSection>\n        ) : (\n          resource.description\n        )\n      }\n      steps={\n        isReady\n          ? steps\n          : [\n              {\n                name: t`Content Loading`,\n                component: <ContentLoading />,\n              },\n            ]\n      }\n      backButtonText={t`Back`}\n      cancelButtonText={t`Cancel`}\n      nextButtonText={t`Next`}\n    />\n  );\n}\n\nexport default SchedulePromptableFields;\n"]},"metadata":{},"sourceType":"module"}