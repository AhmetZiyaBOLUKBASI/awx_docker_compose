{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import useWebsocket from'hooks/useWebsocket';export default function useWsInventorySourcesDetails(initialSources){var _useState=useState(initialSources),_useState2=_slicedToArray(_useState,2),sources=_useState2[0],setSources=_useState2[1];var lastMessage=useWebsocket({jobs:['status_changed'],control:['limit_reached_1']});useEffect(function(){setSources(initialSources);},[initialSources]);useEffect(function(){if(!(lastMessage!==null&&lastMessage!==void 0&&lastMessage.unified_job_id)||!(lastMessage!==null&&lastMessage!==void 0&&lastMessage.inventory_source_id)||lastMessage.type!=='inventory_update'){return;}var updateSource=_objectSpread(_objectSpread({},sources),{},{summary_fields:_objectSpread(_objectSpread({},sources.summary_fields),{},{current_job:{id:lastMessage.unified_job_id,status:lastMessage.status,finished:lastMessage.finished}})});setSources(updateSource);},[lastMessage]// eslint-disable-line react-hooks/exhaustive-deps\n);return sources;}","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventorySources/useWsInventorySourcesDetails.js"],"names":["useState","useEffect","useWebsocket","useWsInventorySourcesDetails","initialSources","sources","setSources","lastMessage","jobs","control","unified_job_id","inventory_source_id","type","updateSource","summary_fields","current_job","id","status","finished"],"mappings":"6MAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,CAAAA,YAAP,KAAyB,oBAAzB,CAEA,cAAe,SAASC,CAAAA,4BAAT,CAAsCC,cAAtC,CAAsD,CACnE,cAA8BJ,QAAQ,CAACI,cAAD,CAAtC,wCAAOC,OAAP,eAAgBC,UAAhB,eACA,GAAMC,CAAAA,WAAW,CAAGL,YAAY,CAAC,CAC/BM,IAAI,CAAE,CAAC,gBAAD,CADyB,CAE/BC,OAAO,CAAE,CAAC,iBAAD,CAFsB,CAAD,CAAhC,CAKAR,SAAS,CAAC,UAAM,CACdK,UAAU,CAACF,cAAD,CAAV,CACD,CAFQ,CAEN,CAACA,cAAD,CAFM,CAAT,CAIAH,SAAS,CACP,UAAM,CACJ,GACE,EAACM,WAAD,SAACA,WAAD,WAACA,WAAW,CAAEG,cAAd,GACA,EAACH,WAAD,SAACA,WAAD,WAACA,WAAW,CAAEI,mBAAd,CADA,EAEAJ,WAAW,CAACK,IAAZ,GAAqB,kBAHvB,CAIE,CACA,OACD,CACD,GAAMC,CAAAA,YAAY,gCACbR,OADa,MAEhBS,cAAc,gCACTT,OAAO,CAACS,cADC,MAEZC,WAAW,CAAE,CACXC,EAAE,CAAET,WAAW,CAACG,cADL,CAEXO,MAAM,CAAEV,WAAW,CAACU,MAFT,CAGXC,QAAQ,CAAEX,WAAW,CAACW,QAHX,CAFD,EAFE,EAAlB,CAYAZ,UAAU,CAACO,YAAD,CAAV,CACD,CAtBM,CAuBP,CAACN,WAAD,CAAc;AAvBP,CAAT,CA0BA,MAAOF,CAAAA,OAAP,CACD","sourcesContent":["import { useState, useEffect } from 'react';\nimport useWebsocket from 'hooks/useWebsocket';\n\nexport default function useWsInventorySourcesDetails(initialSources) {\n  const [sources, setSources] = useState(initialSources);\n  const lastMessage = useWebsocket({\n    jobs: ['status_changed'],\n    control: ['limit_reached_1'],\n  });\n\n  useEffect(() => {\n    setSources(initialSources);\n  }, [initialSources]);\n\n  useEffect(\n    () => {\n      if (\n        !lastMessage?.unified_job_id ||\n        !lastMessage?.inventory_source_id ||\n        lastMessage.type !== 'inventory_update'\n      ) {\n        return;\n      }\n      const updateSource = {\n        ...sources,\n        summary_fields: {\n          ...sources.summary_fields,\n          current_job: {\n            id: lastMessage.unified_job_id,\n            status: lastMessage.status,\n            finished: lastMessage.finished,\n          },\n        },\n      };\n\n      setSources(updateSource);\n    },\n    [lastMessage] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  return sources;\n}\n"]},"metadata":{},"sourceType":"module"}