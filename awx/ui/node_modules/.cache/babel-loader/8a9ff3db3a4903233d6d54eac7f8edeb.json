{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Button}from'@patternfly/react-core';import{OutlinedThumbsDownIcon}from'@patternfly/react-icons';import{WorkflowApprovalsAPI}from'api';import useRequest,{useDismissableError}from'hooks/useRequest';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function WorkflowDenyButton(_ref){var isDetailView=_ref.isDetailView,workflowApproval=_ref.workflowApproval,onHandleToast=_ref.onHandleToast;var hasBeenActedOn=Object.keys(workflowApproval.summary_fields.approved_or_denied_by||{}).length>0||workflowApproval.status==='canceled';var id=workflowApproval.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",WorkflowApprovalsAPI.deny(id));case 1:case\"end\":return _context.stop();}}},_callee);})),[id]),{}),denyApprovalError=_useRequest.error,denyWorkflowApprovals=_useRequest.request;var handleDeny=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return denyWorkflowApprovals();case 2:onHandleToast(workflowApproval.id,/*i18n*/i18n._(\"Successfully Denied\"));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeny(){return _ref3.apply(this,arguments);};}();var _useDismissableError=useDismissableError(denyApprovalError),denyError=_useDismissableError.error,dismissDenyError=_useDismissableError.dismissError;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{\"aria-label\":hasBeenActedOn?/*i18n*/i18n._(\"This workflow has already been acted on\"):/*i18n*/i18n._(\"Deny\"),ouiaId:\"workflow-deny-button\",isDisabled:hasBeenActedOn,variant:isDetailView?'secondary':'plain',onClick:function onClick(){return handleDeny();},children:isDetailView?/*i18n*/i18n._(\"Deny\"):/*#__PURE__*/_jsx(OutlinedThumbsDownIcon,{})}),denyError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:denyError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissDenyError,children:[/*i18n*/i18n._(\"Failed to deny {0}.\",{0:workflowApproval.name}),/*#__PURE__*/_jsx(ErrorDetail,{error:denyError})]})]});}export default WorkflowDenyButton;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/WorkflowApproval/shared/WorkflowDenyButton.js"],"names":["React","useCallback","Button","OutlinedThumbsDownIcon","WorkflowApprovalsAPI","useRequest","useDismissableError","AlertModal","ErrorDetail","WorkflowDenyButton","isDetailView","workflowApproval","onHandleToast","hasBeenActedOn","Object","keys","summary_fields","approved_or_denied_by","length","status","id","deny","denyApprovalError","error","denyWorkflowApprovals","request","handleDeny","denyError","dismissDenyError","dismissError","name"],"mappings":"gPAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,KAAmC,OAAnC,CAEA,OAASC,MAAT,KAAuB,wBAAvB,CACA,OAASC,sBAAT,KAAuC,yBAAvC,CACA,OAASC,oBAAT,KAAqC,KAArC,CACA,MAAOC,CAAAA,UAAP,EAAqBC,mBAArB,KAAgD,kBAAhD,CAEA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,C,6IAEA,QAASC,CAAAA,kBAAT,MAA+E,IAAjDC,CAAAA,YAAiD,MAAjDA,YAAiD,CAAnCC,gBAAmC,MAAnCA,gBAAmC,CAAjBC,aAAiB,MAAjBA,aAAiB,CAC7E,GAAMC,CAAAA,cAAc,CAClBC,MAAM,CAACC,IAAP,CAAYJ,gBAAgB,CAACK,cAAjB,CAAgCC,qBAAhC,EAAyD,EAArE,EACGC,MADH,CACY,CADZ,EACiBP,gBAAgB,CAACQ,MAAjB,GAA4B,UAF/C,CAIA,GAAQC,CAAAA,EAAR,CAAeT,gBAAf,CAAQS,EAAR,CACA,gBACEf,UAAU,CACRJ,WAAW,sEAAC,mKAAYG,oBAAoB,CAACiB,IAArB,CAA0BD,EAA1B,CAAZ,wDAAD,GAA4C,CAACA,EAAD,CAA5C,CADH,CAER,EAFQ,CADZ,CAAeE,iBAAf,aAAQC,KAAR,CAA2CC,qBAA3C,aAAkCC,OAAlC,CAMA,GAAMC,CAAAA,UAAU,2FAAG,+JACXF,CAAAA,qBAAqB,EADV,QAEjBZ,aAAa,CAACD,gBAAgB,CAACS,EAAlB,SAAsB,6BAAtB,CAAb,CAFiB,wDAAH,kBAAVM,CAAAA,UAAU,2CAAhB,CAKA,yBACEpB,mBAAmB,CAACgB,iBAAD,CADrB,CAAeK,SAAf,sBAAQJ,KAAR,CAAwCK,gBAAxC,sBAA0BC,YAA1B,CAGA,mBACE,wCACE,KAAC,MAAD,EACE,aACEhB,cAAc,SAAG,iDAAH,SAAgD,cAFlE,CAIE,MAAM,CAAC,sBAJT,CAKE,UAAU,CAAEA,cALd,CAME,OAAO,CAAEH,YAAY,CAAG,WAAH,CAAiB,OANxC,CAOE,OAAO,CAAE,yBAAMgB,CAAAA,UAAU,EAAhB,EAPX,UASGhB,YAAY,SAAG,cAAH,cAAa,KAAC,sBAAD,IAT5B,EADF,CAYGiB,SAAS,eACR,MAAC,UAAD,EACE,MAAM,CAAEA,SADV,CAEE,OAAO,CAAC,OAFV,CAGE,KAAK,SAAE,gBAHT,CAIE,OAAO,CAAEC,gBAJX,mBAMG,gCAAmBjB,gBAAgB,CAACmB,IAApC,EANH,cAOE,KAAC,WAAD,EAAa,KAAK,CAAEH,SAApB,EAPF,GAbJ,GADF,CA0BD,CACD,cAAelB,CAAAA,kBAAf","sourcesContent":["import React, { useCallback } from 'react';\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { OutlinedThumbsDownIcon } from '@patternfly/react-icons';\nimport { WorkflowApprovalsAPI } from 'api';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\n\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\n\nfunction WorkflowDenyButton({ isDetailView, workflowApproval, onHandleToast }) {\n  const hasBeenActedOn =\n    Object.keys(workflowApproval.summary_fields.approved_or_denied_by || {})\n      .length > 0 || workflowApproval.status === 'canceled';\n\n  const { id } = workflowApproval;\n  const { error: denyApprovalError, request: denyWorkflowApprovals } =\n    useRequest(\n      useCallback(async () => WorkflowApprovalsAPI.deny(id), [id]),\n      {}\n    );\n\n  const handleDeny = async () => {\n    await denyWorkflowApprovals();\n    onHandleToast(workflowApproval.id, t`Successfully Denied`);\n  };\n\n  const { error: denyError, dismissError: dismissDenyError } =\n    useDismissableError(denyApprovalError);\n\n  return (\n    <>\n      <Button\n        aria-label={\n          hasBeenActedOn ? t`This workflow has already been acted on` : t`Deny`\n        }\n        ouiaId=\"workflow-deny-button\"\n        isDisabled={hasBeenActedOn}\n        variant={isDetailView ? 'secondary' : 'plain'}\n        onClick={() => handleDeny()}\n      >\n        {isDetailView ? t`Deny` : <OutlinedThumbsDownIcon />}\n      </Button>\n      {denyError && (\n        <AlertModal\n          isOpen={denyError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissDenyError}\n        >\n          {t`Failed to deny ${workflowApproval.name}.`}\n          <ErrorDetail error={denyError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\nexport default WorkflowDenyButton;\n"]},"metadata":{},"sourceType":"module"}