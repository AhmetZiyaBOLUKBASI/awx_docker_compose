{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{useLocation}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import{CredentialsAPI}from'api';import useSelected from'hooks/useSelected';import useToast,{AlertVariant}from'hooks/useToast';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import DataListToolbar from'components/DataListToolbar';import PaginatedTable,{HeaderRow,HeaderCell,ToolbarAddButton,ToolbarDeleteButton,getSearchableKeys}from'components/PaginatedTable';import useRequest,{useDeleteItems}from'hooks/useRequest';import{getQSConfig,parseQueryString}from'util/qs';import{relatedResourceDeleteRequests}from'util/getRelatedResourceDeleteDetails';import CredentialListItem from'./CredentialListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('credential',{page:1,page_size:20,order_by:'name'});function CredentialList(){var location=useLocation();var _useToast=useToast(),addToast=_useToast.addToast,Toast=_useToast.Toast,toastProps=_useToast.toastProps;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _credActions$data$act,_credActions$data$act2,_credActions$data;var params,_yield$Promise$all,_yield$Promise$all2,creds,credActions,searchKeys;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([CredentialsAPI.read(params),CredentialsAPI.readOptions()]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);creds=_yield$Promise$all2[0];credActions=_yield$Promise$all2[1];searchKeys=getSearchableKeys((_credActions$data$act=credActions.data.actions)===null||_credActions$data$act===void 0?void 0:_credActions$data$act.GET);if((_credActions$data$act2=credActions.data.actions)!==null&&_credActions$data$act2!==void 0&&_credActions$data$act2.GET.type){searchKeys.push({key:'credential_type__kind',type:'string'});}return _context.abrupt(\"return\",{credentials:creds.data.results,credentialCount:creds.data.count,actions:credActions.data.actions,relatedSearchableKeys:((credActions===null||credActions===void 0?void 0:(_credActions$data=credActions.data)===null||_credActions$data===void 0?void 0:_credActions$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:searchKeys});case 10:case\"end\":return _context.stop();}}},_callee);})),[location]),{credentials:[],credentialCount:0,actions:{},relatedSearchableKeys:[],searchableKeys:[]}),_useRequest$result=_useRequest.result,credentials=_useRequest$result.credentials,credentialCount=_useRequest$result.credentialCount,actions=_useRequest$result.actions,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys,contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchCredentials=_useRequest.request;useEffect(function(){fetchCredentials();},[fetchCredentials]);var _useSelected=useSelected(credentials),selected=_useSelected.selected,isAllSelected=_useSelected.isAllSelected,handleSelect=_useSelected.handleSelect,setSelected=_useSelected.setSelected,selectAll=_useSelected.selectAll,clearSelected=_useSelected.clearSelected;var _useDeleteItems=useDeleteItems(useCallback(function(){return Promise.all(selected.map(function(_ref2){var id=_ref2.id;return CredentialsAPI.destroy(id);}));},[selected]),{qsConfig:QS_CONFIG,allItemsSelected:isAllSelected,fetchItems:fetchCredentials}),isDeleteLoading=_useDeleteItems.isLoading,deleteCredentials=_useDeleteItems.deleteItems,deletionError=_useDeleteItems.deletionError,clearDeletionError=_useDeleteItems.clearDeletionError;var handleDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteCredentials();case 2:setSelected([]);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDelete(){return _ref3.apply(this,arguments);};}();var handleCopy=useCallback(function(newCredentialId){addToast({id:newCredentialId,title:/*i18n*/i18n._(\"Credential copied successfully\"),variant:AlertVariant.success,hasTimeout:true});},[addToast]);var canAdd=actions&&Object.prototype.hasOwnProperty.call(actions,'POST');var deleteDetailsRequests=relatedResourceDeleteRequests.credential(selected[0]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(PageSection,{children:[/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(PaginatedTable,{contentError:contentError,hasContentLoading:isLoading||isDeleteLoading,items:credentials,itemCount:credentialCount,qsConfig:QS_CONFIG,clearSelected:clearSelected,toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Description\"),key:'description__icontains'},{name:/*i18n*/i18n._(\"Created By (Username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified By (Username)\"),key:'modified_by__username__icontains'},{name:/*i18n*/i18n._(\"Credential Type\"),key:'credential_type__search'}],headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Type\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Actions\")})]}),renderRow:function renderRow(item,index){return/*#__PURE__*/_jsx(CredentialListItem,{credential:item,fetchCredentials:fetchCredentials,detailUrl:\"/credentials/\".concat(item.id,\"/details\"),isSelected:selected.some(function(row){return row.id===item.id;}),onSelect:function onSelect(){return handleSelect(item);},onCopy:handleCopy,rowIndex:index},item.id);},renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DataListToolbar,_objectSpread(_objectSpread({},props),{},{isAllSelected:isAllSelected,onSelectAll:selectAll,qsConfig:QS_CONFIG,additionalControls:[].concat(_toConsumableArray(canAdd?[/*#__PURE__*/_jsx(ToolbarAddButton,{linkTo:\"/credentials/add\"},\"add\")]:[]),[/*#__PURE__*/_jsx(ToolbarDeleteButton,{onDelete:handleDelete,itemsToDelete:selected,pluralizedItemName:/*i18n*/i18n._(\"Credentials\"),deleteDetailsRequests:deleteDetailsRequests,deleteMessage:/*#__PURE__*/_jsx(Trans,{id:\"{0, plural, one {This credential is currently being used by other resources. Are you sure you want to delete it?} other {Deleting these credentials could impact other resources that rely on them. Are you sure you want to delete anyway?}}\",values:{0:selected.length}})},\"delete\")])}));}})}),/*#__PURE__*/_jsxs(AlertModal,{\"aria-label\":/*i18n*/i18n._(\"Deletion Error\"),isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:clearDeletionError,children:[/*i18n*/i18n._(\"Failed to delete one or more credentials.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]}),/*#__PURE__*/_jsx(Toast,_objectSpread({},toastProps))]});}export default CredentialList;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Credential/CredentialList/CredentialList.js"],"names":["React","useEffect","useCallback","useLocation","Card","PageSection","CredentialsAPI","useSelected","useToast","AlertVariant","AlertModal","ErrorDetail","DataListToolbar","PaginatedTable","HeaderRow","HeaderCell","ToolbarAddButton","ToolbarDeleteButton","getSearchableKeys","useRequest","useDeleteItems","getQSConfig","parseQueryString","relatedResourceDeleteRequests","CredentialListItem","QS_CONFIG","page","page_size","order_by","CredentialList","location","addToast","Toast","toastProps","params","search","Promise","all","read","readOptions","creds","credActions","searchKeys","data","actions","GET","type","push","key","credentials","results","credentialCount","count","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","result","contentError","error","isLoading","fetchCredentials","request","selected","isAllSelected","handleSelect","setSelected","selectAll","clearSelected","id","destroy","qsConfig","allItemsSelected","fetchItems","isDeleteLoading","deleteCredentials","deleteItems","deletionError","clearDeletionError","handleDelete","handleCopy","newCredentialId","title","variant","success","hasTimeout","canAdd","Object","prototype","hasOwnProperty","call","deleteDetailsRequests","credential","name","isDefault","item","index","some","row","props","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { t, Plural } from '@lingui/macro';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { CredentialsAPI } from 'api';\nimport useSelected from 'hooks/useSelected';\nimport useToast, { AlertVariant } from 'hooks/useToast';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport DataListToolbar from 'components/DataListToolbar';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  ToolbarAddButton,\n  ToolbarDeleteButton,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport useRequest, { useDeleteItems } from 'hooks/useRequest';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport { relatedResourceDeleteRequests } from 'util/getRelatedResourceDeleteDetails';\nimport CredentialListItem from './CredentialListItem';\n\nconst QS_CONFIG = getQSConfig('credential', {\n  page: 1,\n  page_size: 20,\n  order_by: 'name',\n});\n\nfunction CredentialList() {\n  const location = useLocation();\n  const { addToast, Toast, toastProps } = useToast();\n\n  const {\n    result: {\n      credentials,\n      credentialCount,\n      actions,\n      relatedSearchableKeys,\n      searchableKeys,\n    },\n    error: contentError,\n    isLoading,\n    request: fetchCredentials,\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const [creds, credActions] = await Promise.all([\n        CredentialsAPI.read(params),\n        CredentialsAPI.readOptions(),\n      ]);\n      const searchKeys = getSearchableKeys(credActions.data.actions?.GET);\n      if (credActions.data.actions?.GET.type) {\n        searchKeys.push({ key: 'credential_type__kind', type: 'string' });\n      }\n      return {\n        credentials: creds.data.results,\n        credentialCount: creds.data.count,\n        actions: credActions.data.actions,\n        relatedSearchableKeys: (\n          credActions?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: searchKeys,\n      };\n    }, [location]),\n    {\n      credentials: [],\n      credentialCount: 0,\n      actions: {},\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchCredentials();\n  }, [fetchCredentials]);\n\n  const {\n    selected,\n    isAllSelected,\n    handleSelect,\n    setSelected,\n    selectAll,\n    clearSelected,\n  } = useSelected(credentials);\n\n  const {\n    isLoading: isDeleteLoading,\n    deleteItems: deleteCredentials,\n    deletionError,\n    clearDeletionError,\n  } = useDeleteItems(\n    useCallback(\n      () => Promise.all(selected.map(({ id }) => CredentialsAPI.destroy(id))),\n      [selected]\n    ),\n    {\n      qsConfig: QS_CONFIG,\n      allItemsSelected: isAllSelected,\n      fetchItems: fetchCredentials,\n    }\n  );\n\n  const handleDelete = async () => {\n    await deleteCredentials();\n    setSelected([]);\n  };\n\n  const handleCopy = useCallback(\n    (newCredentialId) => {\n      addToast({\n        id: newCredentialId,\n        title: t`Credential copied successfully`,\n        variant: AlertVariant.success,\n        hasTimeout: true,\n      });\n    },\n    [addToast]\n  );\n\n  const canAdd =\n    actions && Object.prototype.hasOwnProperty.call(actions, 'POST');\n  const deleteDetailsRequests = relatedResourceDeleteRequests.credential(\n    selected[0]\n  );\n  return (\n    <>\n      <PageSection>\n        <Card>\n          <PaginatedTable\n            contentError={contentError}\n            hasContentLoading={isLoading || isDeleteLoading}\n            items={credentials}\n            itemCount={credentialCount}\n            qsConfig={QS_CONFIG}\n            clearSelected={clearSelected}\n            toolbarSearchableKeys={searchableKeys}\n            toolbarRelatedSearchableKeys={relatedSearchableKeys}\n            toolbarSearchColumns={[\n              {\n                name: t`Name`,\n                key: 'name__icontains',\n                isDefault: true,\n              },\n              {\n                name: t`Description`,\n                key: 'description__icontains',\n              },\n              {\n                name: t`Created By (Username)`,\n                key: 'created_by__username__icontains',\n              },\n              {\n                name: t`Modified By (Username)`,\n                key: 'modified_by__username__icontains',\n              },\n              {\n                name: t`Credential Type`,\n                key: 'credential_type__search',\n              },\n            ]}\n            headerRow={\n              <HeaderRow qsConfig={QS_CONFIG}>\n                <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n                <HeaderCell>{t`Type`}</HeaderCell>\n                <HeaderCell>{t`Actions`}</HeaderCell>\n              </HeaderRow>\n            }\n            renderRow={(item, index) => (\n              <CredentialListItem\n                key={item.id}\n                credential={item}\n                fetchCredentials={fetchCredentials}\n                detailUrl={`/credentials/${item.id}/details`}\n                isSelected={selected.some((row) => row.id === item.id)}\n                onSelect={() => handleSelect(item)}\n                onCopy={handleCopy}\n                rowIndex={index}\n              />\n            )}\n            renderToolbar={(props) => (\n              <DataListToolbar\n                {...props}\n                isAllSelected={isAllSelected}\n                onSelectAll={selectAll}\n                qsConfig={QS_CONFIG}\n                additionalControls={[\n                  ...(canAdd\n                    ? [<ToolbarAddButton key=\"add\" linkTo=\"/credentials/add\" />]\n                    : []),\n                  <ToolbarDeleteButton\n                    key=\"delete\"\n                    onDelete={handleDelete}\n                    itemsToDelete={selected}\n                    pluralizedItemName={t`Credentials`}\n                    deleteDetailsRequests={deleteDetailsRequests}\n                    deleteMessage={\n                      <Plural\n                        value={selected.length}\n                        one=\"This credential is currently being used by other resources. Are you sure you want to delete it?\"\n                        other=\"Deleting these credentials could impact other resources that rely on them. Are you sure you want to delete anyway?\"\n                      />\n                    }\n                  />,\n                ]}\n              />\n            )}\n          />\n        </Card>\n        <AlertModal\n          aria-label={t`Deletion Error`}\n          isOpen={deletionError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={clearDeletionError}\n        >\n          {t`Failed to delete one or more credentials.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      </PageSection>\n      <Toast {...toastProps} />\n    </>\n  );\n}\n\nexport default CredentialList;\n"]},"metadata":{},"sourceType":"module"}