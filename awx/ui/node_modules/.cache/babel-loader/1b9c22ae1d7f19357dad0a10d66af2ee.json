{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect,useState}from'react';import{Link}from'react-router-dom';import styled from'styled-components';import{Badge,Dropdown,DropdownItem,DropdownToggle,DropdownPosition,PageHeaderTools,PageHeaderToolsGroup,PageHeaderToolsItem,Tooltip}from'@patternfly/react-core';import{BellIcon,QuestionCircleIcon,UserIcon}from'@patternfly/react-icons';import{WorkflowApprovalsAPI}from'api';import useRequest from'hooks/useRequest';import getDocsBaseUrl from'util/getDocsBaseUrl';import{useConfig}from'contexts/Config';import useWsPendingApprovalCount from'./useWsPendingApprovalCount';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PendingWorkflowApprovals=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  padding: 10px;\\n  margin-right: 10px;\\n\"])));var PendingWorkflowApprovalBadge=styled(Badge)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-left: 10px;\\n\"])));function PageHeaderToolbar(_ref){var isAboutDisabled=_ref.isAboutDisabled,onAboutClick=_ref.onAboutClick,onLogoutClick=_ref.onLogoutClick,loggedInUser=_ref.loggedInUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isHelpOpen=_useState2[0],setIsHelpOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isUserOpen=_useState4[0],setIsUserOpen=_useState4[1];var config=useConfig();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$WorkflowApprov,count;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return WorkflowApprovalsAPI.read({status:'pending',page_size:1});case 2:_yield$WorkflowApprov=_context.sent;count=_yield$WorkflowApprov.data.count;return _context.abrupt(\"return\",count);case 5:case\"end\":return _context.stop();}}},_callee);})),[]),0),fetchPendingApprovalCount=_useRequest.request,pendingApprovals=_useRequest.result;var pendingApprovalsCount=useWsPendingApprovalCount(pendingApprovals,fetchPendingApprovalCount);useEffect(function(){fetchPendingApprovalCount();},[fetchPendingApprovalCount]);var handleHelpSelect=function handleHelpSelect(){setIsHelpOpen(!isHelpOpen);};var handleUserSelect=function handleUserSelect(){setIsUserOpen(!isUserOpen);};return/*#__PURE__*/_jsx(PageHeaderTools,{children:/*#__PURE__*/_jsxs(PageHeaderToolsGroup,{children:[/*#__PURE__*/_jsx(Tooltip,{position:\"bottom\",content:/*i18n*/i18n._(\"Pending Workflow Approvals\"),children:/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Link,{to:\"/workflow_approvals?workflow_approvals.status=pending\",children:/*#__PURE__*/_jsxs(PendingWorkflowApprovals,{children:[/*#__PURE__*/_jsx(BellIcon,{color:\"white\"}),/*#__PURE__*/_jsx(PendingWorkflowApprovalBadge,{id:\"toolbar-workflow-approval-badge\",isRead:true,children:pendingApprovalsCount})]})})})}),/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Dropdown,{isPlain:true,isOpen:isHelpOpen,position:DropdownPosition.right,onSelect:handleHelpSelect,ouiaId:\"toolbar-info-dropdown\",toggle:/*#__PURE__*/_jsx(DropdownToggle,{onToggle:setIsHelpOpen,\"aria-label\":/*i18n*/i18n._(\"Info\"),ouiaId:\"toolbar-info-dropdown-toggle\",children:/*#__PURE__*/_jsx(QuestionCircleIcon,{})}),dropdownItems:[/*#__PURE__*/_jsx(DropdownItem,{target:\"_blank\",href:\"\".concat(getDocsBaseUrl(config),\"/html/userguide/index.html\"),ouiaId:\"help-dropdown-item\",children:/*i18n*/i18n._(\"Help\")},\"help\"),/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",isDisabled:isAboutDisabled,onClick:onAboutClick,ouiaId:\"about-dropdown-item\",children:/*i18n*/i18n._(\"About\")},\"about\")]})}),/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Dropdown,{id:\"toolbar-user-dropdown\",ouiaId:\"toolbar-user-dropdown\",isPlain:true,isOpen:isUserOpen,position:DropdownPosition.right,onSelect:handleUserSelect,toggle:/*#__PURE__*/_jsxs(DropdownToggle,{onToggle:setIsUserOpen,ouiaId:\"toolbar-user-dropdown-toggle\",children:[/*#__PURE__*/_jsx(UserIcon,{}),loggedInUser&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'10px'},children:loggedInUser.username})]}),dropdownItems:[/*#__PURE__*/_jsx(DropdownItem,{\"aria-label\":/*i18n*/i18n._(\"User details\"),href:loggedInUser?\"#/users/\".concat(loggedInUser.id,\"/details\"):'#/home',ouiaId:\"user-dropdown-item\",children:/*i18n*/i18n._(\"User Details\")},\"user\"),/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",onClick:onLogoutClick,id:\"logout-button\",ouiaId:\"logout-dropdown-item\",children:/*i18n*/i18n._(\"Logout\")},\"logout\")]})})]})});}PageHeaderToolbar.defaultProps={isAboutDisabled:false};export default PageHeaderToolbar;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/AppContainer/PageHeaderToolbar.js"],"names":["React","useCallback","useEffect","useState","Link","styled","Badge","Dropdown","DropdownItem","DropdownToggle","DropdownPosition","PageHeaderTools","PageHeaderToolsGroup","PageHeaderToolsItem","Tooltip","BellIcon","QuestionCircleIcon","UserIcon","WorkflowApprovalsAPI","useRequest","getDocsBaseUrl","useConfig","useWsPendingApprovalCount","PendingWorkflowApprovals","div","PendingWorkflowApprovalBadge","PageHeaderToolbar","isAboutDisabled","onAboutClick","onLogoutClick","loggedInUser","isHelpOpen","setIsHelpOpen","isUserOpen","setIsUserOpen","config","read","status","page_size","count","data","fetchPendingApprovalCount","request","pendingApprovals","result","pendingApprovalsCount","handleHelpSelect","handleUserSelect","right","marginLeft","username","id","defaultProps"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport { Link } from 'react-router-dom';\nimport styled from 'styled-components';\nimport {\n  Badge,\n  Dropdown,\n  DropdownItem,\n  DropdownToggle,\n  DropdownPosition,\n  PageHeaderTools,\n  PageHeaderToolsGroup,\n  PageHeaderToolsItem,\n  Tooltip,\n} from '@patternfly/react-core';\nimport {\n  BellIcon,\n  QuestionCircleIcon,\n  UserIcon,\n} from '@patternfly/react-icons';\nimport { WorkflowApprovalsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport getDocsBaseUrl from 'util/getDocsBaseUrl';\nimport { useConfig } from 'contexts/Config';\nimport useWsPendingApprovalCount from './useWsPendingApprovalCount';\n\nconst PendingWorkflowApprovals = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  margin-right: 10px;\n`;\n\nconst PendingWorkflowApprovalBadge = styled(Badge)`\n  margin-left: 10px;\n`;\n\nfunction PageHeaderToolbar({\n  isAboutDisabled,\n  onAboutClick,\n  onLogoutClick,\n  loggedInUser,\n}) {\n  const [isHelpOpen, setIsHelpOpen] = useState(false);\n  const [isUserOpen, setIsUserOpen] = useState(false);\n  const config = useConfig();\n\n  const { request: fetchPendingApprovalCount, result: pendingApprovals } =\n    useRequest(\n      useCallback(async () => {\n        const {\n          data: { count },\n        } = await WorkflowApprovalsAPI.read({\n          status: 'pending',\n          page_size: 1,\n        });\n        return count;\n      }, []),\n      0\n    );\n\n  const pendingApprovalsCount = useWsPendingApprovalCount(\n    pendingApprovals,\n    fetchPendingApprovalCount\n  );\n\n  useEffect(() => {\n    fetchPendingApprovalCount();\n  }, [fetchPendingApprovalCount]);\n\n  const handleHelpSelect = () => {\n    setIsHelpOpen(!isHelpOpen);\n  };\n\n  const handleUserSelect = () => {\n    setIsUserOpen(!isUserOpen);\n  };\n  return (\n    <PageHeaderTools>\n      <PageHeaderToolsGroup>\n        <Tooltip position=\"bottom\" content={t`Pending Workflow Approvals`}>\n          <PageHeaderToolsItem>\n            <Link to=\"/workflow_approvals?workflow_approvals.status=pending\">\n              <PendingWorkflowApprovals>\n                <BellIcon color=\"white\" />\n                <PendingWorkflowApprovalBadge\n                  id=\"toolbar-workflow-approval-badge\"\n                  isRead\n                >\n                  {pendingApprovalsCount}\n                </PendingWorkflowApprovalBadge>\n              </PendingWorkflowApprovals>\n            </Link>\n          </PageHeaderToolsItem>\n        </Tooltip>\n        <PageHeaderToolsItem>\n          <Dropdown\n            isPlain\n            isOpen={isHelpOpen}\n            position={DropdownPosition.right}\n            onSelect={handleHelpSelect}\n            ouiaId=\"toolbar-info-dropdown\"\n            toggle={\n              <DropdownToggle\n                onToggle={setIsHelpOpen}\n                aria-label={t`Info`}\n                ouiaId=\"toolbar-info-dropdown-toggle\"\n              >\n                <QuestionCircleIcon />\n              </DropdownToggle>\n            }\n            dropdownItems={[\n              <DropdownItem\n                key=\"help\"\n                target=\"_blank\"\n                href={`${getDocsBaseUrl(config)}/html/userguide/index.html`}\n                ouiaId=\"help-dropdown-item\"\n              >\n                {t`Help`}\n              </DropdownItem>,\n              <DropdownItem\n                key=\"about\"\n                component=\"button\"\n                isDisabled={isAboutDisabled}\n                onClick={onAboutClick}\n                ouiaId=\"about-dropdown-item\"\n              >\n                {t`About`}\n              </DropdownItem>,\n            ]}\n          />\n        </PageHeaderToolsItem>\n        <PageHeaderToolsItem>\n          <Dropdown\n            id=\"toolbar-user-dropdown\"\n            ouiaId=\"toolbar-user-dropdown\"\n            isPlain\n            isOpen={isUserOpen}\n            position={DropdownPosition.right}\n            onSelect={handleUserSelect}\n            toggle={\n              <DropdownToggle\n                onToggle={setIsUserOpen}\n                ouiaId=\"toolbar-user-dropdown-toggle\"\n              >\n                <UserIcon />\n                {loggedInUser && (\n                  <span style={{ marginLeft: '10px' }}>\n                    {loggedInUser.username}\n                  </span>\n                )}\n              </DropdownToggle>\n            }\n            dropdownItems={[\n              <DropdownItem\n                key=\"user\"\n                aria-label={t`User details`}\n                href={\n                  loggedInUser ? `#/users/${loggedInUser.id}/details` : '#/home'\n                }\n                ouiaId=\"user-dropdown-item\"\n              >\n                {t`User Details`}\n              </DropdownItem>,\n              <DropdownItem\n                key=\"logout\"\n                component=\"button\"\n                onClick={onLogoutClick}\n                id=\"logout-button\"\n                ouiaId=\"logout-dropdown-item\"\n              >\n                {t`Logout`}\n              </DropdownItem>,\n            ]}\n          />\n        </PageHeaderToolsItem>\n      </PageHeaderToolsGroup>\n    </PageHeaderTools>\n  );\n}\n\nPageHeaderToolbar.propTypes = {\n  isAboutDisabled: PropTypes.bool,\n  onAboutClick: PropTypes.func.isRequired,\n  onLogoutClick: PropTypes.func.isRequired,\n};\n\nPageHeaderToolbar.defaultProps = {\n  isAboutDisabled: false,\n};\n\nexport default PageHeaderToolbar;\n"]},"metadata":{},"sourceType":"module"}