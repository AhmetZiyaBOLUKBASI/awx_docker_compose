{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{useField,useFormikContext}from'formik';import styled from'styled-components';import{TimesIcon}from'@patternfly/react-icons';import{Button,Divider,FileUpload,Flex,FlexItem,FormGroup,ToggleGroup,ToggleGroupItem,Tooltip}from'@patternfly/react-core';import{useConfig}from'contexts/Config';import getDocsBaseUrl from'util/getDocsBaseUrl';import useModal from'hooks/useModal';import FormField,{PasswordField}from'components/FormField';import Popover from'components/Popover';import SubscriptionModal from'./SubscriptionModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LICENSELINK='https://www.ansible.com/license';var FileUploadField=styled(FormGroup)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  && {\\n    max-width: 500px;\\n    width: 100%;\\n  }\\n\"])));function SubscriptionStep(){var _config$license_info,_config$me,_subscription$value;var config=useConfig();var hasValidKey=Boolean(config===null||config===void 0?void 0:(_config$license_info=config.license_info)===null||_config$license_info===void 0?void 0:_config$license_info.valid_key);var _useFormikContext=useFormikContext(),values=_useFormikContext.values;var _useState=useState(values.subscription?'selectSubscription':'uploadManifest'),_useState2=_slicedToArray(_useState,2),isSelected=_useState2[0],setIsSelected=_useState2[1];var _useModal=useModal(),isModalOpen=_useModal.isModalOpen,toggleModal=_useModal.toggleModal,closeModal=_useModal.closeModal;var _useField=useField('manifest_file'),_useField2=_slicedToArray(_useField,3),manifest=_useField2[0],manifestMeta=_useField2[1],manifestHelpers=_useField2[2];var _useField3=useField('manifest_filename'),_useField4=_slicedToArray(_useField3,3),manifestFilename=_useField4[0],manifestFilenameHelpers=_useField4[2];var _useField5=useField('subscription'),_useField6=_slicedToArray(_useField5,3),subscription=_useField6[0],subscriptionHelpers=_useField6[2];var _useField7=useField('username'),_useField8=_slicedToArray(_useField7,3),username=_useField8[0],usernameMeta=_useField8[1],usernameHelpers=_useField8[2];var _useField9=useField('password'),_useField10=_slicedToArray(_useField9,3),password=_useField10[0],passwordMeta=_useField10[1],passwordHelpers=_useField10[2];return/*#__PURE__*/_jsxs(Flex,{direction:{default:'column'},spaceItems:{default:'spaceItemsMd'},alignItems:{default:'alignItemsBaseline'},children:[!hasValidKey&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:/*i18n*/i18n._(\"Welcome to Red Hat Ansible Automation Platform!\\nPlease complete the steps below to activate your subscription.\")}),/*#__PURE__*/_jsx(\"p\",{children:/*i18n*/i18n._(\"If you do not have a subscription, you can visit\\nRed Hat to obtain a trial subscription.\")}),/*#__PURE__*/_jsx(Button,{\"aria-label\":/*i18n*/i18n._(\"Request subscription\"),component:\"a\",href:LICENSELINK,ouiaId:\"request-subscription-button\",target:\"_blank\",variant:\"secondary\",children:/*i18n*/i18n._(\"Request subscription\")}),/*#__PURE__*/_jsx(Divider,{})]}),/*#__PURE__*/_jsx(\"p\",{children:/*i18n*/i18n._(\"Select your Ansible Automation Platform subscription to use.\")}),/*#__PURE__*/_jsxs(ToggleGroup,{children:[/*#__PURE__*/_jsx(ToggleGroupItem,{text:/*i18n*/i18n._(\"Subscription manifest\"),isSelected:isSelected==='uploadManifest',onChange:function onChange(){return setIsSelected('uploadManifest');},id:\"subscription-manifest\"}),/*#__PURE__*/_jsx(ToggleGroupItem,{text:/*i18n*/i18n._(\"Username / password\"),isSelected:isSelected==='selectSubscription',onChange:function onChange(){return setIsSelected('selectSubscription');},id:\"username-password\"})]}),isSelected==='uploadManifest'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(Trans,{id:\"Upload a Red Hat Subscription Manifest containing your subscription. To generate your subscription manifest, go to <0>subscription allocations</0> on the Red Hat Customer Portal.\",components:{0:/*#__PURE__*/_jsx(Button,{component:\"a\",href:\"https://access.redhat.com/management/subscription_allocations\",variant:\"link\",target:\"_blank\",ouiaId:\"subscription-allocations-link\",isInline:true})}})}),/*#__PURE__*/_jsx(FileUploadField,{fieldId:\"subscription-manifest\",validated:manifestMeta.error?'error':'default',helperTextInvalid:/*i18n*/i18n._(\"Invalid file format. Please upload a valid Red Hat Subscription Manifest.\"),label:/*i18n*/i18n._(\"Red Hat subscription manifest\"),helperText:/*i18n*/i18n._(\"Upload a .zip file\"),labelIcon:/*#__PURE__*/_jsx(Popover,{content:/*#__PURE__*/_jsx(Trans,{id:\"A subscription manifest is an export of a Red Hat Subscription. To generate a subscription manifest, go to <0>access.redhat.com</0>. For more information, see the <1>User Guide</1>.\",components:{0:/*#__PURE__*/_jsx(Button,{component:\"a\",href:\"https://access.redhat.com/management/subscription_allocations\",variant:\"link\",target:\"_blank\",isInline:true,ouiaId:\"subscription-allocations-link\"}),1:/*#__PURE__*/_jsx(Button,{component:\"a\",href:\"\".concat(getDocsBaseUrl(config),\"/html/userguide/import_license.html\"),variant:\"link\",target:\"_blank\",ouiaId:\"import-license-link\",isInline:true})}})}),children:/*#__PURE__*/_jsx(FileUpload,{id:\"upload-manifest\",value:manifest.value,filename:manifestFilename.value,browseButtonText:/*i18n*/i18n._(\"Browse\"),isDisabled:!(config!==null&&config!==void 0&&(_config$me=config.me)!==null&&_config$me!==void 0&&_config$me.is_superuser),dropzoneProps:{accept:'.zip',onDropRejected:function onDropRejected(){return manifestHelpers.setError(true);}},onChange:function onChange(value,filename){if(!value){manifestHelpers.setValue(null);manifestFilenameHelpers.setValue('');usernameHelpers.setValue(usernameMeta.initialValue);passwordHelpers.setValue(passwordMeta.initialValue);return;}try{var raw=new FileReader();raw.readAsBinaryString(value);raw.onload=function(){var rawValue=btoa(raw.result);manifestHelpers.setValue(rawValue);manifestFilenameHelpers.setValue(filename);};}catch(err){manifestHelpers.setError(err);}}})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:/*i18n*/i18n._(\"Provide your Red Hat or Red Hat Satellite credentials\\nbelow and you can choose from a list of your available subscriptions.\\nThe credentials you use will be stored for future use in\\nretrieving renewal or expanded subscriptions.\")}),/*#__PURE__*/_jsxs(Flex,{direction:{default:'column',md:'row'},spaceItems:{default:'spaceItemsMd'},alignItems:{md:'alignItemsFlexEnd'},fullWidth:{default:'fullWidth'},children:[/*#__PURE__*/_jsx(FormField,{id:\"username-field\",label:/*i18n*/i18n._(\"Username\"),name:\"username\",type:\"text\",isDisabled:!config.me.is_superuser}),/*#__PURE__*/_jsx(PasswordField,{id:\"password-field\",name:\"password\",label:/*i18n*/i18n._(\"Password\"),isDisabled:!config.me.is_superuser}),/*#__PURE__*/_jsx(Button,{\"aria-label\":/*i18n*/i18n._(\"Get subscriptions\"),ouiaId:\"subscription-modal-button\",onClick:toggleModal,style:{maxWidth:'fit-content'},isDisabled:!(username.value&&password.value),children:/*i18n*/i18n._(\"Get subscription\")}),isModalOpen&&/*#__PURE__*/_jsx(SubscriptionModal,{subscriptionCreds:{username:username.value,password:password.value},selectedSubscription:subscription===null||subscription===void 0?void 0:subscription.value,onClose:closeModal,onConfirm:function onConfirm(value){return subscriptionHelpers.setValue(value);}})]}),subscription.value&&/*#__PURE__*/_jsxs(Flex,{id:\"selected-subscription\",alignSelf:{default:'alignSelfFlexStart'},spaceItems:{default:'spaceItemsMd'},children:[/*#__PURE__*/_jsx(\"b\",{children:/*i18n*/i18n._(\"Selected\")}),/*#__PURE__*/_jsxs(FlexItem,{children:[/*#__PURE__*/_jsx(\"i\",{children:subscription===null||subscription===void 0?void 0:(_subscription$value=subscription.value)===null||_subscription$value===void 0?void 0:_subscription$value.subscription_name}),/*#__PURE__*/_jsx(Tooltip,{trigger:\"mouseenter focus click\",content:/*i18n*/i18n._(\"Clear subscription\"),children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return subscriptionHelpers.setValue(null);},variant:\"plain\",\"aria-label\":/*i18n*/i18n._(\"Clear subscription selection\"),ouiaId:\"clear-subscription-selection\",children:/*#__PURE__*/_jsx(TimesIcon,{})})})]})]})]})]});}export default SubscriptionStep;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Setting/Subscription/SubscriptionEdit/SubscriptionStep.js"],"names":["React","useState","useField","useFormikContext","styled","TimesIcon","Button","Divider","FileUpload","Flex","FlexItem","FormGroup","ToggleGroup","ToggleGroupItem","Tooltip","useConfig","getDocsBaseUrl","useModal","FormField","PasswordField","Popover","SubscriptionModal","LICENSELINK","FileUploadField","SubscriptionStep","config","hasValidKey","Boolean","license_info","valid_key","values","subscription","isSelected","setIsSelected","isModalOpen","toggleModal","closeModal","manifest","manifestMeta","manifestHelpers","manifestFilename","manifestFilenameHelpers","subscriptionHelpers","username","usernameMeta","usernameHelpers","password","passwordMeta","passwordHelpers","default","error","value","me","is_superuser","accept","onDropRejected","setError","filename","setValue","initialValue","raw","FileReader","readAsBinaryString","onload","rawValue","btoa","result","err","md","maxWidth","subscription_name"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\n\nimport { Trans, t } from '@lingui/macro';\nimport { useField, useFormikContext } from 'formik';\nimport styled from 'styled-components';\nimport { TimesIcon } from '@patternfly/react-icons';\nimport {\n  Button,\n  Divider,\n  FileUpload,\n  Flex,\n  FlexItem,\n  FormGroup,\n  ToggleGroup,\n  ToggleGroupItem,\n  Tooltip,\n} from '@patternfly/react-core';\nimport { useConfig } from 'contexts/Config';\nimport getDocsBaseUrl from 'util/getDocsBaseUrl';\nimport useModal from 'hooks/useModal';\nimport FormField, { PasswordField } from 'components/FormField';\nimport Popover from 'components/Popover';\nimport SubscriptionModal from './SubscriptionModal';\n\nconst LICENSELINK = 'https://www.ansible.com/license';\nconst FileUploadField = styled(FormGroup)`\n  && {\n    max-width: 500px;\n    width: 100%;\n  }\n`;\n\nfunction SubscriptionStep() {\n  const config = useConfig();\n  const hasValidKey = Boolean(config?.license_info?.valid_key);\n\n  const { values } = useFormikContext();\n\n  const [isSelected, setIsSelected] = useState(\n    values.subscription ? 'selectSubscription' : 'uploadManifest'\n  );\n  const { isModalOpen, toggleModal, closeModal } = useModal();\n  const [manifest, manifestMeta, manifestHelpers] = useField('manifest_file');\n  const [manifestFilename, , manifestFilenameHelpers] =\n    useField('manifest_filename');\n  const [subscription, , subscriptionHelpers] = useField('subscription');\n  const [username, usernameMeta, usernameHelpers] = useField('username');\n  const [password, passwordMeta, passwordHelpers] = useField('password');\n\n  return (\n    <Flex\n      direction={{ default: 'column' }}\n      spaceItems={{ default: 'spaceItemsMd' }}\n      alignItems={{ default: 'alignItemsBaseline' }}\n    >\n      {!hasValidKey && (\n        <>\n          <b>\n            {t`Welcome to Red Hat Ansible Automation Platform!\n              Please complete the steps below to activate your subscription.`}\n          </b>\n          <p>\n            {t`If you do not have a subscription, you can visit\n            Red Hat to obtain a trial subscription.`}\n          </p>\n          <Button\n            aria-label={t`Request subscription`}\n            component=\"a\"\n            href={LICENSELINK}\n            ouiaId=\"request-subscription-button\"\n            target=\"_blank\"\n            variant=\"secondary\"\n          >\n            {t`Request subscription`}\n          </Button>\n          <Divider />\n        </>\n      )}\n      <p>{t`Select your Ansible Automation Platform subscription to use.`}</p>\n      <ToggleGroup>\n        <ToggleGroupItem\n          text={t`Subscription manifest`}\n          isSelected={isSelected === 'uploadManifest'}\n          onChange={() => setIsSelected('uploadManifest')}\n          id=\"subscription-manifest\"\n        />\n        <ToggleGroupItem\n          text={t`Username / password`}\n          isSelected={isSelected === 'selectSubscription'}\n          onChange={() => setIsSelected('selectSubscription')}\n          id=\"username-password\"\n        />\n      </ToggleGroup>\n      {isSelected === 'uploadManifest' ? (\n        <>\n          <p>\n            <Trans>\n              Upload a Red Hat Subscription Manifest containing your\n              subscription. To generate your subscription manifest, go to{' '}\n              <Button\n                component=\"a\"\n                href=\"https://access.redhat.com/management/subscription_allocations\"\n                variant=\"link\"\n                target=\"_blank\"\n                ouiaId=\"subscription-allocations-link\"\n                isInline\n              >\n                subscription allocations\n              </Button>{' '}\n              on the Red Hat Customer Portal.\n            </Trans>\n          </p>\n          <FileUploadField\n            fieldId=\"subscription-manifest\"\n            validated={manifestMeta.error ? 'error' : 'default'}\n            helperTextInvalid={t`Invalid file format. Please upload a valid Red Hat Subscription Manifest.`}\n            label={t`Red Hat subscription manifest`}\n            helperText={t`Upload a .zip file`}\n            labelIcon={\n              <Popover\n                content={\n                  <Trans>\n                    A subscription manifest is an export of a Red Hat\n                    Subscription. To generate a subscription manifest, go to{' '}\n                    <Button\n                      component=\"a\"\n                      href=\"https://access.redhat.com/management/subscription_allocations\"\n                      variant=\"link\"\n                      target=\"_blank\"\n                      isInline\n                      ouiaId=\"subscription-allocations-link\"\n                    >\n                      access.redhat.com\n                    </Button>\n                    . For more information, see the{' '}\n                    <Button\n                      component=\"a\"\n                      href={`${getDocsBaseUrl(\n                        config\n                      )}/html/userguide/import_license.html`}\n                      variant=\"link\"\n                      target=\"_blank\"\n                      ouiaId=\"import-license-link\"\n                      isInline\n                    >\n                      User Guide\n                    </Button>\n                    .\n                  </Trans>\n                }\n              />\n            }\n          >\n            <FileUpload\n              id=\"upload-manifest\"\n              value={manifest.value}\n              filename={manifestFilename.value}\n              browseButtonText={t`Browse`}\n              isDisabled={!config?.me?.is_superuser}\n              dropzoneProps={{\n                accept: '.zip',\n                onDropRejected: () => manifestHelpers.setError(true),\n              }}\n              onChange={(value, filename) => {\n                if (!value) {\n                  manifestHelpers.setValue(null);\n                  manifestFilenameHelpers.setValue('');\n                  usernameHelpers.setValue(usernameMeta.initialValue);\n                  passwordHelpers.setValue(passwordMeta.initialValue);\n                  return;\n                }\n\n                try {\n                  const raw = new FileReader();\n                  raw.readAsBinaryString(value);\n                  raw.onload = () => {\n                    const rawValue = btoa(raw.result);\n                    manifestHelpers.setValue(rawValue);\n                    manifestFilenameHelpers.setValue(filename);\n                  };\n                } catch (err) {\n                  manifestHelpers.setError(err);\n                }\n              }}\n            />\n          </FileUploadField>\n        </>\n      ) : (\n        <>\n          <p>\n            {t`Provide your Red Hat or Red Hat Satellite credentials\n                 below and you can choose from a list of your available subscriptions.\n                 The credentials you use will be stored for future use in\n                 retrieving renewal or expanded subscriptions.`}\n          </p>\n          <Flex\n            direction={{ default: 'column', md: 'row' }}\n            spaceItems={{ default: 'spaceItemsMd' }}\n            alignItems={{ md: 'alignItemsFlexEnd' }}\n            fullWidth={{ default: 'fullWidth' }}\n          >\n            <FormField\n              id=\"username-field\"\n              label={t`Username`}\n              name=\"username\"\n              type=\"text\"\n              isDisabled={!config.me.is_superuser}\n            />\n            <PasswordField\n              id=\"password-field\"\n              name=\"password\"\n              label={t`Password`}\n              isDisabled={!config.me.is_superuser}\n            />\n            <Button\n              aria-label={t`Get subscriptions`}\n              ouiaId=\"subscription-modal-button\"\n              onClick={toggleModal}\n              style={{ maxWidth: 'fit-content' }}\n              isDisabled={!(username.value && password.value)}\n            >\n              {t`Get subscription`}\n            </Button>\n            {isModalOpen && (\n              <SubscriptionModal\n                subscriptionCreds={{\n                  username: username.value,\n                  password: password.value,\n                }}\n                selectedSubscription={subscription?.value}\n                onClose={closeModal}\n                onConfirm={(value) => subscriptionHelpers.setValue(value)}\n              />\n            )}\n          </Flex>\n          {subscription.value && (\n            <Flex\n              id=\"selected-subscription\"\n              alignSelf={{ default: 'alignSelfFlexStart' }}\n              spaceItems={{ default: 'spaceItemsMd' }}\n            >\n              <b>{t`Selected`}</b>\n              <FlexItem>\n                <i>{subscription?.value?.subscription_name}</i>\n                <Tooltip\n                  trigger=\"mouseenter focus click\"\n                  content={t`Clear subscription`}\n                >\n                  <Button\n                    onClick={() => subscriptionHelpers.setValue(null)}\n                    variant=\"plain\"\n                    aria-label={t`Clear subscription selection`}\n                    ouiaId=\"clear-subscription-selection\"\n                  >\n                    <TimesIcon />\n                  </Button>\n                </Tooltip>\n              </FlexItem>\n            </Flex>\n          )}\n        </>\n      )}\n    </Flex>\n  );\n}\nexport default SubscriptionStep;\n"]},"metadata":{},"sourceType":"module"}