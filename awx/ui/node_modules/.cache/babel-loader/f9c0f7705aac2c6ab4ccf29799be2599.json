{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{Route,Switch,Redirect,useParams,useLocation,Link}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{ApplicationsAPI}from'api';import ContentError from'components/ContentError';import RoutedTabs from'components/RoutedTabs';import ApplicationEdit from'../ApplicationEdit';import ApplicationDetails from'../ApplicationDetails';import ApplicationTokens from'../ApplicationTokens';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Application(_ref){var setBreadcrumb=_ref.setBreadcrumb;var _useParams=useParams(),id=_useParams.id;var _useLocation=useLocation(),pathname=_useLocation.pathname;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,detail,options,authorization,clientType;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([ApplicationsAPI.readDetail(id),ApplicationsAPI.readOptions()]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);detail=_yield$Promise$all2[0];options=_yield$Promise$all2[1];authorization=options.data.actions.GET.authorization_grant_type.choices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});clientType=options.data.actions.GET.client_type.choices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});setBreadcrumb(detail.data);return _context.abrupt(\"return\",{application:detail.data,authorizationOptions:authorization,clientTypeOptions:clientType});case 10:case\"end\":return _context.stop();}}},_callee);})),[setBreadcrumb,id]),{authorizationOptions:[],clientTypeOptions:[]}),isLoading=_useRequest.isLoading,error=_useRequest.error,_useRequest$result=_useRequest.result,application=_useRequest$result.application,authorizationOptions=_useRequest$result.authorizationOptions,clientTypeOptions=_useRequest$result.clientTypeOptions,fetchApplication=_useRequest.request;useEffect(function(){fetchApplication();},[fetchApplication,pathname]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to applications\")]}),link:'/applications',id:0,isBackButton:true},{name:/*i18n*/i18n._(\"Details\"),link:\"/applications/\".concat(id,\"/details\"),id:1},{name:/*i18n*/i18n._(\"Tokens\"),link:\"/applications/\".concat(id,\"/tokens\"),id:2}];var cardHeader=/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray});if(pathname.endsWith('edit')){cardHeader=null;}if(!isLoading&&error){var _error$response;return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Application not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/applications\",children:/*i18n*/i18n._(\"View all applications.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[cardHeader,/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/applications/:id\",to:\"/applications/:id/details\",exact:true}),application&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/edit\",children:/*#__PURE__*/_jsx(ApplicationEdit,{authorizationOptions:authorizationOptions,clientTypeOptions:clientTypeOptions,application:application})}),/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/details\",children:/*#__PURE__*/_jsx(ApplicationDetails,{application:application,authorizationOptions:authorizationOptions,clientTypeOptions:clientTypeOptions})}),/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/tokens\",children:/*#__PURE__*/_jsx(ApplicationTokens,{application:application})})]})]})]})});}export default Application;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Application/Application/Application.js"],"names":["React","useCallback","useEffect","Route","Switch","Redirect","useParams","useLocation","Link","CaretLeftIcon","Card","PageSection","useRequest","ApplicationsAPI","ContentError","RoutedTabs","ApplicationEdit","ApplicationDetails","ApplicationTokens","Application","setBreadcrumb","id","pathname","Promise","all","readDetail","readOptions","detail","options","authorization","data","actions","GET","authorization_grant_type","choices","map","choice","value","label","key","clientType","client_type","application","authorizationOptions","clientTypeOptions","isLoading","error","result","fetchApplication","request","tabsArray","name","link","isBackButton","cardHeader","endsWith","response","status"],"mappings":"uVAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,SAA7B,KAA8C,OAA9C,CACA,OACEC,KADF,CAEEC,MAFF,CAGEC,QAHF,CAIEC,SAJF,CAKEC,WALF,CAMEC,IANF,KAOO,kBAPP,CAUA,OAASC,aAAT,KAA8B,yBAA9B,CACA,OAASC,IAAT,CAAeC,WAAf,KAAkC,wBAAlC,CAEA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,OAASC,eAAT,KAAgC,KAAhC,CACA,MAAOC,CAAAA,YAAP,KAAyB,yBAAzB,CACA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,eAAP,KAA4B,oBAA5B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,uBAA/B,CACA,MAAOC,CAAAA,iBAAP,KAA8B,sBAA9B,C,6IAEA,QAASC,CAAAA,WAAT,MAAwC,IAAjBC,CAAAA,aAAiB,MAAjBA,aAAiB,CACtC,eAAed,SAAS,EAAxB,CAAQe,EAAR,YAAQA,EAAR,CACA,iBAAqBd,WAAW,EAAhC,CAAQe,QAAR,cAAQA,QAAR,CACA,gBAKIV,UAAU,CACZX,WAAW,sEAAC,4OACsBsB,CAAAA,OAAO,CAACC,GAAR,CAAY,CAC1CX,eAAe,CAACY,UAAhB,CAA2BJ,EAA3B,CAD0C,CAE1CR,eAAe,CAACa,WAAhB,EAF0C,CAAZ,CADtB,kGACHC,MADG,wBACKC,OADL,wBAKJC,aALI,CAMRD,OAAO,CAACE,IAAR,CAAaC,OAAb,CAAqBC,GAArB,CAAyBC,wBAAzB,CAAkDC,OAAlD,CAA0DC,GAA1D,CACE,SAACC,MAAD,QAAa,CACXC,KAAK,CAAED,MAAM,CAAC,CAAD,CADF,CAEXE,KAAK,CAAEF,MAAM,CAAC,CAAD,CAFF,CAGXG,GAAG,CAAEH,MAAM,CAAC,CAAD,CAHA,CAAb,EADF,CANQ,CAaJI,UAbI,CAaSZ,OAAO,CAACE,IAAR,CAAaC,OAAb,CAAqBC,GAArB,CAAyBS,WAAzB,CAAqCP,OAArC,CAA6CC,GAA7C,CACjB,SAACC,MAAD,QAAa,CACXC,KAAK,CAAED,MAAM,CAAC,CAAD,CADF,CAEXE,KAAK,CAAEF,MAAM,CAAC,CAAD,CAFF,CAGXG,GAAG,CAAEH,MAAM,CAAC,CAAD,CAHA,CAAb,EADiB,CAbT,CAoBVhB,aAAa,CAACO,MAAM,CAACG,IAAR,CAAb,CApBU,gCAsBH,CACLY,WAAW,CAAEf,MAAM,CAACG,IADf,CAELa,oBAAoB,CAAEd,aAFjB,CAGLe,iBAAiB,CAAEJ,UAHd,CAtBG,yDAAD,GA2BR,CAACpB,aAAD,CAAgBC,EAAhB,CA3BQ,CADC,CA6BZ,CAAEsB,oBAAoB,CAAE,EAAxB,CAA4BC,iBAAiB,CAAE,EAA/C,CA7BY,CALd,CACEC,SADF,aACEA,SADF,CAEEC,KAFF,aAEEA,KAFF,gCAGEC,MAHF,CAGYL,WAHZ,oBAGYA,WAHZ,CAGyBC,oBAHzB,oBAGyBA,oBAHzB,CAG+CC,iBAH/C,oBAG+CA,iBAH/C,CAIWI,gBAJX,aAIEC,OAJF,CAqCA/C,SAAS,CAAC,UAAM,CACd8C,gBAAgB,GACjB,CAFQ,CAEN,CAACA,gBAAD,CAAmB1B,QAAnB,CAFM,CAAT,CAIA,GAAM4B,CAAAA,SAAS,CAAG,CAChB,CACEC,IAAI,cACF,wCACE,KAAC,aAAD,IADF,SAEG,8BAFH,GAFJ,CAOEC,IAAI,CAAE,eAPR,CAQE/B,EAAE,CAAE,CARN,CASEgC,YAAY,CAAE,IAThB,CADgB,CAYhB,CAAEF,IAAI,SAAE,iBAAR,CAAoBC,IAAI,yBAAmB/B,EAAnB,YAAxB,CAAyDA,EAAE,CAAE,CAA7D,CAZgB,CAahB,CAAE8B,IAAI,SAAE,gBAAR,CAAmBC,IAAI,yBAAmB/B,EAAnB,WAAvB,CAAuDA,EAAE,CAAE,CAA3D,CAbgB,CAAlB,CAgBA,GAAIiC,CAAAA,UAAU,cAAG,KAAC,UAAD,EAAY,SAAS,CAAEJ,SAAvB,EAAjB,CACA,GAAI5B,QAAQ,CAACiC,QAAT,CAAkB,MAAlB,CAAJ,CAA+B,CAC7BD,UAAU,CAAG,IAAb,CACD,CAED,GAAI,CAACT,SAAD,EAAcC,KAAlB,CAAyB,qBACvB,mBACE,KAAC,WAAD,wBACE,KAAC,IAAD,wBACE,KAAC,YAAD,EAAc,KAAK,CAAEA,KAArB,UACG,kBAAAA,KAAK,CAACU,QAAN,0DAAgBC,MAAhB,IAA2B,GAA3B,eACC,gCACG,gCADH,CAC8B,GAD9B,cAEE,KAAC,IAAD,EAAM,EAAE,CAAC,eAAT,kBAA0B,gCAA1B,EAFF,GAFJ,EADF,EADF,EADF,CAcD,CAED,mBACE,KAAC,WAAD,wBACE,MAAC,IAAD,YACGH,UADH,cAEE,MAAC,MAAD,yBACE,KAAC,QAAD,EACE,IAAI,CAAC,mBADP,CAEE,EAAE,CAAC,2BAFL,CAGE,KAAK,KAHP,EADF,CAMGZ,WAAW,eACV,wCACE,KAAC,KAAD,EAAO,IAAI,CAAC,wBAAZ,uBACE,KAAC,eAAD,EACE,oBAAoB,CAAEC,oBADxB,CAEE,iBAAiB,CAAEC,iBAFrB,CAGE,WAAW,CAAEF,WAHf,EADF,EADF,cAQE,KAAC,KAAD,EAAO,IAAI,CAAC,2BAAZ,uBACE,KAAC,kBAAD,EACE,WAAW,CAAEA,WADf,CAEE,oBAAoB,CAAEC,oBAFxB,CAGE,iBAAiB,CAAEC,iBAHrB,EADF,EARF,cAeE,KAAC,KAAD,EAAO,IAAI,CAAC,0BAAZ,uBACE,KAAC,iBAAD,EAAmB,WAAW,CAAEF,WAAhC,EADF,EAfF,GAPJ,GAFF,GADF,EADF,CAmCD,CACD,cAAevB,CAAAA,WAAf","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport {\n  Route,\n  Switch,\n  Redirect,\n  useParams,\n  useLocation,\n  Link,\n} from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\n\nimport useRequest from 'hooks/useRequest';\nimport { ApplicationsAPI } from 'api';\nimport ContentError from 'components/ContentError';\nimport RoutedTabs from 'components/RoutedTabs';\nimport ApplicationEdit from '../ApplicationEdit';\nimport ApplicationDetails from '../ApplicationDetails';\nimport ApplicationTokens from '../ApplicationTokens';\n\nfunction Application({ setBreadcrumb }) {\n  const { id } = useParams();\n  const { pathname } = useLocation();\n  const {\n    isLoading,\n    error,\n    result: { application, authorizationOptions, clientTypeOptions },\n    request: fetchApplication,\n  } = useRequest(\n    useCallback(async () => {\n      const [detail, options] = await Promise.all([\n        ApplicationsAPI.readDetail(id),\n        ApplicationsAPI.readOptions(),\n      ]);\n      const authorization =\n        options.data.actions.GET.authorization_grant_type.choices.map(\n          (choice) => ({\n            value: choice[0],\n            label: choice[1],\n            key: choice[0],\n          })\n        );\n      const clientType = options.data.actions.GET.client_type.choices.map(\n        (choice) => ({\n          value: choice[0],\n          label: choice[1],\n          key: choice[0],\n        })\n      );\n      setBreadcrumb(detail.data);\n\n      return {\n        application: detail.data,\n        authorizationOptions: authorization,\n        clientTypeOptions: clientType,\n      };\n    }, [setBreadcrumb, id]),\n    { authorizationOptions: [], clientTypeOptions: [] }\n  );\n\n  useEffect(() => {\n    fetchApplication();\n  }, [fetchApplication, pathname]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to applications`}\n        </>\n      ),\n      link: '/applications',\n      id: 0,\n      isBackButton: true,\n    },\n    { name: t`Details`, link: `/applications/${id}/details`, id: 1 },\n    { name: t`Tokens`, link: `/applications/${id}/tokens`, id: 2 },\n  ];\n\n  let cardHeader = <RoutedTabs tabsArray={tabsArray} />;\n  if (pathname.endsWith('edit')) {\n    cardHeader = null;\n  }\n\n  if (!isLoading && error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response?.status === 404 && (\n              <span>\n                {t`Application not found.`}{' '}\n                <Link to=\"/applications\">{t`View all applications.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {cardHeader}\n        <Switch>\n          <Redirect\n            from=\"/applications/:id\"\n            to=\"/applications/:id/details\"\n            exact\n          />\n          {application && (\n            <>\n              <Route path=\"/applications/:id/edit\">\n                <ApplicationEdit\n                  authorizationOptions={authorizationOptions}\n                  clientTypeOptions={clientTypeOptions}\n                  application={application}\n                />\n              </Route>\n              <Route path=\"/applications/:id/details\">\n                <ApplicationDetails\n                  application={application}\n                  authorizationOptions={authorizationOptions}\n                  clientTypeOptions={clientTypeOptions}\n                />\n              </Route>\n              <Route path=\"/applications/:id/tokens\">\n                <ApplicationTokens application={application} />\n              </Route>\n            </>\n          )}\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\nexport default Application;\n"]},"metadata":{},"sourceType":"module"}