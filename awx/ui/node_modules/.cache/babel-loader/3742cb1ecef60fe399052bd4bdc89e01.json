{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useContext,useEffect,useState}from'react';import styled from'styled-components';import{Alert,Badge,Button,DropdownItem,Tooltip}from'@patternfly/react-core';import{KebabifiedContext}from'contexts/Kebabified';import{getRelatedResourceDeleteCounts}from'util/getRelatedResourceDeleteDetails';import AlertModal from'../AlertModal';import ErrorDetail from'../ErrorDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WarningMessage=styled(Alert)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n\"])));var Label=styled.span(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  && {\\n    margin-right: 10px;\\n  }\\n\"])));function ToolbarDeleteButton(_ref){var _itemsToDelete$2;var itemsToDelete=_ref.itemsToDelete,pluralizedItemName=_ref.pluralizedItemName,errorMessage=_ref.errorMessage,onDelete=_ref.onDelete,deleteDetailsRequests=_ref.deleteDetailsRequests,warningMessage=_ref.warningMessage,deleteMessage=_ref.deleteMessage,cannotDelete=_ref.cannotDelete;var _useContext=useContext(KebabifiedContext),isKebabified=_useContext.isKebabified,onKebabModalChange=_useContext.onKebabModalChange;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isModalOpen=_useState2[0],setIsModalOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),deleteDetails=_useState4[0],setDeleteDetails=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),deleteMessageError=_useState8[0],setDeleteMessageError=_useState8[1];var handleDelete=function handleDelete(){onDelete();toggleModal();};var toggleModal=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(isOpen){var _yield$getRelatedReso,results,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);setDeleteDetails(null);if(!(isOpen&&itemsToDelete.length===1&&(deleteDetailsRequests===null||deleteDetailsRequests===void 0?void 0:deleteDetailsRequests.length)>0)){_context.next=9;break;}_context.next=5;return getRelatedResourceDeleteCounts(deleteDetailsRequests);case 5:_yield$getRelatedReso=_context.sent;results=_yield$getRelatedReso.results;error=_yield$getRelatedReso.error;if(error){setDeleteMessageError(error);}else{setDeleteDetails(results);}case 9:setIsLoading(false);setIsModalOpen(isOpen);case 11:case\"end\":return _context.stop();}}},_callee);}));return function toggleModal(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(isKebabified){onKebabModalChange(isModalOpen);}},[isKebabified,isModalOpen,onKebabModalChange]);var renderTooltip=function renderTooltip(){var itemsUnableToDelete=itemsToDelete.filter(cannotDelete).map(function(item){return item.name||item.username;}).join(', ');if(itemsToDelete.some(cannotDelete)){return/*#__PURE__*/_jsx(\"div\",{children:errorMessage?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:errorMessage}),/*#__PURE__*/_jsx(\"span\",{children:\": \".concat(itemsUnableToDelete)})]}):/*i18n*/i18n._(\"You do not have permission to delete {pluralizedItemName}: {itemsUnableToDelete}\",{pluralizedItemName:pluralizedItemName,itemsUnableToDelete:itemsUnableToDelete})});}if(itemsToDelete.length){return(/*i18n*/i18n._(\"Delete\"));}return(/*i18n*/i18n._(\"Select a row to delete\"));};var modalTitle=/*i18n*/i18n._(\"Delete {pluralizedItemName}?\",{pluralizedItemName:pluralizedItemName});var isDisabled=itemsToDelete.length===0||itemsToDelete.some(cannotDelete);var buildDeleteWarning=function buildDeleteWarning(){var deleteMessages=[];if(warningMessage){deleteMessages.push(warningMessage);}if(deleteMessage){var _itemsToDelete$;if(((_itemsToDelete$=itemsToDelete[0])===null||_itemsToDelete$===void 0?void 0:_itemsToDelete$.type)!=='inventory'&&(itemsToDelete.length>1||deleteDetails)){deleteMessages.push(deleteMessage);}else if(deleteDetails||itemsToDelete.length>1){deleteMessages.push(deleteMessage);}}return/*#__PURE__*/_jsxs(\"div\",{children:[deleteMessages.map(function(message){return/*#__PURE__*/_jsx(\"div\",{\"aria-label\":message,children:message},message);}),deleteDetails&&Object.entries(deleteDetails).map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return/*#__PURE__*/_jsxs(\"div\",{\"aria-label\":\"\".concat(key,\": \").concat(value),children:[/*#__PURE__*/_jsx(Label,{children:key}),/*#__PURE__*/_jsx(Badge,{children:value})]},key);})]});};if(deleteMessageError){return/*#__PURE__*/_jsx(AlertModal,{isOpen:deleteMessageError,title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){toggleModal(false);setDeleteMessageError();},children:/*#__PURE__*/_jsx(ErrorDetail,{error:deleteMessageError})});}var shouldShowDeleteWarning=warningMessage||itemsToDelete.length===1&&deleteDetails||itemsToDelete.length>1&&deleteMessage;return/*#__PURE__*/_jsxs(_Fragment,{children:[isKebabified?/*#__PURE__*/_jsx(Tooltip,{content:renderTooltip(),position:\"top\",children:/*#__PURE__*/_jsx(DropdownItem,{isDisabled:isDisabled,isLoading:isLoading,ouiaId:\"delete-button\",spinnerAriaValueText:isLoading?'Loading':undefined,component:\"button\",onClick:function onClick(){toggleModal(true);},children:/*i18n*/i18n._(\"Delete\")},\"add\")}):/*#__PURE__*/_jsx(Tooltip,{content:renderTooltip(),position:\"top\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",isLoading:isLoading,ouiaId:\"delete-button\",spinnerAriaValueText:isLoading?'Loading':undefined,\"aria-label\":/*i18n*/i18n._(\"Delete\"),onClick:function onClick(){return toggleModal(true);},isDisabled:isDisabled,children:/*i18n*/i18n._(\"Delete\")})})}),isModalOpen&&/*#__PURE__*/_jsxs(AlertModal,{variant:\"danger\",title:modalTitle,isOpen:isModalOpen,onClose:function onClose(){return toggleModal(false);},actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-modal-confirm\",variant:\"danger\",\"aria-label\":/*i18n*/i18n._(\"confirm delete\"),isDisabled:Boolean(deleteDetails&&((_itemsToDelete$2=itemsToDelete[0])===null||_itemsToDelete$2===void 0?void 0:_itemsToDelete$2.type)==='credential_type'),onClick:handleDelete,children:/*i18n*/i18n._(\"Delete\")},\"delete\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-cancel\",variant:\"link\",\"aria-label\":/*i18n*/i18n._(\"cancel delete\"),onClick:function onClick(){return toggleModal(false);},children:/*i18n*/i18n._(\"Cancel\")},\"cancel\")],children:[/*#__PURE__*/_jsx(\"div\",{children:/*i18n*/i18n._(\"This action will delete the following:\")}),itemsToDelete.map(function(item){return/*#__PURE__*/_jsxs(\"span\",{id:\"item-to-be-deleted-\".concat(item.id),children:[/*#__PURE__*/_jsx(\"strong\",{children:item.name||item.username||item.image}),/*#__PURE__*/_jsx(\"br\",{})]},item.id);}),shouldShowDeleteWarning&&/*#__PURE__*/_jsx(WarningMessage,{variant:\"warning\",isInline:true,title:buildDeleteWarning()})]})]});}ToolbarDeleteButton.defaultProps={pluralizedItemName:'Items',warningMessage:null,cannotDelete:function cannotDelete(item){return!item.summary_fields.user_capabilities.delete;}};export default ToolbarDeleteButton;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/PaginatedTable/ToolbarDeleteButton.js"],"names":["React","useContext","useEffect","useState","styled","Alert","Badge","Button","DropdownItem","Tooltip","KebabifiedContext","getRelatedResourceDeleteCounts","AlertModal","ErrorDetail","WarningMessage","Label","span","ToolbarDeleteButton","itemsToDelete","pluralizedItemName","errorMessage","onDelete","deleteDetailsRequests","warningMessage","deleteMessage","cannotDelete","isKebabified","onKebabModalChange","isModalOpen","setIsModalOpen","deleteDetails","setDeleteDetails","isLoading","setIsLoading","deleteMessageError","setDeleteMessageError","handleDelete","toggleModal","isOpen","length","results","error","renderTooltip","itemsUnableToDelete","filter","map","item","name","username","join","some","modalTitle","isDisabled","buildDeleteWarning","deleteMessages","push","type","message","Object","entries","key","value","shouldShowDeleteWarning","undefined","Boolean","id","image","defaultProps","summary_fields","user_capabilities","delete"],"mappings":"mfAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,SAA5B,CAAuCC,QAAvC,KAAuD,OAAvD,CAWA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OACEC,KADF,CAEEC,KAFF,CAGEC,MAHF,CAIEC,YAJF,CAKEC,OALF,KAMO,wBANP,CAQA,OAASC,iBAAT,KAAkC,qBAAlC,CACA,OAASC,8BAAT,KAA+C,sCAA/C,CACA,MAAOC,CAAAA,UAAP,KAAuB,eAAvB,CAEA,MAAOC,CAAAA,WAAP,KAAwB,gBAAxB,C,6IAEA,GAAMC,CAAAA,cAAc,CAAGV,MAAM,CAACC,KAAD,CAAT,wFAApB,CAIA,GAAMU,CAAAA,KAAK,CAAGX,MAAM,CAACY,IAAV,2GAAX,CA0DA,QAASC,CAAAA,mBAAT,MASG,yBARDC,CAAAA,aAQC,MARDA,aAQC,CAPDC,kBAOC,MAPDA,kBAOC,CANDC,YAMC,MANDA,YAMC,CALDC,QAKC,MALDA,QAKC,CAJDC,qBAIC,MAJDA,qBAIC,CAHDC,cAGC,MAHDA,cAGC,CAFDC,aAEC,MAFDA,aAEC,CADDC,YACC,MADDA,YACC,CACD,gBAA6CxB,UAAU,CAACS,iBAAD,CAAvD,CAAQgB,YAAR,aAAQA,YAAR,CAAsBC,kBAAtB,aAAsBA,kBAAtB,CACA,cAAsCxB,QAAQ,CAAC,KAAD,CAA9C,wCAAOyB,WAAP,eAAoBC,cAApB,eACA,eAA0C1B,QAAQ,CAAC,IAAD,CAAlD,yCAAO2B,aAAP,eAAsBC,gBAAtB,eACA,eAAkC5B,QAAQ,CAAC,KAAD,CAA1C,yCAAO6B,SAAP,eAAkBC,YAAlB,eAEA,eAAoD9B,QAAQ,EAA5D,yCAAO+B,kBAAP,eAA2BC,qBAA3B,eACA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBf,QAAQ,GACRgB,WAAW,GACZ,CAHD,CAKA,GAAMA,CAAAA,WAAW,2FAAG,iBAAOC,MAAP,0JAClBL,YAAY,CAAC,IAAD,CAAZ,CACAF,gBAAgB,CAAC,IAAD,CAAhB,CAFkB,KAIhBO,MAAM,EACNpB,aAAa,CAACqB,MAAd,GAAyB,CADzB,EAEA,CAAAjB,qBAAqB,OAArB,EAAAA,qBAAqB,SAArB,QAAAA,qBAAqB,CAAEiB,MAAvB,EAAgC,CANhB,gDAQiB5B,CAAAA,8BAA8B,CAC7DW,qBAD6D,CAR/C,4CAQRkB,OARQ,uBAQRA,OARQ,CAQCC,KARD,uBAQCA,KARD,CAYhB,GAAIA,KAAJ,CAAW,CACTN,qBAAqB,CAACM,KAAD,CAArB,CACD,CAFD,IAEO,CACLV,gBAAgB,CAACS,OAAD,CAAhB,CACD,CAhBe,OAkBlBP,YAAY,CAAC,KAAD,CAAZ,CACAJ,cAAc,CAACS,MAAD,CAAd,CAnBkB,uDAAH,kBAAXD,CAAAA,WAAW,6CAAjB,CAsBAnC,SAAS,CAAC,UAAM,CACd,GAAIwB,YAAJ,CAAkB,CAChBC,kBAAkB,CAACC,WAAD,CAAlB,CACD,CACF,CAJQ,CAIN,CAACF,YAAD,CAAeE,WAAf,CAA4BD,kBAA5B,CAJM,CAAT,CAMA,GAAMe,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1B,GAAMC,CAAAA,mBAAmB,CAAGzB,aAAa,CACtC0B,MADyB,CAClBnB,YADkB,EAEzBoB,GAFyB,CAErB,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACC,IAAL,EAAaD,IAAI,CAACE,QAA5B,EAFqB,EAGzBC,IAHyB,CAGpB,IAHoB,CAA5B,CAIA,GAAI/B,aAAa,CAACgC,IAAd,CAAmBzB,YAAnB,CAAJ,CAAsC,CACpC,mBACE,qBACGL,YAAY,cACX,wCACE,sBAAOA,YAAP,EADF,cAEE,kCAAYuB,mBAAZ,GAFF,GADW,SAMX,8GAAyCxB,kBAAzC,qBAAgEwB,mBAAhE,EAPJ,EADF,CAYD,CACD,GAAIzB,aAAa,CAACqB,MAAlB,CAA0B,CACxB,eAAO,gBAAP,EACD,CACD,eAAO,gCAAP,EACD,CAvBD,CAyBA,GAAMY,CAAAA,UAAU,SAAG,0DAAWhC,kBAAX,EAAnB,CAEA,GAAMiC,CAAAA,UAAU,CACdlC,aAAa,CAACqB,MAAd,GAAyB,CAAzB,EAA8BrB,aAAa,CAACgC,IAAd,CAAmBzB,YAAnB,CADhC,CAGA,GAAM4B,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAM,CAC/B,GAAMC,CAAAA,cAAc,CAAG,EAAvB,CACA,GAAI/B,cAAJ,CAAoB,CAClB+B,cAAc,CAACC,IAAf,CAAoBhC,cAApB,EACD,CACD,GAAIC,aAAJ,CAAmB,qBACjB,GACE,kBAAAN,aAAa,CAAC,CAAD,CAAb,0DAAkBsC,IAAlB,IAA2B,WAA3B,GACCtC,aAAa,CAACqB,MAAd,CAAuB,CAAvB,EAA4BT,aAD7B,CADF,CAGE,CACAwB,cAAc,CAACC,IAAf,CAAoB/B,aAApB,EACD,CALD,IAKO,IAAIM,aAAa,EAAIZ,aAAa,CAACqB,MAAd,CAAuB,CAA5C,CAA+C,CACpDe,cAAc,CAACC,IAAf,CAAoB/B,aAApB,EACD,CACF,CACD,mBACE,uBACG8B,cAAc,CAACT,GAAf,CAAmB,SAACY,OAAD,qBAClB,YAAK,aAAYA,OAAjB,UACGA,OADH,EAA+BA,OAA/B,CADkB,EAAnB,CADH,CAMG3B,aAAa,EACZ4B,MAAM,CAACC,OAAP,CAAe7B,aAAf,EAA8Be,GAA9B,CAAkC,kDAAEe,GAAF,UAAOC,KAAP,6BAChC,aAAe,uBAAeD,GAAf,cAAuBC,KAAvB,CAAf,wBACE,KAAC,KAAD,WAAQD,GAAR,EADF,cAEE,KAAC,KAAD,WAAQC,KAAR,EAFF,GAAUD,GAAV,CADgC,EAAlC,CAPJ,GADF,CAgBD,CA/BD,CAiCA,GAAI1B,kBAAJ,CAAwB,CACtB,mBACE,KAAC,UAAD,EACE,MAAM,CAAEA,kBADV,CAEE,KAAK,SAAE,gBAFT,CAGE,OAAO,CAAE,kBAAM,CACbG,WAAW,CAAC,KAAD,CAAX,CACAF,qBAAqB,GACtB,CANH,uBAQE,KAAC,WAAD,EAAa,KAAK,CAAED,kBAApB,EARF,EADF,CAYD,CACD,GAAM4B,CAAAA,uBAAuB,CAC3BvC,cAAc,EACbL,aAAa,CAACqB,MAAd,GAAyB,CAAzB,EAA8BT,aAD/B,EAECZ,aAAa,CAACqB,MAAd,CAAuB,CAAvB,EAA4Bf,aAH/B,CAKA,mBACE,2BACGE,YAAY,cACX,KAAC,OAAD,EAAS,OAAO,CAAEgB,aAAa,EAA/B,CAAmC,QAAQ,CAAC,KAA5C,uBACE,KAAC,YAAD,EAEE,UAAU,CAAEU,UAFd,CAGE,SAAS,CAAEpB,SAHb,CAIE,MAAM,CAAC,eAJT,CAKE,oBAAoB,CAAEA,SAAS,CAAG,SAAH,CAAe+B,SALhD,CAME,SAAS,CAAC,QANZ,CAOE,OAAO,CAAE,kBAAM,CACb1B,WAAW,CAAC,IAAD,CAAX,CACD,CATH,kBAWG,gBAXH,EACM,KADN,CADF,EADW,cAiBX,KAAC,OAAD,EAAS,OAAO,CAAEK,aAAa,EAA/B,CAAmC,QAAQ,CAAC,KAA5C,uBACE,kCACE,KAAC,MAAD,EACE,OAAO,CAAC,WADV,CAEE,SAAS,CAAEV,SAFb,CAGE,MAAM,CAAC,eAHT,CAIE,oBAAoB,CAAEA,SAAS,CAAG,SAAH,CAAe+B,SAJhD,CAKE,qBAAY,gBALd,CAME,OAAO,CAAE,yBAAM1B,CAAAA,WAAW,CAAC,IAAD,CAAjB,EANX,CAOE,UAAU,CAAEe,UAPd,kBASG,gBATH,EADF,EADF,EAlBJ,CAmCGxB,WAAW,eACV,MAAC,UAAD,EACE,OAAO,CAAC,QADV,CAEE,KAAK,CAAEuB,UAFT,CAGE,MAAM,CAAEvB,WAHV,CAIE,OAAO,CAAE,yBAAMS,CAAAA,WAAW,CAAC,KAAD,CAAjB,EAJX,CAKE,OAAO,CAAE,cACP,KAAC,MAAD,EACE,MAAM,CAAC,sBADT,CAGE,OAAO,CAAC,QAHV,CAIE,qBAAY,wBAJd,CAKE,UAAU,CAAE2B,OAAO,CACjBlC,aAAa,EAAI,mBAAAZ,aAAa,CAAC,CAAD,CAAb,4DAAkBsC,IAAlB,IAA2B,iBAD3B,CALrB,CAQE,OAAO,CAAEpB,YARX,kBAUG,gBAVH,EAEM,QAFN,CADO,cAaP,KAAC,MAAD,EACE,MAAM,CAAC,eADT,CAGE,OAAO,CAAC,MAHV,CAIE,qBAAY,uBAJd,CAKE,OAAO,CAAE,yBAAMC,CAAAA,WAAW,CAAC,KAAD,CAAjB,EALX,kBAOG,gBAPH,EAEM,QAFN,CAbO,CALX,wBA6BE,6BAAM,gDAAN,EA7BF,CA8BGnB,aAAa,CAAC2B,GAAd,CAAkB,SAACC,IAAD,qBACjB,cAAoB,EAAE,8BAAwBA,IAAI,CAACmB,EAA7B,CAAtB,wBACE,wBAASnB,IAAI,CAACC,IAAL,EAAaD,IAAI,CAACE,QAAlB,EAA8BF,IAAI,CAACoB,KAA5C,EADF,cAEE,aAFF,GAAWpB,IAAI,CAACmB,EAAhB,CADiB,EAAlB,CA9BH,CAoCGH,uBAAuB,eACtB,KAAC,cAAD,EACE,OAAO,CAAC,SADV,CAEE,QAAQ,KAFV,CAGE,KAAK,CAAET,kBAAkB,EAH3B,EArCJ,GApCJ,GADF,CAoFD,CAUDpC,mBAAmB,CAACkD,YAApB,CAAmC,CACjChD,kBAAkB,CAAE,OADa,CAEjCI,cAAc,CAAE,IAFiB,CAGjCE,YAAY,CAAE,sBAACqB,IAAD,QAAU,CAACA,IAAI,CAACsB,cAAL,CAAoBC,iBAApB,CAAsCC,MAAjD,EAHmB,CAAnC,CAMA,cAAerD,CAAAA,mBAAf","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport {\n  func,\n  bool,\n  node,\n  number,\n  string,\n  arrayOf,\n  shape,\n  checkPropTypes,\n} from 'prop-types';\nimport styled from 'styled-components';\nimport {\n  Alert,\n  Badge,\n  Button,\n  DropdownItem,\n  Tooltip,\n} from '@patternfly/react-core';\nimport { t } from '@lingui/macro';\nimport { KebabifiedContext } from 'contexts/Kebabified';\nimport { getRelatedResourceDeleteCounts } from 'util/getRelatedResourceDeleteDetails';\nimport AlertModal from '../AlertModal';\n\nimport ErrorDetail from '../ErrorDetail';\n\nconst WarningMessage = styled(Alert)`\n  margin-top: 10px;\n`;\n\nconst Label = styled.span`\n  && {\n    margin-right: 10px;\n  }\n`;\n\nconst requiredField = (props) => {\n  const { name, username, image } = props;\n  if (!name && !username && !image) {\n    return new Error(\n      `One of 'name', 'username' or 'image' is required by ItemToDelete component.`\n    );\n  }\n  if (name) {\n    checkPropTypes(\n      {\n        name: string,\n      },\n      { name: props.name },\n      'prop',\n      'ItemToDelete'\n    );\n  }\n  if (username) {\n    checkPropTypes(\n      {\n        username: string,\n      },\n      { username: props.username },\n      'prop',\n      'ItemToDelete'\n    );\n  }\n  if (image) {\n    checkPropTypes(\n      {\n        image: string,\n      },\n      { image: props.image },\n      'prop',\n      'ItemToDelete'\n    );\n  }\n  return null;\n};\n\nconst ItemToDelete = shape({\n  id: number.isRequired,\n  name: requiredField,\n  username: requiredField,\n  image: requiredField,\n  summary_fields: shape({\n    user_capabilities: shape({\n      delete: bool.isRequired,\n    }).isRequired,\n  }).isRequired,\n});\n\nfunction ToolbarDeleteButton({\n  itemsToDelete,\n  pluralizedItemName,\n  errorMessage,\n  onDelete,\n  deleteDetailsRequests,\n  warningMessage,\n  deleteMessage,\n  cannotDelete,\n}) {\n  const { isKebabified, onKebabModalChange } = useContext(KebabifiedContext);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [deleteDetails, setDeleteDetails] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [deleteMessageError, setDeleteMessageError] = useState();\n  const handleDelete = () => {\n    onDelete();\n    toggleModal();\n  };\n\n  const toggleModal = async (isOpen) => {\n    setIsLoading(true);\n    setDeleteDetails(null);\n    if (\n      isOpen &&\n      itemsToDelete.length === 1 &&\n      deleteDetailsRequests?.length > 0\n    ) {\n      const { results, error } = await getRelatedResourceDeleteCounts(\n        deleteDetailsRequests\n      );\n\n      if (error) {\n        setDeleteMessageError(error);\n      } else {\n        setDeleteDetails(results);\n      }\n    }\n    setIsLoading(false);\n    setIsModalOpen(isOpen);\n  };\n\n  useEffect(() => {\n    if (isKebabified) {\n      onKebabModalChange(isModalOpen);\n    }\n  }, [isKebabified, isModalOpen, onKebabModalChange]);\n\n  const renderTooltip = () => {\n    const itemsUnableToDelete = itemsToDelete\n      .filter(cannotDelete)\n      .map((item) => item.name || item.username)\n      .join(', ');\n    if (itemsToDelete.some(cannotDelete)) {\n      return (\n        <div>\n          {errorMessage ? (\n            <>\n              <span>{errorMessage}</span>\n              <span>{`: ${itemsUnableToDelete}`}</span>\n            </>\n          ) : (\n            t`You do not have permission to delete ${pluralizedItemName}: ${itemsUnableToDelete}`\n          )}\n        </div>\n      );\n    }\n    if (itemsToDelete.length) {\n      return t`Delete`;\n    }\n    return t`Select a row to delete`;\n  };\n\n  const modalTitle = t`Delete ${pluralizedItemName}?`;\n\n  const isDisabled =\n    itemsToDelete.length === 0 || itemsToDelete.some(cannotDelete);\n\n  const buildDeleteWarning = () => {\n    const deleteMessages = [];\n    if (warningMessage) {\n      deleteMessages.push(warningMessage);\n    }\n    if (deleteMessage) {\n      if (\n        itemsToDelete[0]?.type !== 'inventory' &&\n        (itemsToDelete.length > 1 || deleteDetails)\n      ) {\n        deleteMessages.push(deleteMessage);\n      } else if (deleteDetails || itemsToDelete.length > 1) {\n        deleteMessages.push(deleteMessage);\n      }\n    }\n    return (\n      <div>\n        {deleteMessages.map((message) => (\n          <div aria-label={message} key={message}>\n            {message}\n          </div>\n        ))}\n        {deleteDetails &&\n          Object.entries(deleteDetails).map(([key, value]) => (\n            <div key={key} aria-label={`${key}: ${value}`}>\n              <Label>{key}</Label>\n              <Badge>{value}</Badge>\n            </div>\n          ))}\n      </div>\n    );\n  };\n\n  if (deleteMessageError) {\n    return (\n      <AlertModal\n        isOpen={deleteMessageError}\n        title={t`Error!`}\n        onClose={() => {\n          toggleModal(false);\n          setDeleteMessageError();\n        }}\n      >\n        <ErrorDetail error={deleteMessageError} />\n      </AlertModal>\n    );\n  }\n  const shouldShowDeleteWarning =\n    warningMessage ||\n    (itemsToDelete.length === 1 && deleteDetails) ||\n    (itemsToDelete.length > 1 && deleteMessage);\n\n  return (\n    <>\n      {isKebabified ? (\n        <Tooltip content={renderTooltip()} position=\"top\">\n          <DropdownItem\n            key=\"add\"\n            isDisabled={isDisabled}\n            isLoading={isLoading}\n            ouiaId=\"delete-button\"\n            spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n            component=\"button\"\n            onClick={() => {\n              toggleModal(true);\n            }}\n          >\n            {t`Delete`}\n          </DropdownItem>\n        </Tooltip>\n      ) : (\n        <Tooltip content={renderTooltip()} position=\"top\">\n          <div>\n            <Button\n              variant=\"secondary\"\n              isLoading={isLoading}\n              ouiaId=\"delete-button\"\n              spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n              aria-label={t`Delete`}\n              onClick={() => toggleModal(true)}\n              isDisabled={isDisabled}\n            >\n              {t`Delete`}\n            </Button>\n          </div>\n        </Tooltip>\n      )}\n\n      {isModalOpen && (\n        <AlertModal\n          variant=\"danger\"\n          title={modalTitle}\n          isOpen={isModalOpen}\n          onClose={() => toggleModal(false)}\n          actions={[\n            <Button\n              ouiaId=\"delete-modal-confirm\"\n              key=\"delete\"\n              variant=\"danger\"\n              aria-label={t`confirm delete`}\n              isDisabled={Boolean(\n                deleteDetails && itemsToDelete[0]?.type === 'credential_type'\n              )}\n              onClick={handleDelete}\n            >\n              {t`Delete`}\n            </Button>,\n            <Button\n              ouiaId=\"delete-cancel\"\n              key=\"cancel\"\n              variant=\"link\"\n              aria-label={t`cancel delete`}\n              onClick={() => toggleModal(false)}\n            >\n              {t`Cancel`}\n            </Button>,\n          ]}\n        >\n          <div>{t`This action will delete the following:`}</div>\n          {itemsToDelete.map((item) => (\n            <span key={item.id} id={`item-to-be-deleted-${item.id}`}>\n              <strong>{item.name || item.username || item.image}</strong>\n              <br />\n            </span>\n          ))}\n          {shouldShowDeleteWarning && (\n            <WarningMessage\n              variant=\"warning\"\n              isInline\n              title={buildDeleteWarning()}\n            />\n          )}\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nToolbarDeleteButton.propTypes = {\n  onDelete: func.isRequired,\n  itemsToDelete: arrayOf(ItemToDelete).isRequired,\n  pluralizedItemName: string,\n  warningMessage: node,\n  cannotDelete: func,\n};\n\nToolbarDeleteButton.defaultProps = {\n  pluralizedItemName: 'Items',\n  warningMessage: null,\n  cannotDelete: (item) => !item.summary_fields.user_capabilities.delete,\n};\n\nexport default ToolbarDeleteButton;\n"]},"metadata":{},"sourceType":"module"}