{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import styled from'styled-components';import{Button,Badge,Alert,Tooltip}from'@patternfly/react-core';import{getRelatedResourceDeleteCounts}from'util/getRelatedResourceDeleteDetails';import AlertModal from'../AlertModal';import ErrorDetail from'../ErrorDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var WarningMessage=styled(Alert)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n\"])));var Label=styled.span(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  && {\\n    margin-right: 10px;\\n  }\\n\"])));function DeleteButton(_ref){var onConfirm=_ref.onConfirm,modalTitle=_ref.modalTitle,name=_ref.name,variant=_ref.variant,children=_ref.children,isDisabled=_ref.isDisabled,ouiaId=_ref.ouiaId,deleteMessage=_ref.deleteMessage,deleteDetailsRequests=_ref.deleteDetailsRequests,disabledTooltip=_ref.disabledTooltip;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),deleteMessageError=_useState4[0],setDeleteMessageError=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),deleteDetails=_useState6[0],setDeleteDetails=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var toggleModal=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(isModalOpen){var _yield$getRelatedReso,results,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);if(!(deleteDetailsRequests!==null&&deleteDetailsRequests!==void 0&&deleteDetailsRequests.length&&isModalOpen)){_context.next=8;break;}_context.next=4;return getRelatedResourceDeleteCounts(deleteDetailsRequests);case 4:_yield$getRelatedReso=_context.sent;results=_yield$getRelatedReso.results;error=_yield$getRelatedReso.error;if(error){setDeleteMessageError(error);}else{setDeleteDetails(results);}case 8:setIsLoading(false);setIsOpen(isModalOpen);case 10:case\"end\":return _context.stop();}}},_callee);}));return function toggleModal(_x){return _ref2.apply(this,arguments);};}();if(deleteMessageError){return/*#__PURE__*/_jsx(AlertModal,{isOpen:deleteMessageError,title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){toggleModal(false);setDeleteMessageError();},children:/*#__PURE__*/_jsx(ErrorDetail,{error:deleteMessageError})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[disabledTooltip?/*#__PURE__*/_jsx(Tooltip,{content:disabledTooltip,position:\"top\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{isLoading:isLoading,spinnerAriaValueText:isLoading?'Loading':undefined,variant:variant||'secondary',\"aria-label\":/*i18n*/i18n._(\"Delete\"),isDisabled:isDisabled,onClick:function onClick(){return toggleModal(true);},ouiaId:ouiaId,children:children||/*i18n*/i18n._(\"Delete\")})})}):/*#__PURE__*/_jsx(Button,{ouiaId:ouiaId,isLoading:isLoading,spinnerAriaValueText:isLoading?'Loading':undefined,variant:variant||'secondary',\"aria-label\":/*i18n*/i18n._(\"Delete\"),isDisabled:isDisabled,onClick:function onClick(){return toggleModal(true);},children:children||/*i18n*/i18n._(\"Delete\")}),/*#__PURE__*/_jsxs(AlertModal,{isOpen:isOpen,title:modalTitle,variant:\"danger\",onClose:function onClose(){return toggleModal(false);},actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-modal-confirm\",variant:\"danger\",\"aria-label\":/*i18n*/i18n._(\"Confirm Delete\"),isDisabled:isDisabled,onClick:function onClick(){onConfirm();toggleModal(false);},children:/*i18n*/i18n._(\"Delete\")},\"delete\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-modal-cancel\",variant:\"link\",\"aria-label\":/*i18n*/i18n._(\"Cancel\"),onClick:function onClick(){return toggleModal(false);},children:/*i18n*/i18n._(\"Cancel\")},\"cancel\")],children:[/*i18n*/i18n._(\"Are you sure you want to delete:\"),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:name}),Object.values(deleteDetails).length>0&&/*#__PURE__*/_jsx(WarningMessage,{variant:\"warning\",isInline:true,title:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{\"aria-label\":deleteMessage,children:deleteMessage}),/*#__PURE__*/_jsx(\"br\",{}),Object.entries(deleteDetails).map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return/*#__PURE__*/_jsxs(\"div\",{\"aria-label\":\"\".concat(key,\": \").concat(value),children:[/*#__PURE__*/_jsx(Label,{children:key}),\" \",/*#__PURE__*/_jsx(Badge,{children:value})]},key);})]})})]})]});}DeleteButton.defaultProps={ouiaId:null};export default DeleteButton;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/DeleteButton/DeleteButton.js"],"names":["React","useState","styled","Button","Badge","Alert","Tooltip","getRelatedResourceDeleteCounts","AlertModal","ErrorDetail","WarningMessage","Label","span","DeleteButton","onConfirm","modalTitle","name","variant","children","isDisabled","ouiaId","deleteMessage","deleteDetailsRequests","disabledTooltip","isOpen","setIsOpen","deleteMessageError","setDeleteMessageError","deleteDetails","setDeleteDetails","isLoading","setIsLoading","toggleModal","isModalOpen","length","results","error","undefined","Object","values","entries","map","key","value","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport styled from 'styled-components';\nimport { Button, Badge, Alert, Tooltip } from '@patternfly/react-core';\nimport { getRelatedResourceDeleteCounts } from 'util/getRelatedResourceDeleteDetails';\nimport AlertModal from '../AlertModal';\nimport ErrorDetail from '../ErrorDetail';\n\nconst WarningMessage = styled(Alert)`\n  margin-top: 10px;\n`;\nconst Label = styled.span`\n  && {\n    margin-right: 10px;\n  }\n`;\nfunction DeleteButton({\n  onConfirm,\n  modalTitle,\n  name,\n  variant,\n  children,\n  isDisabled,\n  ouiaId,\n  deleteMessage,\n  deleteDetailsRequests,\n  disabledTooltip,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [deleteMessageError, setDeleteMessageError] = useState();\n  const [deleteDetails, setDeleteDetails] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n\n  const toggleModal = async (isModalOpen) => {\n    setIsLoading(true);\n    if (deleteDetailsRequests?.length && isModalOpen) {\n      const { results, error } = await getRelatedResourceDeleteCounts(\n        deleteDetailsRequests\n      );\n      if (error) {\n        setDeleteMessageError(error);\n      } else {\n        setDeleteDetails(results);\n      }\n    }\n    setIsLoading(false);\n    setIsOpen(isModalOpen);\n  };\n\n  if (deleteMessageError) {\n    return (\n      <AlertModal\n        isOpen={deleteMessageError}\n        title={t`Error!`}\n        onClose={() => {\n          toggleModal(false);\n          setDeleteMessageError();\n        }}\n      >\n        <ErrorDetail error={deleteMessageError} />\n      </AlertModal>\n    );\n  }\n  return (\n    <>\n      {disabledTooltip ? (\n        <Tooltip content={disabledTooltip} position=\"top\">\n          <div>\n            <Button\n              isLoading={isLoading}\n              spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n              variant={variant || 'secondary'}\n              aria-label={t`Delete`}\n              isDisabled={isDisabled}\n              onClick={() => toggleModal(true)}\n              ouiaId={ouiaId}\n            >\n              {children || t`Delete`}\n            </Button>\n          </div>\n        </Tooltip>\n      ) : (\n        <Button\n          ouiaId={ouiaId}\n          isLoading={isLoading}\n          spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n          variant={variant || 'secondary'}\n          aria-label={t`Delete`}\n          isDisabled={isDisabled}\n          onClick={() => toggleModal(true)}\n        >\n          {children || t`Delete`}\n        </Button>\n      )}\n      <AlertModal\n        isOpen={isOpen}\n        title={modalTitle}\n        variant=\"danger\"\n        onClose={() => toggleModal(false)}\n        actions={[\n          <Button\n            ouiaId=\"delete-modal-confirm\"\n            key=\"delete\"\n            variant=\"danger\"\n            aria-label={t`Confirm Delete`}\n            isDisabled={isDisabled}\n            onClick={() => {\n              onConfirm();\n              toggleModal(false);\n            }}\n          >\n            {t`Delete`}\n          </Button>,\n          <Button\n            ouiaId=\"delete-modal-cancel\"\n            key=\"cancel\"\n            variant=\"link\"\n            aria-label={t`Cancel`}\n            onClick={() => toggleModal(false)}\n          >\n            {t`Cancel`}\n          </Button>,\n        ]}\n      >\n        {t`Are you sure you want to delete:`}\n        <br />\n        <strong>{name}</strong>\n        {Object.values(deleteDetails).length > 0 && (\n          <WarningMessage\n            variant=\"warning\"\n            isInline\n            title={\n              <div>\n                <div aria-label={deleteMessage}>{deleteMessage}</div>\n                <br />\n                {Object.entries(deleteDetails).map(([key, value]) => (\n                  <div aria-label={`${key}: ${value}`} key={key}>\n                    <Label>{key}</Label> <Badge>{value}</Badge>\n                  </div>\n                ))}\n              </div>\n            }\n          />\n        )}\n      </AlertModal>\n    </>\n  );\n}\n\nDeleteButton.propTypes = {\n  ouiaId: PropTypes.string,\n};\n\nDeleteButton.defaultProps = {\n  ouiaId: null,\n};\n\nexport default DeleteButton;\n"]},"metadata":{},"sourceType":"module"}