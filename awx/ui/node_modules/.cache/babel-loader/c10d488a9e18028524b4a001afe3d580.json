{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect,useState}from'react';import styled from'styled-components';import{Card,PageSection,Tabs,Tab,TabTitleText}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{DashboardAPI}from'api';import ScreenHeader from'components/ScreenHeader';import JobList from'components/JobList';import ContentLoading from'components/ContentLoading';import TemplateList from'components/TemplateList';import Count from'./shared/Count';import DashboardGraph from'./DashboardGraph';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Counts=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: repeat(6, 1fr);\\n  grid-gap: var(--pf-global--spacer--lg);\\n\\n  @media (max-width: 900px) {\\n    grid-template-columns: repeat(3, 1fr);\\n    grid-auto-rows: 1fr;\\n  }\\n\"])));var MainPageSection=styled(PageSection)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding-top: 0;\\n  padding-bottom: 0;\\n\\n  & .spacer {\\n    margin-bottom: var(--pf-global--spacer--lg);\\n  }\\n\"])));function Dashboard(){var _countData$hosts,_countData$hosts2,_countData$inventorie,_countData$inventorie2,_countData$projects,_countData$projects2;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeTabId=_useState2[0],setActiveTabId=_useState2[1];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$DashboardAPI$r,dataFromCount;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return DashboardAPI.read();case 2:_yield$DashboardAPI$r=_context.sent;dataFromCount=_yield$DashboardAPI$r.data;return _context.abrupt(\"return\",dataFromCount);case 5:case\"end\":return _context.stop();}}},_callee);})),[]),{}),isLoading=_useRequest.isLoading,countData=_useRequest.result,fetchDashboardGraph=_useRequest.request;useEffect(function(){fetchDashboardGraph();},[fetchDashboardGraph]);if(isLoading){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentLoading,{})})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ScreenHeader,{streamType:\"all\",breadcrumbConfig:{'/home':/*i18n*/i18n._(\"Dashboard\")}}),/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Counts,{children:[/*#__PURE__*/_jsx(Count,{link:\"/hosts\",data:countData===null||countData===void 0?void 0:(_countData$hosts=countData.hosts)===null||_countData$hosts===void 0?void 0:_countData$hosts.total,label:/*i18n*/i18n._(\"Hosts\")}),/*#__PURE__*/_jsx(Count,{failed:true,link:\"/hosts?host.last_job_host_summary__failed=true\",data:countData===null||countData===void 0?void 0:(_countData$hosts2=countData.hosts)===null||_countData$hosts2===void 0?void 0:_countData$hosts2.failed,label:/*i18n*/i18n._(\"Failed hosts\")}),/*#__PURE__*/_jsx(Count,{link:\"/inventories\",data:countData===null||countData===void 0?void 0:(_countData$inventorie=countData.inventories)===null||_countData$inventorie===void 0?void 0:_countData$inventorie.total,label:/*i18n*/i18n._(\"Inventories\")}),/*#__PURE__*/_jsx(Count,{failed:true,link:\"/inventories?inventory.inventory_sources_with_failures__gt=0\",data:countData===null||countData===void 0?void 0:(_countData$inventorie2=countData.inventories)===null||_countData$inventorie2===void 0?void 0:_countData$inventorie2.inventory_failed,label:/*i18n*/i18n._(\"Inventory sync failures\")}),/*#__PURE__*/_jsx(Count,{link:\"/projects\",data:countData===null||countData===void 0?void 0:(_countData$projects=countData.projects)===null||_countData$projects===void 0?void 0:_countData$projects.total,label:/*i18n*/i18n._(\"Projects\")}),/*#__PURE__*/_jsx(Count,{failed:true,link:\"/projects?project.status__in=failed,canceled\",data:countData===null||countData===void 0?void 0:(_countData$projects2=countData.projects)===null||_countData$projects2===void 0?void 0:_countData$projects2.failed,label:/*i18n*/i18n._(\"Project sync failures\")})]})}),/*#__PURE__*/_jsx(MainPageSection,{children:/*#__PURE__*/_jsx(\"div\",{className:\"spacer\",children:/*#__PURE__*/_jsx(Card,{id:\"dashboard-main-container\",children:/*#__PURE__*/_jsxs(Tabs,{\"aria-label\":/*i18n*/i18n._(\"Tabs\"),activeKey:activeTabId,onSelect:function onSelect(key,eventKey){return setActiveTabId(eventKey);},ouiaId:\"dashboard-tabs\",children:[/*#__PURE__*/_jsx(Tab,{\"aria-label\":/*i18n*/i18n._(\"Job status graph tab\"),eventKey:0,title:/*#__PURE__*/_jsx(TabTitleText,{children:/*i18n*/i18n._(\"Job status\")}),ouiaId:\"job-status-graph-tab\",children:/*#__PURE__*/_jsx(DashboardGraph,{})}),/*#__PURE__*/_jsx(Tab,{\"aria-label\":/*i18n*/i18n._(\"Recent Jobs list tab\"),eventKey:1,title:/*#__PURE__*/_jsx(TabTitleText,{children:/*i18n*/i18n._(\"Recent Jobs\")}),ouiaId:\"recent-jobs-list-tab\",children:/*#__PURE__*/_jsx(\"div\",{children:activeTabId===1&&/*#__PURE__*/_jsx(JobList,{defaultParams:{page_size:5}})})}),/*#__PURE__*/_jsx(Tab,{\"aria-label\":/*i18n*/i18n._(\"Recent Templates list tab\"),eventKey:2,title:/*#__PURE__*/_jsx(TabTitleText,{children:/*i18n*/i18n._(\"Recent Templates\")}),ouiaId:\"recent-templates-list-tab\",children:/*#__PURE__*/_jsx(\"div\",{children:activeTabId===2&&/*#__PURE__*/_jsx(TemplateList,{defaultParams:{page_size:5}})})})]})})})})]});}export default Dashboard;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Dashboard/Dashboard.js"],"names":["React","useCallback","useEffect","useState","styled","Card","PageSection","Tabs","Tab","TabTitleText","useRequest","DashboardAPI","ScreenHeader","JobList","ContentLoading","TemplateList","Count","DashboardGraph","Counts","div","MainPageSection","Dashboard","activeTabId","setActiveTabId","read","dataFromCount","data","isLoading","countData","result","fetchDashboardGraph","request","hosts","total","failed","inventories","inventory_failed","projects","key","eventKey","page_size"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\nimport { t } from '@lingui/macro';\nimport {\n  Card,\n  PageSection,\n  Tabs,\n  Tab,\n  TabTitleText,\n} from '@patternfly/react-core';\n\nimport useRequest from 'hooks/useRequest';\nimport { DashboardAPI } from 'api';\nimport ScreenHeader from 'components/ScreenHeader';\nimport JobList from 'components/JobList';\nimport ContentLoading from 'components/ContentLoading';\nimport TemplateList from 'components/TemplateList';\nimport Count from './shared/Count';\nimport DashboardGraph from './DashboardGraph';\n\nconst Counts = styled.div`\n  display: grid;\n  grid-template-columns: repeat(6, 1fr);\n  grid-gap: var(--pf-global--spacer--lg);\n\n  @media (max-width: 900px) {\n    grid-template-columns: repeat(3, 1fr);\n    grid-auto-rows: 1fr;\n  }\n`;\n\nconst MainPageSection = styled(PageSection)`\n  padding-top: 0;\n  padding-bottom: 0;\n\n  & .spacer {\n    margin-bottom: var(--pf-global--spacer--lg);\n  }\n`;\n\nfunction Dashboard() {\n  const [activeTabId, setActiveTabId] = useState(0);\n\n  const {\n    isLoading,\n    result: countData,\n    request: fetchDashboardGraph,\n  } = useRequest(\n    useCallback(async () => {\n      const { data: dataFromCount } = await DashboardAPI.read();\n\n      return dataFromCount;\n    }, []),\n    {}\n  );\n\n  useEffect(() => {\n    fetchDashboardGraph();\n  }, [fetchDashboardGraph]);\n  if (isLoading) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentLoading />\n        </Card>\n      </PageSection>\n    );\n  }\n  return (\n    <>\n      <ScreenHeader\n        streamType=\"all\"\n        breadcrumbConfig={{ '/home': t`Dashboard` }}\n      />\n      <PageSection>\n        <Counts>\n          <Count\n            link=\"/hosts\"\n            data={countData?.hosts?.total}\n            label={t`Hosts`}\n          />\n          <Count\n            failed\n            link=\"/hosts?host.last_job_host_summary__failed=true\"\n            data={countData?.hosts?.failed}\n            label={t`Failed hosts`}\n          />\n          <Count\n            link=\"/inventories\"\n            data={countData?.inventories?.total}\n            label={t`Inventories`}\n          />\n          <Count\n            failed\n            link=\"/inventories?inventory.inventory_sources_with_failures__gt=0\"\n            data={countData?.inventories?.inventory_failed}\n            label={t`Inventory sync failures`}\n          />\n          <Count\n            link=\"/projects\"\n            data={countData?.projects?.total}\n            label={t`Projects`}\n          />\n          <Count\n            failed\n            link=\"/projects?project.status__in=failed,canceled\"\n            data={countData?.projects?.failed}\n            label={t`Project sync failures`}\n          />\n        </Counts>\n      </PageSection>\n      <MainPageSection>\n        <div className=\"spacer\">\n          <Card id=\"dashboard-main-container\">\n            <Tabs\n              aria-label={t`Tabs`}\n              activeKey={activeTabId}\n              onSelect={(key, eventKey) => setActiveTabId(eventKey)}\n              ouiaId=\"dashboard-tabs\"\n            >\n              <Tab\n                aria-label={t`Job status graph tab`}\n                eventKey={0}\n                title={<TabTitleText>{t`Job status`}</TabTitleText>}\n                ouiaId=\"job-status-graph-tab\"\n              >\n                <DashboardGraph />\n              </Tab>\n              <Tab\n                aria-label={t`Recent Jobs list tab`}\n                eventKey={1}\n                title={<TabTitleText>{t`Recent Jobs`}</TabTitleText>}\n                ouiaId=\"recent-jobs-list-tab\"\n              >\n                <div>\n                  {activeTabId === 1 && (\n                    <JobList defaultParams={{ page_size: 5 }} />\n                  )}\n                </div>\n              </Tab>\n              <Tab\n                aria-label={t`Recent Templates list tab`}\n                eventKey={2}\n                title={<TabTitleText>{t`Recent Templates`}</TabTitleText>}\n                ouiaId=\"recent-templates-list-tab\"\n              >\n                <div>\n                  {activeTabId === 2 && (\n                    <TemplateList defaultParams={{ page_size: 5 }} />\n                  )}\n                </div>\n              </Tab>\n            </Tabs>\n          </Card>\n        </div>\n      </MainPageSection>\n    </>\n  );\n}\n\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}