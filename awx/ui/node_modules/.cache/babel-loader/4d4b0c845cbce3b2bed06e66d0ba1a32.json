{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import*as d3 from'd3';import{jsx as _jsx}from\"react/jsx-runtime\";function LineChart(_ref){var _data$,_this=this;var data=_ref.data,helpText=_ref.helpText;var count=(_data$=data[0])===null||_data$===void 0?void 0:_data$.values.length;var draw=useCallback(function(){var margin=80;var getWidth=function getWidth(){var width;// This is in an a try/catch due to an error from jest.\n// Even though the d3.select returns a valid selector with\n// style function, it says it is null in the test\ntry{width=parseInt(d3.select(\"#chart\").style('width'),10)-margin||700;}catch(error){width=700;}return width;};var width=getWidth();var height=500;var duration=250;var circleRadius=6;var circleRadiusHover=8;/* Scale */var smallestY;var largestY;data.map(function(line){return line.values.forEach(function(value){if(smallestY===undefined){smallestY=value.y;}if(value.y<smallestY){smallestY=value.y;}if(largestY===undefined){largestY=smallestY+10;}if(value.y>largestY){largestY=value.y;}});});var xScale=d3.scaleLinear().domain(d3.max(data[0].values,function(d){return d.x;})>49?d3.extent(data[0].values,function(d){return d.x;}):[0,50]).range([0,width-margin]);var yScale=d3.scaleLinear().domain([smallestY,largestY]).range([height-margin,0]);var color=d3.scaleOrdinal(d3.schemeCategory10);/* Add SVG */d3.selectAll(\"#chart > *\").remove();var renderTooltip=function renderTooltip(d){d3.selectAll(\".tooltip > *\").remove();d3.select('#chart').append('span').attr('class','tooltip').attr('stroke','black').attr('fill','white').style('padding-left','50px');var tooltip={};data.map(function(datum){datum.values.forEach(function(value){if(d.x===value.x){tooltip[datum.name]=value.y;}});return tooltip;});Object.entries(tooltip).forEach(function(_ref2,i){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],value=_ref3[1];d3.select('.tooltip').append('span').attr('class','tooltip-text-wrapper').append('text').attr('class','tooltip-text').style('color',color(i)).style('padding-right','20px').text(\"\".concat(key,\": \").concat(value));});};var removeTooltip=function removeTooltip(){d3.select('.tooltip').style('cursor','none').selectAll(\".tooltip > *\").remove();};// Add legend\nd3.selectAll(\".legend > *\").remove();var legendContainer=d3.select('#chart').append('div').style('display','flex').attr('class','legend').attr('height','400px').attr('width','500px').style('padding-left','50px');legendContainer.append('text').attr('class','legend-title').attr('x','100').attr('y','50').text(/*i18n*/i18n._(\"Legend\"));legendContainer.data(data,function(d,i){if(d!==null&&d!==void 0&&d.name){var legendItemContainer=legendContainer.append('div').style('display','flex').attr('id','legend-item-container').style('padding-left','20px');legendItemContainer.append('div').style('background-color',color(i)).style('height','8px').style('width','8px').style('border-radius','50%').style('padding','5px').style('margin-top','6px');legendItemContainer.append('text').style('padding-left','20px').text(d.name);}});// Add help text to top of chart\nd3.select('#chart').append('div').attr('class','help-text').style('padding-left','50px').style('padding-top','20px').text(helpText);var svg=d3.select('#chart').append('svg').attr('width',\"\".concat(width+margin,\"px\")).attr('height',\"\".concat(height+margin,\"px\")).append('g').attr('transform',\"translate(\".concat(margin,\", \").concat(margin,\")\"));/* Add line into SVG */var line=d3.line().curve(d3.curveMonotoneX).x(function(d){return xScale(d.x);}).y(function(d){return yScale(d.y);});var lines=svg.append('g');lines.selectAll('.line-group').data(data).enter().append('g').attr('class','line-group').append('path').attr('class','line').style('fill','none').attr('d',function(d){return line(d.values);}).style('stroke',function(d,i){return color(i);}).style('stroke-width','3px');/* Add circles in the line */lines.selectAll('circle-group').data(data).enter().append('g').style('fill',function(d,i){return color(i);}).selectAll('circle').data(function(d){return d.values;}).enter().append('g').attr('class','circle').on('mouseover',function(d,i){if(data.length){renderTooltip(d,i);}}).on('mouseout',function(){removeTooltip();}).append('circle').attr('cx',function(d){return xScale(d.x);}).attr('cy',function(d){return yScale(d.y);}).attr('r',circleRadius).on('mouseover',function(){d3.select(_this).transition().duration(duration).attr('r',circleRadiusHover);}).on('mouseout',function(){d3.select(_this).transition().duration(duration).attr('r',circleRadius);});/* Add Axis into SVG */var xAxis=d3.axisBottom(xScale).ticks(data[0].values.length>5?data[0].values.length:5);var yAxis=d3.axisLeft(yScale).ticks(5);svg.append('g').attr('class','x axis').attr('transform',\"translate(0, \".concat(height-margin,\")\")).call(xAxis);svg.append('g').attr('class','y axis').call(yAxis);},[data,helpText]);useEffect(function(){draw();},[count,draw]);useEffect(function(){function handleResize(){draw();}window.addEventListener('resize',handleResize);handleResize();return function(){return window.removeEventListener('resize',handleResize);};},[draw]);return/*#__PURE__*/_jsx(\"div\",{id:\"chart\"});}export default LineChart;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Metrics/LineChart.js"],"names":["React","useEffect","useCallback","d3","LineChart","data","helpText","count","values","length","draw","margin","getWidth","width","parseInt","select","style","error","height","duration","circleRadius","circleRadiusHover","smallestY","largestY","map","line","forEach","value","undefined","y","xScale","scaleLinear","domain","max","d","x","extent","range","yScale","color","scaleOrdinal","schemeCategory10","selectAll","remove","renderTooltip","append","attr","tooltip","datum","name","Object","entries","i","key","text","removeTooltip","legendContainer","legendItemContainer","svg","curve","curveMonotoneX","lines","enter","on","transition","xAxis","axisBottom","ticks","yAxis","axisLeft","call","handleResize","window","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { t } from '@lingui/macro';\nimport * as d3 from 'd3';\n\nfunction LineChart({ data, helpText }) {\n  const count = data[0]?.values.length;\n  const draw = useCallback(() => {\n    const margin = 80;\n    const getWidth = () => {\n      let width;\n      // This is in an a try/catch due to an error from jest.\n      // Even though the d3.select returns a valid selector with\n      // style function, it says it is null in the test\n      try {\n        width =\n          parseInt(d3.select(`#chart`).style('width'), 10) - margin || 700;\n      } catch (error) {\n        width = 700;\n      }\n\n      return width;\n    };\n    const width = getWidth();\n    const height = 500;\n    const duration = 250;\n    const circleRadius = 6;\n    const circleRadiusHover = 8;\n\n    /* Scale */\n    let smallestY;\n    let largestY;\n    data.map((line) =>\n      line.values.forEach((value) => {\n        if (smallestY === undefined) {\n          smallestY = value.y;\n        }\n        if (value.y < smallestY) {\n          smallestY = value.y;\n        }\n        if (largestY === undefined) {\n          largestY = smallestY + 10;\n        }\n        if (value.y > largestY) {\n          largestY = value.y;\n        }\n      })\n    );\n\n    const xScale = d3\n      .scaleLinear()\n      .domain(\n        d3.max(data[0].values, (d) => d.x) > 49\n          ? d3.extent(data[0].values, (d) => d.x)\n          : [0, 50]\n      )\n      .range([0, width - margin]);\n\n    const yScale = d3\n      .scaleLinear()\n      .domain([smallestY, largestY])\n      .range([height - margin, 0]);\n\n    const color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    /* Add SVG */\n    d3.selectAll(`#chart > *`).remove();\n\n    const renderTooltip = (d) => {\n      d3.selectAll(`.tooltip > *`).remove();\n\n      d3.select('#chart')\n        .append('span')\n        .attr('class', 'tooltip')\n        .attr('stroke', 'black')\n        .attr('fill', 'white')\n        .style('padding-left', '50px');\n      const tooltip = {};\n      data.map((datum) => {\n        datum.values.forEach((value) => {\n          if (d.x === value.x) {\n            tooltip[datum.name] = value.y;\n          }\n        });\n        return tooltip;\n      });\n      Object.entries(tooltip).forEach(([key, value], i) => {\n        d3.select('.tooltip')\n          .append('span')\n          .attr('class', 'tooltip-text-wrapper')\n          .append('text')\n          .attr('class', 'tooltip-text')\n          .style('color', color(i))\n          .style('padding-right', '20px')\n          .text(`${key}: ${value}`);\n      });\n    };\n    const removeTooltip = () => {\n      d3.select('.tooltip')\n        .style('cursor', 'none')\n        .selectAll(`.tooltip > *`)\n        .remove();\n    };\n\n    // Add legend\n    d3.selectAll(`.legend > *`).remove();\n    const legendContainer = d3\n      .select('#chart')\n      .append('div')\n      .style('display', 'flex')\n      .attr('class', 'legend')\n      .attr('height', '400px')\n      .attr('width', '500px')\n      .style('padding-left', '50px');\n\n    legendContainer\n      .append('text')\n      .attr('class', 'legend-title')\n      .attr('x', '100')\n      .attr('y', '50')\n      .text(t`Legend`);\n\n    legendContainer.data(data, (d, i) => {\n      if (d?.name) {\n        const legendItemContainer = legendContainer\n          .append('div')\n          .style('display', 'flex')\n          .attr('id', 'legend-item-container')\n          .style('padding-left', '20px');\n\n        legendItemContainer\n          .append('div')\n          .style('background-color', color(i))\n          .style('height', '8px')\n          .style('width', '8px')\n          .style('border-radius', '50%')\n          .style('padding', '5px')\n          .style('margin-top', '6px');\n\n        legendItemContainer\n          .append('text')\n          .style('padding-left', '20px')\n          .text(d.name);\n      }\n    });\n\n    // Add help text to top of chart\n\n    d3.select('#chart')\n      .append('div')\n      .attr('class', 'help-text')\n      .style('padding-left', '50px')\n      .style('padding-top', '20px')\n      .text(helpText);\n\n    const svg = d3\n      .select('#chart')\n      .append('svg')\n      .attr('width', `${width + margin}px`)\n      .attr('height', `${height + margin}px`)\n      .append('g')\n      .attr('transform', `translate(${margin}, ${margin})`);\n\n    /* Add line into SVG */\n    const line = d3\n      .line()\n      .curve(d3.curveMonotoneX)\n      .x((d) => xScale(d.x))\n      .y((d) => yScale(d.y));\n\n    const lines = svg.append('g');\n\n    lines\n      .selectAll('.line-group')\n      .data(data)\n      .enter()\n      .append('g')\n      .attr('class', 'line-group')\n      .append('path')\n      .attr('class', 'line')\n      .style('fill', 'none')\n      .attr('d', (d) => line(d.values))\n      .style('stroke', (d, i) => color(i))\n      .style('stroke-width', '3px');\n\n    /* Add circles in the line */\n    lines\n      .selectAll('circle-group')\n      .data(data)\n      .enter()\n      .append('g')\n      .style('fill', (d, i) => color(i))\n      .selectAll('circle')\n      .data((d) => d.values)\n      .enter()\n      .append('g')\n      .attr('class', 'circle')\n      .on('mouseover', (d, i) => {\n        if (data.length) {\n          renderTooltip(d, i);\n        }\n      })\n      .on('mouseout', () => {\n        removeTooltip();\n      })\n      .append('circle')\n      .attr('cx', (d) => xScale(d.x))\n      .attr('cy', (d) => yScale(d.y))\n      .attr('r', circleRadius)\n      .on('mouseover', () => {\n        d3.select(this)\n          .transition()\n          .duration(duration)\n          .attr('r', circleRadiusHover);\n      })\n      .on('mouseout', () => {\n        d3.select(this).transition().duration(duration).attr('r', circleRadius);\n      });\n\n    /* Add Axis into SVG */\n    const xAxis = d3\n      .axisBottom(xScale)\n      .ticks(data[0].values.length > 5 ? data[0].values.length : 5);\n    const yAxis = d3.axisLeft(yScale).ticks(5);\n\n    svg\n      .append('g')\n      .attr('class', 'x axis')\n      .attr('transform', `translate(0, ${height - margin})`)\n      .call(xAxis);\n\n    svg.append('g').attr('class', 'y axis').call(yAxis);\n  }, [data, helpText]);\n\n  useEffect(() => {\n    draw();\n  }, [count, draw]);\n\n  useEffect(() => {\n    function handleResize() {\n      draw();\n    }\n\n    window.addEventListener('resize', handleResize);\n\n    handleResize();\n\n    return () => window.removeEventListener('resize', handleResize);\n  }, [draw]);\n\n  return <div id=\"chart\" />;\n}\n\nexport default LineChart;\n"]},"metadata":{},"sourceType":"module"}