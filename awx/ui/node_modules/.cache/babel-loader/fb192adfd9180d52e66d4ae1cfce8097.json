{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{useHistory,useParams}from'react-router-dom';import AlertModal from'components/AlertModal';import{CardBody,CardActionsRow}from'components/Card';import DeleteButton from'components/DeleteButton';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import ErrorDetail from'components/ErrorDetail';import{TokensAPI}from'api';import{formatDateString}from'util/dates';import useRequest,{useDismissableError}from'hooks/useRequest';import{toTitleCase}from'util/strings';import helptext from'../shared/User.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UserTokenDetail(_ref){var _summary_fields$appli,_summary_fields$appli2;var token=_ref.token;var scope=token.scope,description=token.description,created=token.created,modified=token.modified,expires=token.expires,summary_fields=token.summary_fields;var history=useHistory();var _useParams=useParams(),id=_useParams.id,tokenId=_useParams.tokenId;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return TokensAPI.destroy(tokenId);case 2:history.push(\"/users/\".concat(id,\"/tokens\"));case 3:case\"end\":return _context.stop();}}},_callee);})),[tokenId,id,history])),deleteToken=_useRequest.request,isLoading=_useRequest.isLoading,deleteError=_useRequest.error;var _useDismissableError=useDismissableError(deleteError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Application\"),value:summary_fields===null||summary_fields===void 0?void 0:(_summary_fields$appli=summary_fields.application)===null||_summary_fields$appli===void 0?void 0:_summary_fields$appli.name,dataCy:\"application-token-detail-name\",helpText:helptext.application}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description,dataCy:\"application-token-detail-description\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Scope\"),value:toTitleCase(scope),dataCy:\"application-token-detail-scope\",helpText:helptext.scope}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Expires\"),value:formatDateString(expires),dataCy:\"application-token-detail-expires\"}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Created\"),date:created,user:summary_fields.user}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Last Modified\"),date:modified,user:summary_fields.user})]}),/*#__PURE__*/_jsx(CardActionsRow,{children:/*#__PURE__*/_jsx(DeleteButton,{name:(summary_fields===null||summary_fields===void 0?void 0:(_summary_fields$appli2=summary_fields.application)===null||_summary_fields$appli2===void 0?void 0:_summary_fields$appli2.name)||/*i18n*/i18n._(\"Personal Access Token\"),modalTitle:/*i18n*/i18n._(\"Delete User Token\"),onConfirm:deleteToken,isDisabled:isLoading,children:/*i18n*/i18n._(\"Delete\")})}),error&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to user token.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:error})]})]});}export default UserTokenDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/User/UserTokenDetail/UserTokenDetail.js"],"names":["React","useCallback","useHistory","useParams","AlertModal","CardBody","CardActionsRow","DeleteButton","DetailList","Detail","UserDateDetail","ErrorDetail","TokensAPI","formatDateString","useRequest","useDismissableError","toTitleCase","helptext","UserTokenDetail","token","scope","description","created","modified","expires","summary_fields","history","id","tokenId","destroy","push","deleteToken","request","isLoading","deleteError","error","dismissError","application","name","user"],"mappings":"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","sourcesContent":["import React, { useCallback } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\n\nimport AlertModal from 'components/AlertModal';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport DeleteButton from 'components/DeleteButton';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { TokensAPI } from 'api';\nimport { formatDateString } from 'util/dates';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport { toTitleCase } from 'util/strings';\nimport helptext from '../shared/User.helptext';\n\nfunction UserTokenDetail({ token }) {\n  const { scope, description, created, modified, expires, summary_fields } =\n    token;\n  const history = useHistory();\n  const { id, tokenId } = useParams();\n  const {\n    request: deleteToken,\n    isLoading,\n    error: deleteError,\n  } = useRequest(\n    useCallback(async () => {\n      await TokensAPI.destroy(tokenId);\n      history.push(`/users/${id}/tokens`);\n    }, [tokenId, id, history])\n  );\n  const { error, dismissError } = useDismissableError(deleteError);\n\n  return (\n    <CardBody>\n      <DetailList>\n        <Detail\n          label={t`Application`}\n          value={summary_fields?.application?.name}\n          dataCy=\"application-token-detail-name\"\n          helpText={helptext.application}\n        />\n        <Detail\n          label={t`Description`}\n          value={description}\n          dataCy=\"application-token-detail-description\"\n        />\n        <Detail\n          label={t`Scope`}\n          value={toTitleCase(scope)}\n          dataCy=\"application-token-detail-scope\"\n          helpText={helptext.scope}\n        />\n        <Detail\n          label={t`Expires`}\n          value={formatDateString(expires)}\n          dataCy=\"application-token-detail-expires\"\n        />\n        <UserDateDetail\n          label={t`Created`}\n          date={created}\n          user={summary_fields.user}\n        />\n        <UserDateDetail\n          label={t`Last Modified`}\n          date={modified}\n          user={summary_fields.user}\n        />\n      </DetailList>\n      <CardActionsRow>\n        <DeleteButton\n          name={summary_fields?.application?.name || t`Personal Access Token`}\n          modalTitle={t`Delete User Token`}\n          onConfirm={deleteToken}\n          isDisabled={isLoading}\n        >\n          {t`Delete`}\n        </DeleteButton>\n      </CardActionsRow>\n      {error && (\n        <AlertModal\n          isOpen={error}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissError}\n        >\n          {t`Failed to user token.`}\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nexport default UserTokenDetail;\n"]},"metadata":{},"sourceType":"module"}