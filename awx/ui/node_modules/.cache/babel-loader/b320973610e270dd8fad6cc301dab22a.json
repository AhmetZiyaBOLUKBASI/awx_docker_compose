{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useContext,useRef,useState}from'react';import styled from'styled-components';import{InfoIcon,LinkIcon,PencilAltIcon,PlusIcon,TrashAltIcon}from'@patternfly/react-icons';import{WorkflowDispatchContext,WorkflowStateContext}from'contexts/Workflow';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{WorkflowJobTemplateNodesAPI}from'api';import{constants as wfConstants}from'components/Workflow/WorkflowUtils';import{stringIsUUID}from'util/strings';import{WorkflowActionTooltip,WorkflowActionTooltipItem,WorkflowNodeTypeLetter}from'components/Workflow';import getNodeType from'./shared/WorkflowJobTemplateVisualizerUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NodeG=styled.g(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  pointer-events: \",\";\\n  cursor: \",\";\\n\"])),function(props){return props.noPointerEvents?'none':'initial';},function(props){return props.job?'pointer':'default';});var NodeContents=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  font-size: 13px;\\n  padding: 0px 10px;\\n  background-color: \",\";\\n  height: 100%;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\"])),function(props){return props.isInvalidLinkTarget?'#D7D7D7':'#FFFFFF';});var NodeResourceName=styled.p(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  overflow: hidden;\\n  text-align: center;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n\"])));var ConvergenceLabel=styled.p(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-size: 12px;\\n  color: #ffffff;\\n\"])));NodeResourceName.displayName='NodeResourceName';function VisualizerNode(_ref){var _node$originalNodeObj6,_node$originalNodeObj11;var node=_ref.node,onMouseOver=_ref.onMouseOver,readOnly=_ref.readOnly,updateHelpText=_ref.updateHelpText,updateNodeHelp=_ref.updateNodeHelp;var ref=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),hovering=_useState2[0],setHovering=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),credentialsError=_useState4[0],setCredentialsError=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),detailError=_useState6[0],setDetailError=_useState6[1];var dispatch=useContext(WorkflowDispatchContext);var _useContext=useContext(WorkflowStateContext),addingLink=_useContext.addingLink,addLinkSourceNode=_useContext.addLinkSourceNode,nodePositions=_useContext.nodePositions,nodes=_useContext.nodes;var isAddLinkSourceNode=addLinkSourceNode&&addLinkSourceNode.id===node.id;var handleCredentialsErrorClose=function handleCredentialsErrorClose(){return setCredentialsError(null);};var handleDetailErrorClose=function handleDetailErrorClose(){return setDetailError(null);};var updateNode=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _node$originalNodeObj,_node$originalNodeObj2,_node$originalNodeObj3,_node$originalNodeObj4,_node$originalNodeObj5;var updatedNodes,updatedNode,_getNodeType,_getNodeType2,nodeAPI,_yield$nodeAPI$readDe,fullUnifiedJobTemplate,_yield$WorkflowJobTem,results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:updatedNodes=_toConsumableArray(nodes);updatedNode=updatedNodes.find(function(n){return n.id===node.id;});if(!(!node.fullUnifiedJobTemplate&&node!==null&&node!==void 0&&(_node$originalNodeObj=node.originalNodeObject)!==null&&_node$originalNodeObj!==void 0&&(_node$originalNodeObj2=_node$originalNodeObj.summary_fields)!==null&&_node$originalNodeObj2!==void 0&&_node$originalNodeObj2.unified_job_template)){_context.next=16;break;}_getNodeType=getNodeType(node.originalNodeObject.summary_fields.unified_job_template),_getNodeType2=_slicedToArray(_getNodeType,2),nodeAPI=_getNodeType2[1];_context.prev=4;_context.next=7;return nodeAPI.readDetail(node.originalNodeObject.unified_job_template);case 7:_yield$nodeAPI$readDe=_context.sent;fullUnifiedJobTemplate=_yield$nodeAPI$readDe.data;updatedNode.fullUnifiedJobTemplate=fullUnifiedJobTemplate;_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](4);setDetailError(_context.t0);return _context.abrupt(\"return\",null);case 16:if(!((node===null||node===void 0?void 0:(_node$originalNodeObj3=node.originalNodeObject)===null||_node$originalNodeObj3===void 0?void 0:(_node$originalNodeObj4=_node$originalNodeObj3.summary_fields)===null||_node$originalNodeObj4===void 0?void 0:(_node$originalNodeObj5=_node$originalNodeObj4.unified_job_template)===null||_node$originalNodeObj5===void 0?void 0:_node$originalNodeObj5.unified_job_type)==='job'&&!(node!==null&&node!==void 0&&node.originalNodeCredentials))){_context.next=29;break;}_context.prev=17;_context.next=20;return WorkflowJobTemplateNodesAPI.readCredentials(node.originalNodeObject.id);case 20:_yield$WorkflowJobTem=_context.sent;results=_yield$WorkflowJobTem.data.results;updatedNode.originalNodeCredentials=results;_context.next=29;break;case 25:_context.prev=25;_context.t1=_context[\"catch\"](17);setCredentialsError(_context.t1);return _context.abrupt(\"return\",null);case 29:dispatch({type:'SET_NODES',value:updatedNodes});return _context.abrupt(\"return\",updatedNode);case 31:case\"end\":return _context.stop();}}},_callee,null,[[4,12],[17,25]]);}));return function updateNode(){return _ref2.apply(this,arguments);};}();var handleEditClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var nodeToEdit;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:updateHelpText(null);setHovering(false);_context2.next=4;return updateNode();case 4:nodeToEdit=_context2.sent;if(nodeToEdit){dispatch({type:'SET_NODE_TO_EDIT',value:nodeToEdit});}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleEditClick(){return _ref3.apply(this,arguments);};}();var handleViewClick=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var nodeToView;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:updateHelpText(null);setHovering(false);_context3.next=4;return updateNode();case 4:nodeToView=_context3.sent;if(nodeToView){dispatch({type:'SET_NODE_TO_VIEW',value:nodeToView});}case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function handleViewClick(){return _ref4.apply(this,arguments);};}();var handleNodeMouseEnter=function handleNodeMouseEnter(){ref.current.parentNode.appendChild(ref.current);setHovering(true);if(addingLink){updateHelpText(node.isInvalidLinkTarget?/*i18n*/i18n._(\"Invalid link target. Unable to link to children or ancestor nodes. Graph cycles are not supported.\"):/*i18n*/i18n._(\"Click to create a new link to this node.\"));onMouseOver(node);}};var handleNodeMouseLeave=function handleNodeMouseLeave(){setHovering(false);if(addingLink){updateHelpText(null);}};var handleNodeClick=function handleNodeClick(){if(addingLink&&!node.isInvalidLinkTarget&&!isAddLinkSourceNode){dispatch({type:'SET_ADD_LINK_TARGET_NODE',value:node});}};var nodeName;if(node!==null&&node!==void 0&&node.identifier&&node.identifier!==''){nodeName=node.identifier;}else if((node===null||node===void 0?void 0:node.identifier)!==''&&node!==null&&node!==void 0&&(_node$originalNodeObj6=node.originalNodeObject)!==null&&_node$originalNodeObj6!==void 0&&_node$originalNodeObj6.identifier&&!stringIsUUID(node.originalNodeObject.identifier)){var _node$originalNodeObj7;nodeName=node===null||node===void 0?void 0:(_node$originalNodeObj7=node.originalNodeObject)===null||_node$originalNodeObj7===void 0?void 0:_node$originalNodeObj7.identifier;}else{var _node$fullUnifiedJobT,_node$originalNodeObj8,_node$originalNodeObj9,_node$originalNodeObj10;nodeName=(node===null||node===void 0?void 0:(_node$fullUnifiedJobT=node.fullUnifiedJobTemplate)===null||_node$fullUnifiedJobT===void 0?void 0:_node$fullUnifiedJobT.name)||(node===null||node===void 0?void 0:(_node$originalNodeObj8=node.originalNodeObject)===null||_node$originalNodeObj8===void 0?void 0:(_node$originalNodeObj9=_node$originalNodeObj8.summary_fields)===null||_node$originalNodeObj9===void 0?void 0:(_node$originalNodeObj10=_node$originalNodeObj9.unified_job_template)===null||_node$originalNodeObj10===void 0?void 0:_node$originalNodeObj10.name)||/*i18n*/i18n._(\"DELETED\");}var viewDetailsAction=/*#__PURE__*/_jsx(WorkflowActionTooltipItem,{id:\"node-details\",onClick:handleViewClick,onMouseEnter:function onMouseEnter(){return updateHelpText(/*i18n*/i18n._(\"View node details\"));},onMouseLeave:function onMouseLeave(){return updateHelpText(null);},children:/*#__PURE__*/_jsx(InfoIcon,{})},\"details\");var tooltipActions=readOnly?[viewDetailsAction]:[/*#__PURE__*/_jsx(WorkflowActionTooltipItem,{id:\"node-add\",onClick:function onClick(){updateHelpText(null);setHovering(false);dispatch({type:'START_ADD_NODE',sourceNodeId:node.id});},onMouseEnter:function onMouseEnter(){return updateHelpText(/*i18n*/i18n._(\"Add a new node\"));},onMouseLeave:function onMouseLeave(){return updateHelpText(null);},children:/*#__PURE__*/_jsx(PlusIcon,{})},\"add\"),viewDetailsAction,/*#__PURE__*/_jsx(WorkflowActionTooltipItem,{id:\"node-edit\",onClick:handleEditClick,onMouseEnter:function onMouseEnter(){return updateHelpText(/*i18n*/i18n._(\"Edit this node\"));},onMouseLeave:function onMouseLeave(){return updateHelpText(null);},children:/*#__PURE__*/_jsx(PencilAltIcon,{})},\"edit\"),/*#__PURE__*/_jsx(WorkflowActionTooltipItem,{id:\"node-link\",onClick:function onClick(){updateHelpText(null);setHovering(false);dispatch({type:'SELECT_SOURCE_FOR_LINKING',node:node});},onMouseEnter:function onMouseEnter(){return updateHelpText(/*i18n*/i18n._(\"Link to an available node\"));},onMouseLeave:function onMouseLeave(){return updateHelpText(null);},children:/*#__PURE__*/_jsx(LinkIcon,{})},\"link\"),/*#__PURE__*/_jsx(WorkflowActionTooltipItem,{id:\"node-delete\",onClick:function onClick(){updateHelpText(null);setHovering(false);dispatch({type:'SET_NODE_TO_DELETE',value:node});},onMouseEnter:function onMouseEnter(){return updateHelpText(/*i18n*/i18n._(\"Delete this node\"));},onMouseLeave:function onMouseLeave(){return updateHelpText(null);},children:/*#__PURE__*/_jsx(TrashAltIcon,{})},\"delete\")];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(NodeG,{id:\"node-\".concat(node.id),job:node.job,noPointerEvents:isAddLinkSourceNode,onMouseEnter:handleNodeMouseEnter,onMouseLeave:handleNodeMouseLeave,ref:ref,transform:\"translate(\".concat(nodePositions[node.id].x,\",\").concat(nodePositions[node.id].y-nodePositions[1].y,\")\"),children:[(Object.prototype.hasOwnProperty.call(node,'all_parents_must_converge')?node.all_parents_must_converge:node===null||node===void 0?void 0:(_node$originalNodeObj11=node.originalNodeObject)===null||_node$originalNodeObj11===void 0?void 0:_node$originalNodeObj11.all_parents_must_converge)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"rect\",{fill:hovering&&addingLink&&!node.isInvalidLinkTarget?'#007ABC':'#93969A',height:wfConstants.nodeH/4,rx:2,ry:2,x:wfConstants.nodeW/2-wfConstants.nodeW/10,y:-wfConstants.nodeH/4+2,stroke:hovering&&addingLink&&!node.isInvalidLinkTarget?'#007ABC':'#93969A',strokeWidth:\"2px\",width:wfConstants.nodeW/5}),/*#__PURE__*/_jsx(\"foreignObject\",{height:wfConstants.nodeH/4,width:wfConstants.nodeW/5,x:wfConstants.nodeW/2-wfConstants.nodeW/10+7,y:-wfConstants.nodeH/4-1,children:/*#__PURE__*/_jsx(ConvergenceLabel,{\"data-cy\":\"convergence-label\",children:/*i18n*/i18n._(\"ALL\")})})]}),/*#__PURE__*/_jsx(\"rect\",{fill:\"#FFFFFF\",height:wfConstants.nodeH,rx:\"2\",ry:\"2\",stroke:hovering&&addingLink&&!node.isInvalidLinkTarget?'#007ABC':'#93969A',strokeWidth:\"2px\",width:wfConstants.nodeW}),/*#__PURE__*/_jsx(\"foreignObject\",_objectSpread(_objectSpread({height:\"58\"},!addingLink&&{onMouseEnter:function onMouseEnter(){return updateNodeHelp(node);},onMouseLeave:function onMouseLeave(){return updateNodeHelp(null);}}),{},{onClick:function onClick(){return handleNodeClick();},width:\"178\",x:\"1\",y:\"1\",children:/*#__PURE__*/_jsx(NodeContents,{isInvalidLinkTarget:node.isInvalidLinkTarget,children:/*#__PURE__*/_jsx(NodeResourceName,{id:\"node-\".concat(node.id,\"-name\"),children:nodeName})})})),/*#__PURE__*/_jsx(WorkflowNodeTypeLetter,{node:node}),hovering&&!addingLink&&/*#__PURE__*/_jsx(WorkflowActionTooltip,{pointX:wfConstants.nodeW,pointY:wfConstants.nodeH/2,actions:tooltipActions})]}),detailError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:detailError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:handleDetailErrorClose,children:[/*i18n*/i18n._(\"Failed to retrieve full node resource object.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:detailError})]}),credentialsError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:credentialsError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:handleCredentialsErrorClose,children:[/*i18n*/i18n._(\"Failed to retrieve node credentials.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:credentialsError})]})]});}VisualizerNode.defaultProps={onMouseOver:function onMouseOver(){}};export default VisualizerNode;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Template/WorkflowJobTemplateVisualizer/VisualizerNode.js"],"names":["React","useContext","useRef","useState","styled","InfoIcon","LinkIcon","PencilAltIcon","PlusIcon","TrashAltIcon","WorkflowDispatchContext","WorkflowStateContext","AlertModal","ErrorDetail","WorkflowJobTemplateNodesAPI","constants","wfConstants","stringIsUUID","WorkflowActionTooltip","WorkflowActionTooltipItem","WorkflowNodeTypeLetter","getNodeType","NodeG","g","props","noPointerEvents","job","NodeContents","div","isInvalidLinkTarget","NodeResourceName","p","ConvergenceLabel","displayName","VisualizerNode","node","onMouseOver","readOnly","updateHelpText","updateNodeHelp","ref","hovering","setHovering","credentialsError","setCredentialsError","detailError","setDetailError","dispatch","addingLink","addLinkSourceNode","nodePositions","nodes","isAddLinkSourceNode","id","handleCredentialsErrorClose","handleDetailErrorClose","updateNode","updatedNodes","updatedNode","find","n","fullUnifiedJobTemplate","originalNodeObject","summary_fields","unified_job_template","nodeAPI","readDetail","data","unified_job_type","originalNodeCredentials","readCredentials","results","type","value","handleEditClick","nodeToEdit","handleViewClick","nodeToView","handleNodeMouseEnter","current","parentNode","appendChild","handleNodeMouseLeave","handleNodeClick","nodeName","identifier","name","viewDetailsAction","tooltipActions","sourceNodeId","x","y","Object","prototype","hasOwnProperty","call","all_parents_must_converge","nodeH","nodeW","onMouseEnter","onMouseLeave","defaultProps"],"mappings":"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","sourcesContent":["import React, { useContext, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport { t } from '@lingui/macro';\nimport { bool, func, shape } from 'prop-types';\nimport {\n  InfoIcon,\n  LinkIcon,\n  PencilAltIcon,\n  PlusIcon,\n  TrashAltIcon,\n} from '@patternfly/react-icons';\nimport {\n  WorkflowDispatchContext,\n  WorkflowStateContext,\n} from 'contexts/Workflow';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { WorkflowJobTemplateNodesAPI } from 'api';\nimport { constants as wfConstants } from 'components/Workflow/WorkflowUtils';\nimport { stringIsUUID } from 'util/strings';\nimport {\n  WorkflowActionTooltip,\n  WorkflowActionTooltipItem,\n  WorkflowNodeTypeLetter,\n} from 'components/Workflow';\nimport getNodeType from './shared/WorkflowJobTemplateVisualizerUtils';\n\nconst NodeG = styled.g`\n  pointer-events: ${(props) => (props.noPointerEvents ? 'none' : 'initial')};\n  cursor: ${(props) => (props.job ? 'pointer' : 'default')};\n`;\n\nconst NodeContents = styled.div`\n  font-size: 13px;\n  padding: 0px 10px;\n  background-color: ${(props) =>\n    props.isInvalidLinkTarget ? '#D7D7D7' : '#FFFFFF'};\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst NodeResourceName = styled.p`\n  overflow: hidden;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\n\nconst ConvergenceLabel = styled.p`\n  font-size: 12px;\n  color: #ffffff;\n`;\n\nNodeResourceName.displayName = 'NodeResourceName';\n\nfunction VisualizerNode({\n  node,\n  onMouseOver,\n  readOnly,\n  updateHelpText,\n  updateNodeHelp,\n}) {\n  const ref = useRef(null);\n  const [hovering, setHovering] = useState(false);\n  const [credentialsError, setCredentialsError] = useState(null);\n  const [detailError, setDetailError] = useState(null);\n  const dispatch = useContext(WorkflowDispatchContext);\n  const { addingLink, addLinkSourceNode, nodePositions, nodes } =\n    useContext(WorkflowStateContext);\n  const isAddLinkSourceNode =\n    addLinkSourceNode && addLinkSourceNode.id === node.id;\n\n  const handleCredentialsErrorClose = () => setCredentialsError(null);\n  const handleDetailErrorClose = () => setDetailError(null);\n\n  const updateNode = async () => {\n    const updatedNodes = [...nodes];\n    const updatedNode = updatedNodes.find((n) => n.id === node.id);\n    if (\n      !node.fullUnifiedJobTemplate &&\n      node?.originalNodeObject?.summary_fields?.unified_job_template\n    ) {\n      const [, nodeAPI] = getNodeType(\n        node.originalNodeObject.summary_fields.unified_job_template\n      );\n      try {\n        const { data: fullUnifiedJobTemplate } = await nodeAPI.readDetail(\n          node.originalNodeObject.unified_job_template\n        );\n        updatedNode.fullUnifiedJobTemplate = fullUnifiedJobTemplate;\n      } catch (err) {\n        setDetailError(err);\n        return null;\n      }\n    }\n\n    if (\n      node?.originalNodeObject?.summary_fields?.unified_job_template\n        ?.unified_job_type === 'job' &&\n      !node?.originalNodeCredentials\n    ) {\n      try {\n        const {\n          data: { results },\n        } = await WorkflowJobTemplateNodesAPI.readCredentials(\n          node.originalNodeObject.id\n        );\n        updatedNode.originalNodeCredentials = results;\n      } catch (err) {\n        setCredentialsError(err);\n        return null;\n      }\n    }\n\n    dispatch({\n      type: 'SET_NODES',\n      value: updatedNodes,\n    });\n\n    return updatedNode;\n  };\n\n  const handleEditClick = async () => {\n    updateHelpText(null);\n    setHovering(false);\n    const nodeToEdit = await updateNode();\n\n    if (nodeToEdit) {\n      dispatch({ type: 'SET_NODE_TO_EDIT', value: nodeToEdit });\n    }\n  };\n\n  const handleViewClick = async () => {\n    updateHelpText(null);\n    setHovering(false);\n    const nodeToView = await updateNode();\n\n    if (nodeToView) {\n      dispatch({ type: 'SET_NODE_TO_VIEW', value: nodeToView });\n    }\n  };\n\n  const handleNodeMouseEnter = () => {\n    ref.current.parentNode.appendChild(ref.current);\n    setHovering(true);\n    if (addingLink) {\n      updateHelpText(\n        node.isInvalidLinkTarget\n          ? t`Invalid link target. Unable to link to children or ancestor nodes. Graph cycles are not supported.`\n          : t`Click to create a new link to this node.`\n      );\n      onMouseOver(node);\n    }\n  };\n\n  const handleNodeMouseLeave = () => {\n    setHovering(false);\n    if (addingLink) {\n      updateHelpText(null);\n    }\n  };\n\n  const handleNodeClick = () => {\n    if (addingLink && !node.isInvalidLinkTarget && !isAddLinkSourceNode) {\n      dispatch({ type: 'SET_ADD_LINK_TARGET_NODE', value: node });\n    }\n  };\n\n  let nodeName;\n\n  if (node?.identifier && node.identifier !== '') {\n    nodeName = node.identifier;\n  } else if (\n    node?.identifier !== '' &&\n    node?.originalNodeObject?.identifier &&\n    !stringIsUUID(node.originalNodeObject.identifier)\n  ) {\n    nodeName = node?.originalNodeObject?.identifier;\n  } else {\n    nodeName =\n      node?.fullUnifiedJobTemplate?.name ||\n      node?.originalNodeObject?.summary_fields?.unified_job_template?.name ||\n      t`DELETED`;\n  }\n\n  const viewDetailsAction = (\n    <WorkflowActionTooltipItem\n      id=\"node-details\"\n      key=\"details\"\n      onClick={handleViewClick}\n      onMouseEnter={() => updateHelpText(t`View node details`)}\n      onMouseLeave={() => updateHelpText(null)}\n    >\n      <InfoIcon />\n    </WorkflowActionTooltipItem>\n  );\n\n  const tooltipActions = readOnly\n    ? [viewDetailsAction]\n    : [\n        <WorkflowActionTooltipItem\n          id=\"node-add\"\n          key=\"add\"\n          onClick={() => {\n            updateHelpText(null);\n            setHovering(false);\n            dispatch({ type: 'START_ADD_NODE', sourceNodeId: node.id });\n          }}\n          onMouseEnter={() => updateHelpText(t`Add a new node`)}\n          onMouseLeave={() => updateHelpText(null)}\n        >\n          <PlusIcon />\n        </WorkflowActionTooltipItem>,\n        viewDetailsAction,\n        <WorkflowActionTooltipItem\n          id=\"node-edit\"\n          key=\"edit\"\n          onClick={handleEditClick}\n          onMouseEnter={() => updateHelpText(t`Edit this node`)}\n          onMouseLeave={() => updateHelpText(null)}\n        >\n          <PencilAltIcon />\n        </WorkflowActionTooltipItem>,\n        <WorkflowActionTooltipItem\n          id=\"node-link\"\n          key=\"link\"\n          onClick={() => {\n            updateHelpText(null);\n            setHovering(false);\n            dispatch({ type: 'SELECT_SOURCE_FOR_LINKING', node });\n          }}\n          onMouseEnter={() => updateHelpText(t`Link to an available node`)}\n          onMouseLeave={() => updateHelpText(null)}\n        >\n          <LinkIcon />\n        </WorkflowActionTooltipItem>,\n        <WorkflowActionTooltipItem\n          id=\"node-delete\"\n          key=\"delete\"\n          onClick={() => {\n            updateHelpText(null);\n            setHovering(false);\n            dispatch({ type: 'SET_NODE_TO_DELETE', value: node });\n          }}\n          onMouseEnter={() => updateHelpText(t`Delete this node`)}\n          onMouseLeave={() => updateHelpText(null)}\n        >\n          <TrashAltIcon />\n        </WorkflowActionTooltipItem>,\n      ];\n\n  return (\n    <>\n      <NodeG\n        id={`node-${node.id}`}\n        job={node.job}\n        noPointerEvents={isAddLinkSourceNode}\n        onMouseEnter={handleNodeMouseEnter}\n        onMouseLeave={handleNodeMouseLeave}\n        ref={ref}\n        transform={`translate(${nodePositions[node.id].x},${\n          nodePositions[node.id].y - nodePositions[1].y\n        })`}\n      >\n        {(Object.prototype.hasOwnProperty.call(\n          node,\n          'all_parents_must_converge'\n        )\n          ? node.all_parents_must_converge\n          : node?.originalNodeObject?.all_parents_must_converge) && (\n          <>\n            <rect\n              fill={\n                hovering && addingLink && !node.isInvalidLinkTarget\n                  ? '#007ABC'\n                  : '#93969A'\n              }\n              height={wfConstants.nodeH / 4}\n              rx={2}\n              ry={2}\n              x={wfConstants.nodeW / 2 - wfConstants.nodeW / 10}\n              y={-wfConstants.nodeH / 4 + 2}\n              stroke={\n                hovering && addingLink && !node.isInvalidLinkTarget\n                  ? '#007ABC'\n                  : '#93969A'\n              }\n              strokeWidth=\"2px\"\n              width={wfConstants.nodeW / 5}\n            />\n            <foreignObject\n              height={wfConstants.nodeH / 4}\n              width={wfConstants.nodeW / 5}\n              x={wfConstants.nodeW / 2 - wfConstants.nodeW / 10 + 7}\n              y={-wfConstants.nodeH / 4 - 1}\n            >\n              <ConvergenceLabel data-cy=\"convergence-label\">{t`ALL`}</ConvergenceLabel>\n            </foreignObject>\n          </>\n        )}\n        <rect\n          fill=\"#FFFFFF\"\n          height={wfConstants.nodeH}\n          rx=\"2\"\n          ry=\"2\"\n          stroke={\n            hovering && addingLink && !node.isInvalidLinkTarget\n              ? '#007ABC'\n              : '#93969A'\n          }\n          strokeWidth=\"2px\"\n          width={wfConstants.nodeW}\n        />\n        <foreignObject\n          height=\"58\"\n          {...(!addingLink && {\n            onMouseEnter: () => updateNodeHelp(node),\n            onMouseLeave: () => updateNodeHelp(null),\n          })}\n          onClick={() => handleNodeClick()}\n          width=\"178\"\n          x=\"1\"\n          y=\"1\"\n        >\n          <NodeContents isInvalidLinkTarget={node.isInvalidLinkTarget}>\n            <NodeResourceName id={`node-${node.id}-name`}>\n              {nodeName}\n            </NodeResourceName>\n          </NodeContents>\n        </foreignObject>\n        <WorkflowNodeTypeLetter node={node} />\n        {hovering && !addingLink && (\n          <WorkflowActionTooltip\n            pointX={wfConstants.nodeW}\n            pointY={wfConstants.nodeH / 2}\n            actions={tooltipActions}\n          />\n        )}\n      </NodeG>\n      {detailError && (\n        <AlertModal\n          isOpen={detailError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={handleDetailErrorClose}\n        >\n          {t`Failed to retrieve full node resource object.`}\n          <ErrorDetail error={detailError} />\n        </AlertModal>\n      )}\n      {credentialsError && (\n        <AlertModal\n          isOpen={credentialsError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={handleCredentialsErrorClose}\n        >\n          {t`Failed to retrieve node credentials.`}\n          <ErrorDetail error={credentialsError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nVisualizerNode.propTypes = {\n  node: shape().isRequired,\n  onMouseOver: func,\n  readOnly: bool.isRequired,\n  updateHelpText: func.isRequired,\n  updateNodeHelp: func.isRequired,\n};\n\nVisualizerNode.defaultProps = {\n  onMouseOver: () => {},\n};\n\nexport default VisualizerNode;\n"]},"metadata":{},"sourceType":"module"}