{"ast":null,"code":"import _defineProperty from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _toConsumableArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect,useState}from'react';import{Link,useHistory}from'react-router-dom';import{Button,TextList,TextListItem,TextListVariants,TextListItemVariants,Tooltip}from'@patternfly/react-core';import getDocsBaseUrl from'util/getDocsBaseUrl';import{useConfig}from'contexts/Config';import AlertModal from'components/AlertModal';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import CredentialChip from'components/CredentialChip';import DeleteButton from'components/DeleteButton';import ErrorDetail from'components/ErrorDetail';import ExecutionEnvironmentDetail from'components/ExecutionEnvironmentDetail';import JobCancelButton from'components/JobCancelButton';import StatusLabel from'components/StatusLabel';import{CardBody,CardActionsRow}from'components/Card';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import useRequest from'hooks/useRequest';import{InventorySourcesAPI}from'api';import{relatedResourceDeleteRequests}from'util/getRelatedResourceDeleteDetails';import useIsMounted from'hooks/useIsMounted';import{formatDateString}from'util/dates';import Popover from'components/Popover';import{VERBOSITY}from'components/VerbositySelectField';import InventorySourceSyncButton from'../shared/InventorySourceSyncButton';import useWsInventorySourcesDetails from'../InventorySources/useWsInventorySourcesDetails';import helpText from'../shared/Inventory.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function InventorySourceDetail(_ref){var _job,_job2;var inventorySource=_ref.inventorySource;var _useWsInventorySource=useWsInventorySourcesDetails(inventorySource),created=_useWsInventorySource.created,custom_virtualenv=_useWsInventorySource.custom_virtualenv,description=_useWsInventorySource.description,id=_useWsInventorySource.id,modified=_useWsInventorySource.modified,name=_useWsInventorySource.name,overwrite=_useWsInventorySource.overwrite,overwrite_vars=_useWsInventorySource.overwrite_vars,source=_useWsInventorySource.source,source_path=_useWsInventorySource.source_path,source_vars=_useWsInventorySource.source_vars,update_cache_timeout=_useWsInventorySource.update_cache_timeout,update_on_launch=_useWsInventorySource.update_on_launch,verbosity=_useWsInventorySource.verbosity,enabled_var=_useWsInventorySource.enabled_var,enabled_value=_useWsInventorySource.enabled_value,host_filter=_useWsInventorySource.host_filter,summary_fields=_useWsInventorySource.summary_fields;var created_by=summary_fields.created_by,credentials=summary_fields.credentials,inventory=summary_fields.inventory,modified_by=summary_fields.modified_by,organization=summary_fields.organization,source_project=summary_fields.source_project,user_capabilities=summary_fields.user_capabilities,execution_environment=summary_fields.execution_environment;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),deletionError=_useState2[0],setDeletionError=_useState2[1];var config=useConfig();var history=useHistory();var isMounted=useIsMounted();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InventorySourc,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InventorySourcesAPI.readOptions();case 2:_yield$InventorySourc=_context.sent;data=_yield$InventorySourc.data;return _context.abrupt(\"return\",Object.assign.apply(Object,_toConsumableArray(data.actions.GET.source.choices.map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],val=_ref4[1];return _defineProperty({},key,val);}))));case 5:case\"end\":return _context.stop();}}},_callee);})),[]),{}),sourceChoices=_useRequest.result,error=_useRequest.error,isLoading=_useRequest.isLoading,fetchSourceChoices=_useRequest.request;var docsBaseUrl=getDocsBaseUrl(config);useEffect(function(){fetchSourceChoices();},[fetchSourceChoices]);var handleDelete=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return Promise.all([InventorySourcesAPI.destroyHosts(id),InventorySourcesAPI.destroyGroups(id),InventorySourcesAPI.destroy(id)]);case 3:history.push(\"/inventories/inventory/\".concat(inventory.id,\"/sources\"));_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);if(isMounted.current){setDeletionError(_context2.t0);}case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref6.apply(this,arguments);};}();var deleteDetailsRequests=relatedResourceDeleteRequests.inventorySource(inventorySource.id);var optionsList='';if(overwrite||overwrite_vars||update_on_launch){optionsList=/*#__PURE__*/_jsxs(TextList,{component:TextListVariants.ul,children:[overwrite&&/*#__PURE__*/_jsxs(TextListItem,{component:TextListItemVariants.li,children:[/*i18n*/i18n._(\"Overwrite local groups and hosts from remote inventory source\"),/*#__PURE__*/_jsx(Popover,{content:helpText.subFormOptions.overwrite})]}),overwrite_vars&&/*#__PURE__*/_jsxs(TextListItem,{component:TextListItemVariants.li,children:[/*i18n*/i18n._(\"Overwrite local variables from remote inventory source\"),/*#__PURE__*/_jsx(Popover,{content:helpText.subFormOptions.overwriteVariables})]}),update_on_launch&&/*#__PURE__*/_jsxs(TextListItem,{component:TextListItemVariants.li,children:[/*i18n*/i18n._(\"Update on launch\"),/*#__PURE__*/_jsx(Popover,{content:helpText.subFormOptions.updateOnLaunch({value:source_project})})]})]});}if(isLoading){return/*#__PURE__*/_jsx(ContentLoading,{});}if(error){return/*#__PURE__*/_jsx(ContentError,{error:error});}var generateLastJobTooltip=function generateLastJobTooltip(job){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*i18n*/i18n._(\"MOST RECENT SYNC\")}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"JOB ID:\"),\" \",job.id]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"STATUS:\"),\" \",job.status.toUpperCase()]}),job.finished&&/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"FINISHED:\"),\" \",formatDateString(job.finished)]})]});};var job=null;if(summary_fields!==null&&summary_fields!==void 0&&summary_fields.current_job){job=summary_fields.current_job;}else if(summary_fields!==null&&summary_fields!==void 0&&summary_fields.last_job){job=summary_fields.last_job;}return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Last Job Status\"),value:job&&/*#__PURE__*/_jsx(Tooltip,{position:\"top\",content:generateLastJobTooltip(job),children:/*#__PURE__*/_jsx(Link,{to:\"/jobs/inventory/\".concat(job.id),children:/*#__PURE__*/_jsx(StatusLabel,{status:job.status})})},job.id)}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Source\"),value:sourceChoices[source]}),organization&&/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Organization\"),value:/*#__PURE__*/_jsx(Link,{to:\"/organizations/\".concat(organization.id,\"/details\"),children:organization.name})}),/*#__PURE__*/_jsx(ExecutionEnvironmentDetail,{virtualEnvironment:custom_virtualenv,executionEnvironment:execution_environment}),source_project&&/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Project\"),value:/*#__PURE__*/_jsx(Link,{to:\"/projects/\".concat(source_project.id,\"/details\"),children:source_project.name})}),source==='scm'?/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Inventory file\"),helpText:helpText.sourcePath,value:source_path===''?/*i18n*/i18n._(\"/ (project root)\"):source_path}):null,/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Verbosity\"),helpText:helpText.subFormVerbosityFields,value:VERBOSITY()[verbosity]}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Cache timeout\"),value:\"\".concat(update_cache_timeout,\" \").concat(/*i18n*/i18n._(\"seconds\")),helpText:helpText.subFormOptions.cachedTimeOut}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Host Filter\"),helpText:helpText.hostFilter,value:host_filter}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Enabled Variable\"),helpText:helpText.enabledVariableField,value:enabled_var}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Enabled Value\"),helpText:helpText.enabledValue,value:enabled_value}),/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Credential\"),value:credentials===null||credentials===void 0?void 0:credentials.map(function(cred){return/*#__PURE__*/_jsx(CredentialChip,{credential:cred,isReadOnly:true},cred===null||cred===void 0?void 0:cred.id);}),isEmpty:(credentials===null||credentials===void 0?void 0:credentials.length)===0}),optionsList&&/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Enabled Options\"),value:optionsList}),source_vars&&/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Source variables\"),rows:4,value:source_vars,helpText:helpText.sourceVars(docsBaseUrl,source),name:\"source_vars\",dataCy:\"inventory-source-detail-variables\"}),/*#__PURE__*/_jsx(UserDateDetail,{date:created,label:/*i18n*/i18n._(\"Created\"),user:created_by}),/*#__PURE__*/_jsx(UserDateDetail,{date:modified,label:/*i18n*/i18n._(\"Last modified\"),user:modified_by})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.edit)&&/*#__PURE__*/_jsx(Button,{ouiaId:\"inventory-source-detail-edit-button\",component:Link,\"aria-label\":/*i18n*/i18n._(\"edit\"),to:\"/inventories/inventory/\".concat(inventory.id,\"/sources/\").concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.start)&&(['new','running','pending','waiting'].includes((_job=job)===null||_job===void 0?void 0:_job.status)?/*#__PURE__*/_jsx(JobCancelButton,{job:{id:job.id,type:'inventory_update'},errorTitle:/*i18n*/i18n._(\"Inventory Source Sync Error\"),title:/*i18n*/i18n._(\"Cancel Inventory Source Sync\"),errorMessage:/*i18n*/i18n._(\"Failed to cancel Inventory Source Sync\"),buttonText:/*i18n*/i18n._(\"Cancel Sync\")}):/*#__PURE__*/_jsx(InventorySourceSyncButton,{source:inventorySource,icon:false})),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.delete)&&/*#__PURE__*/_jsx(DeleteButton,{name:name,modalTitle:/*i18n*/i18n._(\"Delete inventory source\"),onConfirm:handleDelete,deleteDetailsRequests:deleteDetailsRequests,deleteMessage:/*i18n*/i18n._(\"This inventory source is currently being used by other resources that rely on it. Are you sure you want to delete it?\"),isDisabled:((_job2=job)===null||_job2===void 0?void 0:_job2.status)==='running',children:/*i18n*/i18n._(\"Delete\")})]}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),isOpen:deletionError,onClose:function onClose(){return setDeletionError(false);},children:[/*i18n*/i18n._(\"Failed to delete inventory source {name}.\",{name:name}),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default InventorySourceDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventorySourceDetail/InventorySourceDetail.js"],"names":["React","useCallback","useEffect","useState","Link","useHistory","Button","TextList","TextListItem","TextListVariants","TextListItemVariants","Tooltip","getDocsBaseUrl","useConfig","AlertModal","ContentError","ContentLoading","CredentialChip","DeleteButton","ErrorDetail","ExecutionEnvironmentDetail","JobCancelButton","StatusLabel","CardBody","CardActionsRow","DetailList","Detail","UserDateDetail","VariablesDetail","useRequest","InventorySourcesAPI","relatedResourceDeleteRequests","useIsMounted","formatDateString","Popover","VERBOSITY","InventorySourceSyncButton","useWsInventorySourcesDetails","helpText","InventorySourceDetail","inventorySource","created","custom_virtualenv","description","id","modified","name","overwrite","overwrite_vars","source","source_path","source_vars","update_cache_timeout","update_on_launch","verbosity","enabled_var","enabled_value","host_filter","summary_fields","created_by","credentials","inventory","modified_by","organization","source_project","user_capabilities","execution_environment","deletionError","setDeletionError","config","history","isMounted","readOptions","data","Object","assign","actions","GET","choices","map","key","val","sourceChoices","result","error","isLoading","fetchSourceChoices","request","docsBaseUrl","handleDelete","Promise","all","destroyHosts","destroyGroups","destroy","push","current","deleteDetailsRequests","optionsList","ul","li","subFormOptions","overwriteVariables","updateOnLaunch","value","generateLastJobTooltip","job","status","toUpperCase","finished","current_job","last_job","sourcePath","subFormVerbosityFields","cachedTimeOut","hostFilter","enabledVariableField","enabledValue","cred","length","sourceVars","edit","start","includes","type","delete"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport {\n  Button,\n  TextList,\n  TextListItem,\n  TextListVariants,\n  TextListItemVariants,\n  Tooltip,\n} from '@patternfly/react-core';\nimport getDocsBaseUrl from 'util/getDocsBaseUrl';\nimport { useConfig } from 'contexts/Config';\nimport AlertModal from 'components/AlertModal';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport CredentialChip from 'components/CredentialChip';\nimport DeleteButton from 'components/DeleteButton';\nimport ErrorDetail from 'components/ErrorDetail';\nimport ExecutionEnvironmentDetail from 'components/ExecutionEnvironmentDetail';\nimport JobCancelButton from 'components/JobCancelButton';\nimport StatusLabel from 'components/StatusLabel';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport useRequest from 'hooks/useRequest';\nimport { InventorySourcesAPI } from 'api';\nimport { relatedResourceDeleteRequests } from 'util/getRelatedResourceDeleteDetails';\nimport useIsMounted from 'hooks/useIsMounted';\nimport { formatDateString } from 'util/dates';\nimport Popover from 'components/Popover';\nimport { VERBOSITY } from 'components/VerbositySelectField';\nimport InventorySourceSyncButton from '../shared/InventorySourceSyncButton';\nimport useWsInventorySourcesDetails from '../InventorySources/useWsInventorySourcesDetails';\nimport helpText from '../shared/Inventory.helptext';\n\nfunction InventorySourceDetail({ inventorySource }) {\n  const {\n    created,\n    custom_virtualenv,\n    description,\n    id,\n    modified,\n    name,\n    overwrite,\n    overwrite_vars,\n    source,\n    source_path,\n    source_vars,\n    update_cache_timeout,\n    update_on_launch,\n    verbosity,\n    enabled_var,\n    enabled_value,\n    host_filter,\n    summary_fields,\n  } = useWsInventorySourcesDetails(inventorySource);\n\n  const {\n    created_by,\n    credentials,\n    inventory,\n    modified_by,\n    organization,\n    source_project,\n    user_capabilities,\n    execution_environment,\n  } = summary_fields;\n\n  const [deletionError, setDeletionError] = useState(false);\n  const config = useConfig();\n  const history = useHistory();\n  const isMounted = useIsMounted();\n\n  const {\n    result: sourceChoices,\n    error,\n    isLoading,\n    request: fetchSourceChoices,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await InventorySourcesAPI.readOptions();\n      return Object.assign(\n        ...data.actions.GET.source.choices.map(([key, val]) => ({ [key]: val }))\n      );\n    }, []),\n    {}\n  );\n\n  const docsBaseUrl = getDocsBaseUrl(config);\n  useEffect(() => {\n    fetchSourceChoices();\n  }, [fetchSourceChoices]);\n\n  const handleDelete = async () => {\n    try {\n      await Promise.all([\n        InventorySourcesAPI.destroyHosts(id),\n        InventorySourcesAPI.destroyGroups(id),\n        InventorySourcesAPI.destroy(id),\n      ]);\n      history.push(`/inventories/inventory/${inventory.id}/sources`);\n    } catch (err) {\n      if (isMounted.current) {\n        setDeletionError(err);\n      }\n    }\n  };\n\n  const deleteDetailsRequests = relatedResourceDeleteRequests.inventorySource(\n    inventorySource.id\n  );\n\n  let optionsList = '';\n  if (overwrite || overwrite_vars || update_on_launch) {\n    optionsList = (\n      <TextList component={TextListVariants.ul}>\n        {overwrite && (\n          <TextListItem component={TextListItemVariants.li}>\n            {t`Overwrite local groups and hosts from remote inventory source`}\n            <Popover content={helpText.subFormOptions.overwrite} />\n          </TextListItem>\n        )}\n        {overwrite_vars && (\n          <TextListItem component={TextListItemVariants.li}>\n            {t`Overwrite local variables from remote inventory source`}\n            <Popover content={helpText.subFormOptions.overwriteVariables} />\n          </TextListItem>\n        )}\n        {update_on_launch && (\n          <TextListItem component={TextListItemVariants.li}>\n            {t`Update on launch`}\n            <Popover\n              content={helpText.subFormOptions.updateOnLaunch({\n                value: source_project,\n              })}\n            />\n          </TextListItem>\n        )}\n      </TextList>\n    );\n  }\n\n  if (isLoading) {\n    return <ContentLoading />;\n  }\n\n  if (error) {\n    return <ContentError error={error} />;\n  }\n\n  const generateLastJobTooltip = (job) => (\n    <>\n      <div>{t`MOST RECENT SYNC`}</div>\n      <div>\n        {t`JOB ID:`} {job.id}\n      </div>\n      <div>\n        {t`STATUS:`} {job.status.toUpperCase()}\n      </div>\n      {job.finished && (\n        <div>\n          {t`FINISHED:`} {formatDateString(job.finished)}\n        </div>\n      )}\n    </>\n  );\n\n  let job = null;\n\n  if (summary_fields?.current_job) {\n    job = summary_fields.current_job;\n  } else if (summary_fields?.last_job) {\n    job = summary_fields.last_job;\n  }\n\n  return (\n    <CardBody>\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} />\n        <Detail\n          label={t`Last Job Status`}\n          value={\n            job && (\n              <Tooltip\n                position=\"top\"\n                content={generateLastJobTooltip(job)}\n                key={job.id}\n              >\n                <Link to={`/jobs/inventory/${job.id}`}>\n                  <StatusLabel status={job.status} />\n                </Link>\n              </Tooltip>\n            )\n          }\n        />\n        <Detail label={t`Description`} value={description} />\n        <Detail label={t`Source`} value={sourceChoices[source]} />\n        {organization && (\n          <Detail\n            label={t`Organization`}\n            value={\n              <Link to={`/organizations/${organization.id}/details`}>\n                {organization.name}\n              </Link>\n            }\n          />\n        )}\n        <ExecutionEnvironmentDetail\n          virtualEnvironment={custom_virtualenv}\n          executionEnvironment={execution_environment}\n        />\n        {source_project && (\n          <Detail\n            label={t`Project`}\n            value={\n              <Link to={`/projects/${source_project.id}/details`}>\n                {source_project.name}\n              </Link>\n            }\n          />\n        )}\n        {source === 'scm' ? (\n          <Detail\n            label={t`Inventory file`}\n            helpText={helpText.sourcePath}\n            value={source_path === '' ? t`/ (project root)` : source_path}\n          />\n        ) : null}\n        <Detail\n          label={t`Verbosity`}\n          helpText={helpText.subFormVerbosityFields}\n          value={VERBOSITY()[verbosity]}\n        />\n        <Detail\n          label={t`Cache timeout`}\n          value={`${update_cache_timeout} ${t`seconds`}`}\n          helpText={helpText.subFormOptions.cachedTimeOut}\n        />\n        <Detail\n          label={t`Host Filter`}\n          helpText={helpText.hostFilter}\n          value={host_filter}\n        />\n        <Detail\n          label={t`Enabled Variable`}\n          helpText={helpText.enabledVariableField}\n          value={enabled_var}\n        />\n        <Detail\n          label={t`Enabled Value`}\n          helpText={helpText.enabledValue}\n          value={enabled_value}\n        />\n        <Detail\n          fullWidth\n          label={t`Credential`}\n          value={credentials?.map((cred) => (\n            <CredentialChip key={cred?.id} credential={cred} isReadOnly />\n          ))}\n          isEmpty={credentials?.length === 0}\n        />\n        {optionsList && (\n          <Detail fullWidth label={t`Enabled Options`} value={optionsList} />\n        )}\n        {source_vars && (\n          <VariablesDetail\n            label={t`Source variables`}\n            rows={4}\n            value={source_vars}\n            helpText={helpText.sourceVars(docsBaseUrl, source)}\n            name=\"source_vars\"\n            dataCy=\"inventory-source-detail-variables\"\n          />\n        )}\n        <UserDateDetail date={created} label={t`Created`} user={created_by} />\n        <UserDateDetail\n          date={modified}\n          label={t`Last modified`}\n          user={modified_by}\n        />\n      </DetailList>\n      <CardActionsRow>\n        {user_capabilities?.edit && (\n          <Button\n            ouiaId=\"inventory-source-detail-edit-button\"\n            component={Link}\n            aria-label={t`edit`}\n            to={`/inventories/inventory/${inventory.id}/sources/${id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {user_capabilities?.start &&\n          (['new', 'running', 'pending', 'waiting'].includes(job?.status) ? (\n            <JobCancelButton\n              job={{ id: job.id, type: 'inventory_update' }}\n              errorTitle={t`Inventory Source Sync Error`}\n              title={t`Cancel Inventory Source Sync`}\n              errorMessage={t`Failed to cancel Inventory Source Sync`}\n              buttonText={t`Cancel Sync`}\n            />\n          ) : (\n            <InventorySourceSyncButton source={inventorySource} icon={false} />\n          ))}\n        {user_capabilities?.delete && (\n          <DeleteButton\n            name={name}\n            modalTitle={t`Delete inventory source`}\n            onConfirm={handleDelete}\n            deleteDetailsRequests={deleteDetailsRequests}\n            deleteMessage={t`This inventory source is currently being used by other resources that rely on it. Are you sure you want to delete it?`}\n            isDisabled={job?.status === 'running'}\n          >\n            {t`Delete`}\n          </DeleteButton>\n        )}\n      </CardActionsRow>\n      {deletionError && (\n        <AlertModal\n          variant=\"error\"\n          title={t`Error!`}\n          isOpen={deletionError}\n          onClose={() => setDeletionError(false)}\n        >\n          {t`Failed to delete inventory source ${name}.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\nexport default InventorySourceDetail;\n"]},"metadata":{},"sourceType":"module"}