{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Link,useHistory}from'react-router-dom';import{Chip,Button,TextList,TextListItem,TextListVariants,TextListItemVariants,Label}from'@patternfly/react-core';import{WorkflowJobTemplatesAPI}from'api';import AlertModal from'components/AlertModal';import{CardBody,CardActionsRow}from'components/Card';import ChipGroup from'components/ChipGroup';import{VariablesDetail}from'components/CodeEditor';import DeleteButton from'components/DeleteButton';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import ErrorDetail from'components/ErrorDetail';import{LaunchButton}from'components/LaunchButton';import Sparkline from'components/Sparkline';import{toTitleCase}from'util/strings';import{relatedResourceDeleteRequests}from'util/getRelatedResourceDeleteDetails';import useRequest,{useDismissableError}from'hooks/useRequest';import helpText from'../shared/WorkflowJobTemplate.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function WorkflowJobTemplateDetail(_ref){var _summary_fields$user_,_summary_fields$recen,_summary_fields$label,_summary_fields$label2;var template=_ref.template;var id=template.id,ask_inventory_on_launch=template.ask_inventory_on_launch,name=template.name,description=template.description,type=template.type,extra_vars=template.extra_vars,created=template.created,modified=template.modified,summary_fields=template.summary_fields,related=template.related,webhook_credential=template.webhook_credential,webhook_key=template.webhook_key,scmBranch=template.scm_branch,limit=template.limit;var urlOrigin=window.location.origin;var history=useHistory();var renderOptionsField=template.allow_simultaneous||template.webhook_service;var renderOptions=/*#__PURE__*/_jsxs(TextList,{component:TextListVariants.ul,children:[template.allow_simultaneous&&/*#__PURE__*/_jsx(TextListItem,{component:TextListItemVariants.li,children:/*i18n*/i18n._(\"Concurrent Jobs\")}),template.webhook_service&&/*#__PURE__*/_jsx(TextListItem,{component:TextListItemVariants.li,children:/*i18n*/i18n._(\"Webhooks\")})]});var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return WorkflowJobTemplatesAPI.destroy(id);case 2:history.push(\"/templates\");case 3:case\"end\":return _context.stop();}}},_callee);})),[id,history])),deleteWorkflowJobTemplate=_useRequest.request,isLoading=_useRequest.isLoading,deleteError=_useRequest.error;var _useDismissableError=useDismissableError(deleteError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var inventoryValue=function inventoryValue(kind,inventoryId){var inventorykind=kind==='smart'?'smart_inventory':'inventory';return ask_inventory_on_launch?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/inventories/\".concat(inventorykind,\"/\").concat(inventoryId,\"/details\"),children:/*#__PURE__*/_jsx(Label,{children:summary_fields.inventory.name})}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*i18n*/i18n._(\"(Prompt on launch)\")]})]}):/*#__PURE__*/_jsx(Link,{to:\"/inventories/\".concat(inventorykind,\"/\").concat(inventoryId,\"/details\"),children:/*#__PURE__*/_jsx(Label,{children:summary_fields.inventory.name})});};var canLaunch=summary_fields===null||summary_fields===void 0?void 0:(_summary_fields$user_=summary_fields.user_capabilities)===null||_summary_fields$user_===void 0?void 0:_summary_fields$user_.start;var recentPlaybookJobs=summary_fields.recent_jobs.map(function(job){return _objectSpread(_objectSpread({},job),{},{type:'workflow_job'});});var deleteDetailsRequests=relatedResourceDeleteRequests.template(template);return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name,dataCy:\"jt-detail-name\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(Detail,{value:/*#__PURE__*/_jsx(Sparkline,{jobs:recentPlaybookJobs}),label:/*i18n*/i18n._(\"Activity\"),isEmpty:((_summary_fields$recen=summary_fields.recent_jobs)===null||_summary_fields$recen===void 0?void 0:_summary_fields$recen.length)===0}),summary_fields.organization&&/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Organization\"),value:/*#__PURE__*/_jsx(Link,{to:\"/organizations/\".concat(summary_fields.organization.id,\"/details\"),children:/*#__PURE__*/_jsx(Label,{children:summary_fields.organization.name})})}),scmBranch&&/*#__PURE__*/_jsx(Detail,{dataCy:\"source-control-branch\",label:/*i18n*/i18n._(\"Source Control Branch\"),value:scmBranch,helpText:helpText.sourceControlBranch}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Job Type\"),value:toTitleCase(type)}),summary_fields.inventory&&/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Inventory\"),helpText:helpText.inventory,value:inventoryValue(summary_fields.inventory.kind,summary_fields.inventory.id)}),/*#__PURE__*/_jsx(Detail,{dataCy:\"limit\",label:/*i18n*/i18n._(\"Limit\"),value:limit,helpText:helpText.limit}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Webhook Service\"),value:toTitleCase(template.webhook_service),helpText:helpText.webhookService}),related.webhook_receiver&&/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Webhook URL\"),helpText:helpText.webhookURL,value:\"\".concat(urlOrigin).concat(template.related.webhook_receiver)}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Webhook Key\"),value:webhook_key,helpText:helpText.webhookKey}),webhook_credential&&/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Webhook Credentials\"),helpText:helpText.webhookCredential,value:/*#__PURE__*/_jsx(Link,{to:\"/credentials/\".concat(summary_fields.webhook_credential.id,\"/details\"),children:/*#__PURE__*/_jsx(Label,{children:summary_fields.webhook_credential.name})})}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Created\"),date:created,user:summary_fields.created_by}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Modified\"),date:modified,user:summary_fields.modified_by}),renderOptionsField&&/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Enabled Options\"),value:renderOptions,helpText:helpText.enabledOptions}),/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Labels\"),helpText:helpText.labels,value:/*#__PURE__*/_jsx(ChipGroup,{numChips:3,totalChips:summary_fields.labels.results.length,ouiaId:\"workflow-job-template-detail-label-chips\",children:summary_fields.labels.results.map(function(l){return/*#__PURE__*/_jsx(Chip,{ouiaId:\"\".concat(l.name,\"-label-chip\"),isReadOnly:true,children:l.name},l.id);})}),isEmpty:!((_summary_fields$label=summary_fields.labels)!==null&&_summary_fields$label!==void 0&&(_summary_fields$label2=_summary_fields$label.results)!==null&&_summary_fields$label2!==void 0&&_summary_fields$label2.length)}),/*#__PURE__*/_jsx(VariablesDetail,{dataCy:\"workflow-job-template-detail-extra-vars\",helpText:helpText.variables,label:/*i18n*/i18n._(\"Variables\"),value:extra_vars,rows:4,name:\"extra_vars\"})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[summary_fields.user_capabilities&&summary_fields.user_capabilities.edit&&/*#__PURE__*/_jsx(Button,{ouiaId:\"workflow-job-template-detail-edit-button\",component:Link,to:\"/templates/workflow_job_template/\".concat(id,\"/edit\"),\"aria-label\":/*i18n*/i18n._(\"Edit\"),children:/*i18n*/i18n._(\"Edit\")}),canLaunch&&/*#__PURE__*/_jsx(LaunchButton,{resource:template,\"aria-label\":/*i18n*/i18n._(\"Launch\"),children:function children(_ref3){var handleLaunch=_ref3.handleLaunch,isLaunching=_ref3.isLaunching;return/*#__PURE__*/_jsx(Button,{ouiaId:\"workflow-job-template-detail-launch-button\",variant:\"secondary\",type:\"submit\",onClick:handleLaunch,isDisabled:isLaunching,children:/*i18n*/i18n._(\"Launch\")});}}),summary_fields.user_capabilities&&summary_fields.user_capabilities.delete&&/*#__PURE__*/_jsx(DeleteButton,{name:name,modalTitle:/*i18n*/i18n._(\"Delete Workflow Job Template\"),onConfirm:deleteWorkflowJobTemplate,isDisabled:isLoading,deleteDetailsRequests:deleteDetailsRequests,deleteMessage:/*i18n*/i18n._(\"This workflow job template is currently being used by other resources. Are you sure you want to delete it?\"),children:/*i18n*/i18n._(\"Delete\")})]}),error&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to delete workflow job template.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:error})]})]});}export{WorkflowJobTemplateDetail as _WorkflowJobTemplateDetail};export default WorkflowJobTemplateDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Template/WorkflowJobTemplateDetail/WorkflowJobTemplateDetail.js"],"names":["React","useCallback","Link","useHistory","Chip","Button","TextList","TextListItem","TextListVariants","TextListItemVariants","Label","WorkflowJobTemplatesAPI","AlertModal","CardBody","CardActionsRow","ChipGroup","VariablesDetail","DeleteButton","DetailList","Detail","UserDateDetail","ErrorDetail","LaunchButton","Sparkline","toTitleCase","relatedResourceDeleteRequests","useRequest","useDismissableError","helpText","WorkflowJobTemplateDetail","template","id","ask_inventory_on_launch","name","description","type","extra_vars","created","modified","summary_fields","related","webhook_credential","webhook_key","scmBranch","scm_branch","limit","urlOrigin","window","location","origin","history","renderOptionsField","allow_simultaneous","webhook_service","renderOptions","ul","li","destroy","push","deleteWorkflowJobTemplate","request","isLoading","deleteError","error","dismissError","inventoryValue","kind","inventoryId","inventorykind","inventory","canLaunch","user_capabilities","start","recentPlaybookJobs","recent_jobs","map","job","deleteDetailsRequests","length","organization","sourceControlBranch","webhookService","webhook_receiver","webhookURL","webhookKey","webhookCredential","created_by","modified_by","enabledOptions","labels","results","l","variables","edit","handleLaunch","isLaunching","delete","_WorkflowJobTemplateDetail"],"mappings":"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","sourcesContent":["import React, { useCallback } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport {\n  Chip,\n  Button,\n  TextList,\n  TextListItem,\n  TextListVariants,\n  TextListItemVariants,\n  Label,\n} from '@patternfly/react-core';\nimport { WorkflowJobTemplatesAPI } from 'api';\n\nimport AlertModal from 'components/AlertModal';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport ChipGroup from 'components/ChipGroup';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport DeleteButton from 'components/DeleteButton';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { LaunchButton } from 'components/LaunchButton';\nimport Sparkline from 'components/Sparkline';\nimport { toTitleCase } from 'util/strings';\nimport { relatedResourceDeleteRequests } from 'util/getRelatedResourceDeleteDetails';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport helpText from '../shared/WorkflowJobTemplate.helptext';\n\nfunction WorkflowJobTemplateDetail({ template }) {\n  const {\n    id,\n    ask_inventory_on_launch,\n    name,\n    description,\n    type,\n    extra_vars,\n    created,\n    modified,\n    summary_fields,\n    related,\n    webhook_credential,\n    webhook_key,\n    scm_branch: scmBranch,\n    limit,\n  } = template;\n\n  const urlOrigin = window.location.origin;\n  const history = useHistory();\n\n  const renderOptionsField =\n    template.allow_simultaneous || template.webhook_service;\n\n  const renderOptions = (\n    <TextList component={TextListVariants.ul}>\n      {template.allow_simultaneous && (\n        <TextListItem component={TextListItemVariants.li}>\n          {t`Concurrent Jobs`}\n        </TextListItem>\n      )}\n      {template.webhook_service && (\n        <TextListItem component={TextListItemVariants.li}>\n          {t`Webhooks`}\n        </TextListItem>\n      )}\n    </TextList>\n  );\n\n  const {\n    request: deleteWorkflowJobTemplate,\n    isLoading,\n    error: deleteError,\n  } = useRequest(\n    useCallback(async () => {\n      await WorkflowJobTemplatesAPI.destroy(id);\n      history.push(`/templates`);\n    }, [id, history])\n  );\n\n  const { error, dismissError } = useDismissableError(deleteError);\n\n  const inventoryValue = (kind, inventoryId) => {\n    const inventorykind = kind === 'smart' ? 'smart_inventory' : 'inventory';\n\n    return ask_inventory_on_launch ? (\n      <>\n        <Link to={`/inventories/${inventorykind}/${inventoryId}/details`}>\n          <Label>{summary_fields.inventory.name}</Label>\n        </Link>\n        <span> {t`(Prompt on launch)`}</span>\n      </>\n    ) : (\n      <Link to={`/inventories/${inventorykind}/${inventoryId}/details`}>\n        <Label>{summary_fields.inventory.name}</Label>\n      </Link>\n    );\n  };\n\n  const canLaunch = summary_fields?.user_capabilities?.start;\n  const recentPlaybookJobs = summary_fields.recent_jobs.map((job) => ({\n    ...job,\n    type: 'workflow_job',\n  }));\n\n  const deleteDetailsRequests =\n    relatedResourceDeleteRequests.template(template);\n\n  return (\n    <CardBody>\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} dataCy=\"jt-detail-name\" />\n        <Detail label={t`Description`} value={description} />\n        <Detail\n          value={<Sparkline jobs={recentPlaybookJobs} />}\n          label={t`Activity`}\n          isEmpty={summary_fields.recent_jobs?.length === 0}\n        />\n        {summary_fields.organization && (\n          <Detail\n            label={t`Organization`}\n            value={\n              <Link\n                to={`/organizations/${summary_fields.organization.id}/details`}\n              >\n                <Label>{summary_fields.organization.name}</Label>\n              </Link>\n            }\n          />\n        )}\n        {scmBranch && (\n          <Detail\n            dataCy=\"source-control-branch\"\n            label={t`Source Control Branch`}\n            value={scmBranch}\n            helpText={helpText.sourceControlBranch}\n          />\n        )}\n        <Detail label={t`Job Type`} value={toTitleCase(type)} />\n        {summary_fields.inventory && (\n          <Detail\n            label={t`Inventory`}\n            helpText={helpText.inventory}\n            value={inventoryValue(\n              summary_fields.inventory.kind,\n              summary_fields.inventory.id\n            )}\n          />\n        )}\n        <Detail\n          dataCy=\"limit\"\n          label={t`Limit`}\n          value={limit}\n          helpText={helpText.limit}\n        />\n        <Detail\n          label={t`Webhook Service`}\n          value={toTitleCase(template.webhook_service)}\n          helpText={helpText.webhookService}\n        />\n        {related.webhook_receiver && (\n          <Detail\n            label={t`Webhook URL`}\n            helpText={helpText.webhookURL}\n            value={`${urlOrigin}${template.related.webhook_receiver}`}\n          />\n        )}\n        <Detail\n          label={t`Webhook Key`}\n          value={webhook_key}\n          helpText={helpText.webhookKey}\n        />\n        {webhook_credential && (\n          <Detail\n            fullWidth\n            label={t`Webhook Credentials`}\n            helpText={helpText.webhookCredential}\n            value={\n              <Link\n                to={`/credentials/${summary_fields.webhook_credential.id}/details`}\n              >\n                <Label>{summary_fields.webhook_credential.name}</Label>\n              </Link>\n            }\n          />\n        )}\n        <UserDateDetail\n          label={t`Created`}\n          date={created}\n          user={summary_fields.created_by}\n        />\n        <UserDateDetail\n          label={t`Modified`}\n          date={modified}\n          user={summary_fields.modified_by}\n        />\n        {renderOptionsField && (\n          <Detail\n            fullWidth\n            label={t`Enabled Options`}\n            value={renderOptions}\n            helpText={helpText.enabledOptions}\n          />\n        )}\n        <Detail\n          fullWidth\n          label={t`Labels`}\n          helpText={helpText.labels}\n          value={\n            <ChipGroup\n              numChips={3}\n              totalChips={summary_fields.labels.results.length}\n              ouiaId=\"workflow-job-template-detail-label-chips\"\n            >\n              {summary_fields.labels.results.map((l) => (\n                <Chip key={l.id} ouiaId={`${l.name}-label-chip`} isReadOnly>\n                  {l.name}\n                </Chip>\n              ))}\n            </ChipGroup>\n          }\n          isEmpty={!summary_fields.labels?.results?.length}\n        />\n        <VariablesDetail\n          dataCy=\"workflow-job-template-detail-extra-vars\"\n          helpText={helpText.variables}\n          label={t`Variables`}\n          value={extra_vars}\n          rows={4}\n          name=\"extra_vars\"\n        />\n      </DetailList>\n      <CardActionsRow>\n        {summary_fields.user_capabilities &&\n          summary_fields.user_capabilities.edit && (\n            <Button\n              ouiaId=\"workflow-job-template-detail-edit-button\"\n              component={Link}\n              to={`/templates/workflow_job_template/${id}/edit`}\n              aria-label={t`Edit`}\n            >\n              {t`Edit`}\n            </Button>\n          )}\n        {canLaunch && (\n          <LaunchButton resource={template} aria-label={t`Launch`}>\n            {({ handleLaunch, isLaunching }) => (\n              <Button\n                ouiaId=\"workflow-job-template-detail-launch-button\"\n                variant=\"secondary\"\n                type=\"submit\"\n                onClick={handleLaunch}\n                isDisabled={isLaunching}\n              >\n                {t`Launch`}\n              </Button>\n            )}\n          </LaunchButton>\n        )}\n        {summary_fields.user_capabilities &&\n          summary_fields.user_capabilities.delete && (\n            <DeleteButton\n              name={name}\n              modalTitle={t`Delete Workflow Job Template`}\n              onConfirm={deleteWorkflowJobTemplate}\n              isDisabled={isLoading}\n              deleteDetailsRequests={deleteDetailsRequests}\n              deleteMessage={t`This workflow job template is currently being used by other resources. Are you sure you want to delete it?`}\n            >\n              {t`Delete`}\n            </DeleteButton>\n          )}\n      </CardActionsRow>\n      {error && (\n        <AlertModal\n          isOpen={error}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissError}\n        >\n          {t`Failed to delete workflow job template.`}\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\nexport { WorkflowJobTemplateDetail as _WorkflowJobTemplateDetail };\nexport default WorkflowJobTemplateDetail;\n"]},"metadata":{},"sourceType":"module"}