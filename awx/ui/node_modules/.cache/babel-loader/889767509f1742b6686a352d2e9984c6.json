{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{i18n}from\"@lingui/core\";/* eslint-disable react/jsx-no-useless-fragment */import React,{useState}from'react';import{useLocation}from'react-router-dom';import{Button,ButtonVariant,Dropdown,DropdownPosition,DropdownToggle,DropdownItem,InputGroup}from'@patternfly/react-core';import{SortAlphaDownIcon,SortAlphaDownAltIcon,SortNumericDownIcon,SortNumericDownAltIcon}from'@patternfly/react-icons';import styled from'styled-components';import{parseQueryString}from'util/qs';import{SortColumns,QSConfig}from'types';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NoOptionDropdown=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  align-self: stretch;\\n  border: 1px solid var(--pf-global--BorderColor--300);\\n  padding: 5px 15px;\\n  white-space: nowrap;\\n  border-bottom-color: var(--pf-global--BorderColor--200);\\n\"])));function Sort(_ref){var columns=_ref.columns,qsConfig=_ref.qsConfig,onSort=_ref.onSort;var location=useLocation();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSortDropdownOpen=_useState2[0],setIsSortDropdownOpen=_useState2[1];var sortKey;var sortOrder;var isNumeric;var queryParams=parseQueryString(qsConfig,location.search);if(queryParams.order_by&&queryParams.order_by.startsWith('-')){sortKey=queryParams.order_by.substr(1);sortOrder='descending';}else if(queryParams.order_by){sortKey=queryParams.order_by;sortOrder='ascending';}if(qsConfig.integerFields.find(function(field){return field===sortKey;})){isNumeric=true;}else{isNumeric=false;}var handleDropdownToggle=function handleDropdownToggle(isOpen){setIsSortDropdownOpen(isOpen);};var handleDropdownSelect=function handleDropdownSelect(_ref2){var target=_ref2.target;var innerText=target.innerText;var _columns$filter=columns.filter(function(_ref3){var name=_ref3.name;return name===innerText;}),_columns$filter2=_slicedToArray(_columns$filter,1),key=_columns$filter2[0].key;sortKey=key;if(qsConfig.integerFields.find(function(field){return field===key;})){isNumeric=true;}else{isNumeric=false;}setIsSortDropdownOpen(false);onSort(sortKey,sortOrder);};var handleSort=function handleSort(){onSort(sortKey,sortOrder==='ascending'?'descending':'ascending');};var up=DropdownPosition.up;var defaultSortedColumn=columns.find(function(_ref4){var key=_ref4.key;return key===sortKey;});if(!defaultSortedColumn){throw new Error('sortKey must match one of the column keys, check the sortColumns prop passed to <Sort />');}var sortedColumnName=defaultSortedColumn===null||defaultSortedColumn===void 0?void 0:defaultSortedColumn.name;var sortDropdownItems=columns.filter(function(_ref5){var key=_ref5.key;return key!==sortKey;}).map(function(_ref6){var key=_ref6.key,name=_ref6.name;return/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",ouiaId:\"\".concat(name,\"-dropdown-item\"),children:name},key);});var SortIcon;if(isNumeric){SortIcon=sortOrder==='ascending'?SortNumericDownIcon:SortNumericDownAltIcon;}else{SortIcon=sortOrder==='ascending'?SortAlphaDownIcon:SortAlphaDownAltIcon;}return/*#__PURE__*/_jsx(_Fragment,{children:sortedColumnName&&/*#__PURE__*/_jsxs(InputGroup,{children:[sortDropdownItems.length>0&&/*#__PURE__*/_jsx(Dropdown,{onToggle:handleDropdownToggle,onSelect:handleDropdownSelect,direction:up,isOpen:isSortDropdownOpen,ouiaId:\"sort-dropdown\",toggle:/*#__PURE__*/_jsx(DropdownToggle,{id:\"awx-sort\",onToggle:handleDropdownToggle,ouiaId:\"sort-dropdown-toggle\",children:sortedColumnName}),dropdownItems:sortDropdownItems})||/*#__PURE__*/_jsx(NoOptionDropdown,{children:sortedColumnName}),/*#__PURE__*/_jsx(Button,{variant:ButtonVariant.control,\"aria-label\":/*i18n*/i18n._(\"Sort\"),onClick:handleSort,ouiaId:\"sort-button\",children:/*#__PURE__*/_jsx(SortIcon,{})})]})});}Sort.defaultProps={onSort:null};export default Sort;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/Sort/Sort.js"],"names":["React","useState","useLocation","Button","ButtonVariant","Dropdown","DropdownPosition","DropdownToggle","DropdownItem","InputGroup","SortAlphaDownIcon","SortAlphaDownAltIcon","SortNumericDownIcon","SortNumericDownAltIcon","styled","parseQueryString","SortColumns","QSConfig","NoOptionDropdown","div","Sort","columns","qsConfig","onSort","location","isSortDropdownOpen","setIsSortDropdownOpen","sortKey","sortOrder","isNumeric","queryParams","search","order_by","startsWith","substr","integerFields","find","field","handleDropdownToggle","isOpen","handleDropdownSelect","target","innerText","filter","name","key","handleSort","up","defaultSortedColumn","Error","sortedColumnName","sortDropdownItems","map","SortIcon","length","control","defaultProps"],"mappings":"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","sourcesContent":["/* eslint-disable react/jsx-no-useless-fragment */\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { useLocation } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport {\n  Button,\n  ButtonVariant,\n  Dropdown,\n  DropdownPosition,\n  DropdownToggle,\n  DropdownItem,\n  InputGroup,\n} from '@patternfly/react-core';\nimport {\n  SortAlphaDownIcon,\n  SortAlphaDownAltIcon,\n  SortNumericDownIcon,\n  SortNumericDownAltIcon,\n} from '@patternfly/react-icons';\n\nimport styled from 'styled-components';\nimport { parseQueryString } from 'util/qs';\nimport { SortColumns, QSConfig } from 'types';\n\nconst NoOptionDropdown = styled.div`\n  align-self: stretch;\n  border: 1px solid var(--pf-global--BorderColor--300);\n  padding: 5px 15px;\n  white-space: nowrap;\n  border-bottom-color: var(--pf-global--BorderColor--200);\n`;\n\nfunction Sort({ columns, qsConfig, onSort }) {\n  const location = useLocation();\n  const [isSortDropdownOpen, setIsSortDropdownOpen] = useState(false);\n\n  let sortKey;\n  let sortOrder;\n  let isNumeric;\n\n  const queryParams = parseQueryString(qsConfig, location.search);\n  if (queryParams.order_by && queryParams.order_by.startsWith('-')) {\n    sortKey = queryParams.order_by.substr(1);\n    sortOrder = 'descending';\n  } else if (queryParams.order_by) {\n    sortKey = queryParams.order_by;\n    sortOrder = 'ascending';\n  }\n\n  if (qsConfig.integerFields.find((field) => field === sortKey)) {\n    isNumeric = true;\n  } else {\n    isNumeric = false;\n  }\n\n  const handleDropdownToggle = (isOpen) => {\n    setIsSortDropdownOpen(isOpen);\n  };\n\n  const handleDropdownSelect = ({ target }) => {\n    const { innerText } = target;\n\n    const [{ key }] = columns.filter(({ name }) => name === innerText);\n    sortKey = key;\n    if (qsConfig.integerFields.find((field) => field === key)) {\n      isNumeric = true;\n    } else {\n      isNumeric = false;\n    }\n\n    setIsSortDropdownOpen(false);\n    onSort(sortKey, sortOrder);\n  };\n\n  const handleSort = () => {\n    onSort(sortKey, sortOrder === 'ascending' ? 'descending' : 'ascending');\n  };\n\n  const { up } = DropdownPosition;\n\n  const defaultSortedColumn = columns.find(({ key }) => key === sortKey);\n\n  if (!defaultSortedColumn) {\n    throw new Error(\n      'sortKey must match one of the column keys, check the sortColumns prop passed to <Sort />'\n    );\n  }\n\n  const sortedColumnName = defaultSortedColumn?.name;\n\n  const sortDropdownItems = columns\n    .filter(({ key }) => key !== sortKey)\n    .map(({ key, name }) => (\n      <DropdownItem\n        key={key}\n        component=\"button\"\n        ouiaId={`${name}-dropdown-item`}\n      >\n        {name}\n      </DropdownItem>\n    ));\n\n  let SortIcon;\n  if (isNumeric) {\n    SortIcon =\n      sortOrder === 'ascending' ? SortNumericDownIcon : SortNumericDownAltIcon;\n  } else {\n    SortIcon =\n      sortOrder === 'ascending' ? SortAlphaDownIcon : SortAlphaDownAltIcon;\n  }\n  return (\n    <>\n      {sortedColumnName && (\n        <InputGroup>\n          {(sortDropdownItems.length > 0 && (\n            <Dropdown\n              onToggle={handleDropdownToggle}\n              onSelect={handleDropdownSelect}\n              direction={up}\n              isOpen={isSortDropdownOpen}\n              ouiaId=\"sort-dropdown\"\n              toggle={\n                <DropdownToggle\n                  id=\"awx-sort\"\n                  onToggle={handleDropdownToggle}\n                  ouiaId=\"sort-dropdown-toggle\"\n                >\n                  {sortedColumnName}\n                </DropdownToggle>\n              }\n              dropdownItems={sortDropdownItems}\n            />\n          )) || <NoOptionDropdown>{sortedColumnName}</NoOptionDropdown>}\n\n          <Button\n            variant={ButtonVariant.control}\n            aria-label={t`Sort`}\n            onClick={handleSort}\n            ouiaId=\"sort-button\"\n          >\n            <SortIcon />\n          </Button>\n        </InputGroup>\n      )}\n    </>\n  );\n}\n\nSort.propTypes = {\n  qsConfig: QSConfig.isRequired,\n  columns: SortColumns.isRequired,\n  onSort: PropTypes.func,\n};\n\nSort.defaultProps = {\n  onSort: null,\n};\n\nexport default Sort;\n"]},"metadata":{},"sourceType":"module"}