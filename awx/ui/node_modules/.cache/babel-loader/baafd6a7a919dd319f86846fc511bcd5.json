{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Switch,Route,Redirect,Link,useRouteMatch,useLocation}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{UsersAPI}from'api';import ContentError from'components/ContentError';import RoutedTabs from'components/RoutedTabs';import UserDetail from'./UserDetail';import UserEdit from'./UserEdit';import UserOrganizations from'./UserOrganizations';import UserTeams from'./UserTeams';import UserTokens from'./UserTokens';import UserRolesList from'./UserRoles/UserRolesList';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function User(_ref){var setBreadcrumb=_ref.setBreadcrumb,me=_ref.me;var location=useLocation();var match=useRouteMatch('/users/:id');var userListUrl=\"/users\";var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$UsersAPI$readD,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return UsersAPI.readDetail(match.params.id);case 2:_yield$UsersAPI$readD=_context.sent;data=_yield$UsersAPI$readD.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[match.params.id]),null),user=_useRequest.result,contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchUser=_useRequest.request;useEffect(function(){fetchUser();},[fetchUser,location.pathname]);useEffect(function(){if(user){setBreadcrumb(user);}},[user,setBreadcrumb]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Users\")]}),link:\"/users\",id:99,isBackButton:true},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(match.url,\"/details\"),id:0},{name:/*i18n*/i18n._(\"Organizations\"),link:\"\".concat(match.url,\"/organizations\"),id:1},{name:/*i18n*/i18n._(\"Teams\"),link:\"\".concat(match.url,\"/teams\"),id:2},{name:/*i18n*/i18n._(\"Roles\"),link:\"\".concat(match.url,\"/roles\"),id:3}];if((me===null||me===void 0?void 0:me.id)===Number(match.params.id)){tabsArray.push({name:/*i18n*/i18n._(\"Tokens\"),link:\"\".concat(match.url,\"/tokens\"),id:4});}var showCardHeader=true;if(['edit','add','tokens/'].some(function(name){return location.pathname.includes(name);})){showCardHeader=false;}if(!isLoading&&contentError){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:contentError,children:contentError.response&&contentError.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"User not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:userListUrl,children:/*i18n*/i18n._(\"View all Users.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/users/:id\",to:\"/users/:id/details\",exact:true}),user&&[/*#__PURE__*/_jsx(Route,{path:\"/users/:id/edit\",children:/*#__PURE__*/_jsx(UserEdit,{user:user})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/details\",children:/*#__PURE__*/_jsx(UserDetail,{user:user})},\"details\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/organizations\",children:/*#__PURE__*/_jsx(UserOrganizations,{id:Number(match.params.id)})},\"organizations\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/teams\",children:/*#__PURE__*/_jsx(UserTeams,{})},\"teams\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/roles\",children:/*#__PURE__*/_jsx(UserRolesList,{user:user})},\"roles\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/tokens\",children:/*#__PURE__*/_jsx(UserTokens,{user:user,setBreadcrumb:setBreadcrumb,id:Number(match.params.id)})},\"tokens\")],/*#__PURE__*/_jsx(Route,{path:\"*\",children:!isLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:match.params.id&&/*#__PURE__*/_jsx(Link,{to:\"/users/\".concat(match.params.id,\"/details\"),children:/*i18n*/i18n._(\"View User Details\")})})},\"not-found\")]})]})});}export default User;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/User/User.js"],"names":["React","useEffect","useCallback","Switch","Route","Redirect","Link","useRouteMatch","useLocation","CaretLeftIcon","Card","PageSection","useRequest","UsersAPI","ContentError","RoutedTabs","UserDetail","UserEdit","UserOrganizations","UserTeams","UserTokens","UserRolesList","User","setBreadcrumb","me","location","match","userListUrl","readDetail","params","id","data","user","result","contentError","error","isLoading","fetchUser","request","pathname","tabsArray","name","link","isBackButton","url","Number","push","showCardHeader","some","includes","response","status"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from 'react';\n\nimport { t } from '@lingui/macro';\nimport {\n  Switch,\n  Route,\n  Redirect,\n  Link,\n  useRouteMatch,\n  useLocation,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport useRequest from 'hooks/useRequest';\nimport { UsersAPI } from 'api';\nimport ContentError from 'components/ContentError';\nimport RoutedTabs from 'components/RoutedTabs';\nimport UserDetail from './UserDetail';\nimport UserEdit from './UserEdit';\nimport UserOrganizations from './UserOrganizations';\nimport UserTeams from './UserTeams';\nimport UserTokens from './UserTokens';\nimport UserRolesList from './UserRoles/UserRolesList';\n\nfunction User({ setBreadcrumb, me }) {\n  const location = useLocation();\n  const match = useRouteMatch('/users/:id');\n  const userListUrl = `/users`;\n  const {\n    result: user,\n    error: contentError,\n    isLoading,\n    request: fetchUser,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await UsersAPI.readDetail(match.params.id);\n      return data;\n    }, [match.params.id]),\n    null\n  );\n\n  useEffect(() => {\n    fetchUser();\n  }, [fetchUser, location.pathname]);\n\n  useEffect(() => {\n    if (user) {\n      setBreadcrumb(user);\n    }\n  }, [user, setBreadcrumb]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Users`}\n        </>\n      ),\n      link: `/users`,\n      id: 99,\n      isBackButton: true,\n    },\n    { name: t`Details`, link: `${match.url}/details`, id: 0 },\n    {\n      name: t`Organizations`,\n      link: `${match.url}/organizations`,\n      id: 1,\n    },\n    { name: t`Teams`, link: `${match.url}/teams`, id: 2 },\n    { name: t`Roles`, link: `${match.url}/roles`, id: 3 },\n  ];\n\n  if (me?.id === Number(match.params.id)) {\n    tabsArray.push({\n      name: t`Tokens`,\n      link: `${match.url}/tokens`,\n      id: 4,\n    });\n  }\n\n  let showCardHeader = true;\n  if (\n    ['edit', 'add', 'tokens/'].some((name) => location.pathname.includes(name))\n  ) {\n    showCardHeader = false;\n  }\n\n  if (!isLoading && contentError) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={contentError}>\n            {contentError.response && contentError.response.status === 404 && (\n              <span>\n                {t`User not found.`}{' '}\n                <Link to={userListUrl}>{t`View all Users.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n        <Switch>\n          <Redirect from=\"/users/:id\" to=\"/users/:id/details\" exact />\n          {user && [\n            <Route path=\"/users/:id/edit\" key=\"edit\">\n              <UserEdit user={user} />\n            </Route>,\n            <Route path=\"/users/:id/details\" key=\"details\">\n              <UserDetail user={user} />\n            </Route>,\n            <Route path=\"/users/:id/organizations\" key=\"organizations\">\n              <UserOrganizations id={Number(match.params.id)} />\n            </Route>,\n            <Route path=\"/users/:id/teams\" key=\"teams\">\n              <UserTeams />\n            </Route>,\n            <Route path=\"/users/:id/roles\" key=\"roles\">\n              <UserRolesList user={user} />\n            </Route>,\n            <Route path=\"/users/:id/tokens\" key=\"tokens\">\n              <UserTokens\n                user={user}\n                setBreadcrumb={setBreadcrumb}\n                id={Number(match.params.id)}\n              />\n            </Route>,\n          ]}\n          <Route key=\"not-found\" path=\"*\">\n            {!isLoading && (\n              <ContentError isNotFound>\n                {match.params.id && (\n                  <Link to={`/users/${match.params.id}/details`}>\n                    {t`View User Details`}\n                  </Link>\n                )}\n              </ContentError>\n            )}\n          </Route>\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default User;\n"]},"metadata":{},"sourceType":"module"}