{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState,useEffect,useCallback}from'react';import{useHistory,Link}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import{CardBody}from'components/Card';import{NotificationTemplatesAPI}from'api';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import NotificationTemplateForm from'./shared/NotificationTemplateForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NotificationTemplateAdd(){var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),formError=_useState2[0],setFormError=_useState2[1];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$NotificationTe,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return NotificationTemplatesAPI.readOptions();case 2:_yield$NotificationTe=_context.sent;data=_yield$NotificationTe.data;return _context.abrupt(\"return\",data.actions.POST.messages);case 5:case\"end\":return _context.stop();}}},_callee);})),[])),defaultMessages=_useRequest.result,error=_useRequest.error,fetchDefaultMessages=_useRequest.request;useEffect(function(){fetchDefaultMessages();},[fetchDefaultMessages]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){var _yield$NotificationTe2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return NotificationTemplatesAPI.create(values);case 3:_yield$NotificationTe2=_context2.sent;data=_yield$NotificationTe2.data;history.push(\"/notification_templates/\".concat(data.id));_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setFormError(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push('/notification_templates');};if(error){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:error.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Notification Template not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/notification_templates\",children:/*i18n*/i18n._(\"View all Notification Templates.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:defaultMessages&&/*#__PURE__*/_jsx(NotificationTemplateForm,{defaultMessages:defaultMessages,onSubmit:handleSubmit,onCancel:handleCancel,submitError:formError})})})});}export{NotificationTemplateAdd as _NotificationTemplateAdd};export default NotificationTemplateAdd;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/NotificationTemplate/NotificationTemplateAdd.js"],"names":["React","useState","useEffect","useCallback","useHistory","Link","Card","PageSection","CardBody","NotificationTemplatesAPI","useRequest","ContentError","NotificationTemplateForm","NotificationTemplateAdd","history","formError","setFormError","readOptions","data","actions","POST","messages","defaultMessages","result","error","fetchDefaultMessages","request","handleSubmit","values","create","push","id","handleCancel","response","status","_NotificationTemplateAdd"],"mappings":"uVAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CACA,OAASC,UAAT,CAAqBC,IAArB,KAAiC,kBAAjC,CAGA,OAASC,IAAT,CAAeC,WAAf,KAAkC,wBAAlC,CACA,OAASC,QAAT,KAAyB,iBAAzB,CACA,OAASC,wBAAT,KAAyC,KAAzC,CACA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,yBAAzB,CACA,MAAOC,CAAAA,wBAAP,KAAqC,mCAArC,C,wFAEA,QAASC,CAAAA,uBAAT,EAAmC,CACjC,GAAMC,CAAAA,OAAO,CAAGV,UAAU,EAA1B,CACA,cAAkCH,QAAQ,CAAC,IAAD,CAA1C,wCAAOc,SAAP,eAAkBC,YAAlB,eACA,gBAIIN,UAAU,CACZP,WAAW,sEAAC,wLACaM,CAAAA,wBAAwB,CAACQ,WAAzB,EADb,4CACFC,IADE,uBACFA,IADE,iCAEHA,IAAI,CAACC,OAAL,CAAaC,IAAb,CAAkBC,QAFf,wDAAD,GAGR,EAHQ,CADC,CAJd,CACUC,eADV,aACEC,MADF,CAEEC,KAFF,aAEEA,KAFF,CAGWC,oBAHX,aAGEC,OAHF,CAWAxB,SAAS,CAAC,UAAM,CACduB,oBAAoB,GACrB,CAFQ,CAEN,CAACA,oBAAD,CAFM,CAAT,CAIA,GAAME,CAAAA,YAAY,2FAAG,kBAAOC,MAAP,8LAEMnB,CAAAA,wBAAwB,CAACoB,MAAzB,CAAgCD,MAAhC,CAFN,8CAETV,IAFS,wBAETA,IAFS,CAGjBJ,OAAO,CAACgB,IAAR,mCAAwCZ,IAAI,CAACa,EAA7C,GAHiB,mFAKjBf,YAAY,cAAZ,CALiB,sEAAH,kBAAZW,CAAAA,YAAY,6CAAlB,CASA,GAAMK,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBlB,OAAO,CAACgB,IAAR,CAAa,yBAAb,EACD,CAFD,CAIA,GAAIN,KAAJ,CAAW,CACT,mBACE,KAAC,WAAD,wBACE,KAAC,IAAD,wBACE,KAAC,YAAD,EAAc,KAAK,CAAEA,KAArB,UACGA,KAAK,CAACS,QAAN,CAAeC,MAAf,GAA0B,GAA1B,eACC,gCACG,0CADH,CACwC,GADxC,cAEE,KAAC,IAAD,EAAM,EAAE,CAAC,yBAAT,kBACG,0CADH,EAFF,GAFJ,EADF,EADF,EADF,CAgBD,CAED,mBACE,KAAC,WAAD,wBACE,KAAC,IAAD,wBACE,KAAC,QAAD,WACGZ,eAAe,eACd,KAAC,wBAAD,EACE,eAAe,CAAEA,eADnB,CAEE,QAAQ,CAAEK,YAFZ,CAGE,QAAQ,CAAEK,YAHZ,CAIE,WAAW,CAAEjB,SAJf,EAFJ,EADF,EADF,EADF,CAgBD,CAED,OAASF,uBAAuB,GAAIsB,CAAAA,wBAApC,EACA,cAAetB,CAAAA,uBAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { CardBody } from 'components/Card';\nimport { NotificationTemplatesAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport NotificationTemplateForm from './shared/NotificationTemplateForm';\n\nfunction NotificationTemplateAdd() {\n  const history = useHistory();\n  const [formError, setFormError] = useState(null);\n  const {\n    result: defaultMessages,\n    error,\n    request: fetchDefaultMessages,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await NotificationTemplatesAPI.readOptions();\n      return data.actions.POST.messages;\n    }, [])\n  );\n\n  useEffect(() => {\n    fetchDefaultMessages();\n  }, [fetchDefaultMessages]);\n\n  const handleSubmit = async (values) => {\n    try {\n      const { data } = await NotificationTemplatesAPI.create(values);\n      history.push(`/notification_templates/${data.id}`);\n    } catch (err) {\n      setFormError(err);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push('/notification_templates');\n  };\n\n  if (error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response.status === 404 && (\n              <span>\n                {t`Notification Template not found.`}{' '}\n                <Link to=\"/notification_templates\">\n                  {t`View all Notification Templates.`}\n                </Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        <CardBody>\n          {defaultMessages && (\n            <NotificationTemplateForm\n              defaultMessages={defaultMessages}\n              onSubmit={handleSubmit}\n              onCancel={handleCancel}\n              submitError={formError}\n            />\n          )}\n        </CardBody>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport { NotificationTemplateAdd as _NotificationTemplateAdd };\nexport default NotificationTemplateAdd;\n"]},"metadata":{},"sourceType":"module"}