{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{Link,useHistory}from'react-router-dom';import{Button,Chip}from'@patternfly/react-core';import AlertModal from'components/AlertModal';import{CardBody,CardActionsRow}from'components/Card';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import DeleteButton from'components/DeleteButton';import ErrorDetail from'components/ErrorDetail';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import ChipGroup from'components/ChipGroup';import{InventoriesAPI}from'api';import useRequest,{useDismissableError}from'hooks/useRequest';import{Inventory}from'types';import{relatedResourceDeleteRequests}from'util/getRelatedResourceDeleteDetails';import helpText from'../shared/Inventory.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function InventoryDetail(_ref){var _inventory$summary_fi2,_inventory$summary_fi3,_inventory$summary_fi4,_inventory$summary_fi5,_inventory$summary_fi6,_inventory$summary_fi7;var inventory=_ref.inventory;var history=useHistory();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InventoriesAPI,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InventoriesAPI.readInstanceGroups(inventory.id);case 2:_yield$InventoriesAPI=_context.sent;data=_yield$InventoriesAPI.data;return _context.abrupt(\"return\",data.results);case 5:case\"end\":return _context.stop();}}},_callee);})),[inventory.id]),[]),instanceGroups=_useRequest.result,isLoading=_useRequest.isLoading,instanceGroupsError=_useRequest.error,fetchInstanceGroups=_useRequest.request;useEffect(function(){fetchInstanceGroups();},[fetchInstanceGroups]);var _useRequest2=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return InventoriesAPI.destroy(inventory.id);case 2:history.push(\"/inventories\");case 3:case\"end\":return _context2.stop();}}},_callee2);})),[inventory.id,history])),deleteInventory=_useRequest2.request,deleteError=_useRequest2.error;var _useDismissableError=useDismissableError(deleteError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var _inventory$summary_fi=inventory.summary_fields,organization=_inventory$summary_fi.organization,userCapabilities=_inventory$summary_fi.user_capabilities;var deleteDetailsRequests=relatedResourceDeleteRequests.inventory(inventory);if(isLoading){return/*#__PURE__*/_jsx(ContentLoading,{});}if(instanceGroupsError){return/*#__PURE__*/_jsx(ContentError,{error:instanceGroupsError});}return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:inventory.name,dataCy:\"inventory-detail-name\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:inventory.description}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Type\"),value:/*i18n*/i18n._(\"Inventory\")}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Organization\"),value:/*#__PURE__*/_jsx(Link,{to:\"/organizations/\".concat(organization.id,\"/details\"),children:organization.name})}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Total hosts\"),value:inventory.total_hosts}),instanceGroups&&/*#__PURE__*/_jsx(Detail,{fullWidth:true,label:/*i18n*/i18n._(\"Instance Groups\"),value:/*#__PURE__*/_jsx(ChipGroup,{numChips:5,totalChips:instanceGroups===null||instanceGroups===void 0?void 0:instanceGroups.length,ouiaId:\"instance-group-chips\",children:instanceGroups===null||instanceGroups===void 0?void 0:instanceGroups.map(function(ig){return/*#__PURE__*/_jsx(Chip,{isReadOnly:true,ouiaId:\"instance-group-\".concat(ig.id,\"-chip\"),children:ig.name},ig.id);})}),isEmpty:instanceGroups.length===0}),inventory.summary_fields.labels&&/*#__PURE__*/_jsx(Detail,{fullWidth:true,helpText:helpText.labels,label:/*i18n*/i18n._(\"Labels\"),value:/*#__PURE__*/_jsx(ChipGroup,{numChips:5,totalChips:(_inventory$summary_fi2=inventory.summary_fields.labels)===null||_inventory$summary_fi2===void 0?void 0:(_inventory$summary_fi3=_inventory$summary_fi2.results)===null||_inventory$summary_fi3===void 0?void 0:_inventory$summary_fi3.length,children:(_inventory$summary_fi4=inventory.summary_fields.labels)===null||_inventory$summary_fi4===void 0?void 0:(_inventory$summary_fi5=_inventory$summary_fi4.results)===null||_inventory$summary_fi5===void 0?void 0:_inventory$summary_fi5.map(function(l){return/*#__PURE__*/_jsx(Chip,{isReadOnly:true,children:l.name},l.id);})}),isEmpty:((_inventory$summary_fi6=inventory.summary_fields.labels)===null||_inventory$summary_fi6===void 0?void 0:(_inventory$summary_fi7=_inventory$summary_fi6.results)===null||_inventory$summary_fi7===void 0?void 0:_inventory$summary_fi7.length)===0}),/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Variables\"),helpText:helpText.variables(),value:inventory.variables,rows:4,name:\"variables\",dataCy:\"inventory-detail-variables\"}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Created\"),date:inventory.created,user:inventory.summary_fields.created_by}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Last Modified\"),date:inventory.modified,user:inventory.summary_fields.modified_by})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[userCapabilities.edit&&/*#__PURE__*/_jsx(Button,{ouiaId:\"inventory-detail-edit-button\",component:Link,to:\"/inventories/inventory/\".concat(inventory.id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),userCapabilities.delete&&/*#__PURE__*/_jsx(DeleteButton,{name:inventory.name,modalTitle:/*i18n*/i18n._(\"Delete Inventory\"),onConfirm:deleteInventory,deleteDetailsRequests:deleteDetailsRequests,deleteMessage:/*i18n*/i18n._(\"This inventory is currently being used by other resources. Are you sure you want to delete it?\"),children:/*i18n*/i18n._(\"Delete\")})]}),error&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to delete inventory.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:error})]})]});}export default InventoryDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventoryDetail/InventoryDetail.js"],"names":["React","useCallback","useEffect","Link","useHistory","Button","Chip","AlertModal","CardBody","CardActionsRow","DetailList","Detail","UserDateDetail","VariablesDetail","DeleteButton","ErrorDetail","ContentError","ContentLoading","ChipGroup","InventoriesAPI","useRequest","useDismissableError","Inventory","relatedResourceDeleteRequests","helpText","InventoryDetail","inventory","history","readInstanceGroups","id","data","results","instanceGroups","result","isLoading","instanceGroupsError","error","fetchInstanceGroups","request","destroy","push","deleteInventory","deleteError","dismissError","summary_fields","organization","userCapabilities","user_capabilities","deleteDetailsRequests","name","description","total_hosts","length","map","ig","labels","l","variables","created","created_by","modified","modified_by","edit","delete"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button, Chip } from '@patternfly/react-core';\nimport AlertModal from 'components/AlertModal';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport DeleteButton from 'components/DeleteButton';\nimport ErrorDetail from 'components/ErrorDetail';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport ChipGroup from 'components/ChipGroup';\nimport { InventoriesAPI } from 'api';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport { Inventory } from 'types';\nimport { relatedResourceDeleteRequests } from 'util/getRelatedResourceDeleteDetails';\nimport helpText from '../shared/Inventory.helptext';\n\nfunction InventoryDetail({ inventory }) {\n  const history = useHistory();\n  const {\n    result: instanceGroups,\n    isLoading,\n    error: instanceGroupsError,\n    request: fetchInstanceGroups,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await InventoriesAPI.readInstanceGroups(inventory.id);\n      return data.results;\n    }, [inventory.id]),\n    []\n  );\n\n  useEffect(() => {\n    fetchInstanceGroups();\n  }, [fetchInstanceGroups]);\n\n  const { request: deleteInventory, error: deleteError } = useRequest(\n    useCallback(async () => {\n      await InventoriesAPI.destroy(inventory.id);\n      history.push(`/inventories`);\n    }, [inventory.id, history])\n  );\n\n  const { error, dismissError } = useDismissableError(deleteError);\n\n  const { organization, user_capabilities: userCapabilities } =\n    inventory.summary_fields;\n\n  const deleteDetailsRequests =\n    relatedResourceDeleteRequests.inventory(inventory);\n\n  if (isLoading) {\n    return <ContentLoading />;\n  }\n\n  if (instanceGroupsError) {\n    return <ContentError error={instanceGroupsError} />;\n  }\n\n  return (\n    <CardBody>\n      <DetailList>\n        <Detail\n          label={t`Name`}\n          value={inventory.name}\n          dataCy=\"inventory-detail-name\"\n        />\n        <Detail label={t`Description`} value={inventory.description} />\n        <Detail label={t`Type`} value={t`Inventory`} />\n        <Detail\n          label={t`Organization`}\n          value={\n            <Link to={`/organizations/${organization.id}/details`}>\n              {organization.name}\n            </Link>\n          }\n        />\n        <Detail label={t`Total hosts`} value={inventory.total_hosts} />\n        {instanceGroups && (\n          <Detail\n            fullWidth\n            label={t`Instance Groups`}\n            value={\n              <ChipGroup\n                numChips={5}\n                totalChips={instanceGroups?.length}\n                ouiaId=\"instance-group-chips\"\n              >\n                {instanceGroups?.map((ig) => (\n                  <Chip\n                    key={ig.id}\n                    isReadOnly\n                    ouiaId={`instance-group-${ig.id}-chip`}\n                  >\n                    {ig.name}\n                  </Chip>\n                ))}\n              </ChipGroup>\n            }\n            isEmpty={instanceGroups.length === 0}\n          />\n        )}\n        {inventory.summary_fields.labels && (\n          <Detail\n            fullWidth\n            helpText={helpText.labels}\n            label={t`Labels`}\n            value={\n              <ChipGroup\n                numChips={5}\n                totalChips={inventory.summary_fields.labels?.results?.length}\n              >\n                {inventory.summary_fields.labels?.results?.map((l) => (\n                  <Chip key={l.id} isReadOnly>\n                    {l.name}\n                  </Chip>\n                ))}\n              </ChipGroup>\n            }\n            isEmpty={inventory.summary_fields.labels?.results?.length === 0}\n          />\n        )}\n        <VariablesDetail\n          label={t`Variables`}\n          helpText={helpText.variables()}\n          value={inventory.variables}\n          rows={4}\n          name=\"variables\"\n          dataCy=\"inventory-detail-variables\"\n        />\n        <UserDateDetail\n          label={t`Created`}\n          date={inventory.created}\n          user={inventory.summary_fields.created_by}\n        />\n        <UserDateDetail\n          label={t`Last Modified`}\n          date={inventory.modified}\n          user={inventory.summary_fields.modified_by}\n        />\n      </DetailList>\n      <CardActionsRow>\n        {userCapabilities.edit && (\n          <Button\n            ouiaId=\"inventory-detail-edit-button\"\n            component={Link}\n            to={`/inventories/inventory/${inventory.id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {userCapabilities.delete && (\n          <DeleteButton\n            name={inventory.name}\n            modalTitle={t`Delete Inventory`}\n            onConfirm={deleteInventory}\n            deleteDetailsRequests={deleteDetailsRequests}\n            deleteMessage={t`This inventory is currently being used by other resources. Are you sure you want to delete it?`}\n          >\n            {t`Delete`}\n          </DeleteButton>\n        )}\n      </CardActionsRow>\n      {/* Update delete modal to show dependencies https://github.com/ansible/awx/issues/5546 */}\n      {error && (\n        <AlertModal\n          isOpen={error}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissError}\n        >\n          {t`Failed to delete inventory.`}\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\nInventoryDetail.propTypes = {\n  inventory: Inventory.isRequired,\n};\n\nexport default InventoryDetail;\n"]},"metadata":{},"sourceType":"module"}