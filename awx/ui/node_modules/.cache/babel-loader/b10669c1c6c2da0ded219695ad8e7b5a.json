{"ast":null,"code":"import _toConsumableArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{useLocation,useParams}from'react-router-dom';import{getQSConfig,parseQueryString}from'util/qs';import PaginatedTable,{HeaderRow,HeaderCell,ToolbarAddButton,ToolbarDeleteButton,getSearchableKeys}from'components/PaginatedTable';import useSelected from'hooks/useSelected';import useRequest,{useDeleteItems}from'hooks/useRequest';import{UsersAPI,TokensAPI}from'api';import DataListToolbar from'components/DataListToolbar';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import UserTokensListItem from'./UserTokenListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('user',{page:1,page_size:20,order_by:'application__name'});function UserTokenList(){var location=useLocation();var _useParams=useParams(),id=_useParams.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _actionsResponse$data,_actionsResponse$data2;var params,_yield$Promise$all,_yield$Promise$all2,_yield$Promise$all2$,results,count,actionsResponse,modifiedResults;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([UsersAPI.readTokens(id,params),UsersAPI.readTokenOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);_yield$Promise$all2$=_yield$Promise$all2[0].data;results=_yield$Promise$all2$.results;count=_yield$Promise$all2$.count;actionsResponse=_yield$Promise$all2[1];modifiedResults=results.map(function(result){var _result$summary_field;result.summary_fields={user:result.summary_fields.user,application:result.summary_fields.application,user_capabilities:{delete:true}};result.name=(_result$summary_field=result.summary_fields.application)===null||_result$summary_field===void 0?void 0:_result$summary_field.name;return result;});return _context.abrupt(\"return\",{tokens:modifiedResults,itemCount:count,relatedSearchableKeys:((actionsResponse===null||actionsResponse===void 0?void 0:(_actionsResponse$data=actionsResponse.data)===null||_actionsResponse$data===void 0?void 0:_actionsResponse$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_actionsResponse$data2=actionsResponse.data.actions)===null||_actionsResponse$data2===void 0?void 0:_actionsResponse$data2.GET)});case 11:case\"end\":return _context.stop();}}},_callee);})),[id,location.search]),{tokens:[],itemCount:0,relatedSearchableKeys:[],searchableKeys:[]}),error=_useRequest.error,isLoading=_useRequest.isLoading,fetchTokens=_useRequest.request,_useRequest$result=_useRequest.result,tokens=_useRequest$result.tokens,itemCount=_useRequest$result.itemCount,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys;useEffect(function(){fetchTokens();},[fetchTokens]);var _useSelected=useSelected(tokens),selected=_useSelected.selected,isAllSelected=_useSelected.isAllSelected,handleSelect=_useSelected.handleSelect,clearSelected=_useSelected.clearSelected,selectAll=_useSelected.selectAll;var _useDeleteItems=useDeleteItems(useCallback(function(){return Promise.all(selected.map(function(_ref2){var tokenId=_ref2.id;return TokensAPI.destroy(tokenId);}));},[selected]),{qsConfig:QS_CONFIG,allItemsSelected:isAllSelected,fetchItems:fetchTokens}),isDeleteLoading=_useDeleteItems.isLoading,deleteTokens=_useDeleteItems.deleteItems,deletionError=_useDeleteItems.deletionError,clearDeletionError=_useDeleteItems.clearDeletionError;var handleDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteTokens();case 2:clearSelected();case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDelete(){return _ref3.apply(this,arguments);};}();var canAdd=true;var modifiedSelected=selected.map(function(item){if(item.application===null){return _objectSpread(_objectSpread({},item),{},{name:/*i18n*/i18n._(\"Personal Access Token\")});}return item;});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PaginatedTable,{contentError:error,hasContentLoading:isLoading||isDeleteLoading,items:tokens,itemCount:itemCount,pluralizedItemName:/*i18n*/i18n._(\"Tokens\"),qsConfig:QS_CONFIG,clearSelected:clearSelected,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Application name\"),key:'application__name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Description\"),key:'description__icontains'}],toolbarSortColumns:[{name:/*i18n*/i18n._(\"Application name\"),key:'application__name'},{name:/*i18n*/i18n._(\"Description\"),key:'description'},{name:/*i18n*/i18n._(\"Scope\"),key:'scope'},{name:/*i18n*/i18n._(\"Expires\"),key:'expires'},{name:/*i18n*/i18n._(\"Created\"),key:'created'},{name:/*i18n*/i18n._(\"Modified\"),key:'modified'}],toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DataListToolbar,_objectSpread(_objectSpread({},props),{},{isAllSelected:isAllSelected,qsConfig:QS_CONFIG,onSelectAll:selectAll,additionalControls:[].concat(_toConsumableArray(canAdd?[/*#__PURE__*/_jsx(ToolbarAddButton,{linkTo:\"\".concat(location.pathname,\"/add\")},\"add\")]:[]),[/*#__PURE__*/_jsx(ToolbarDeleteButton,{ouiaId:\"user-token-delete-button\",onDelete:handleDelete,itemsToDelete:modifiedSelected,pluralizedItemName:/*i18n*/i18n._(\"User tokens\")},\"delete\")])}));},headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"application__name\",children:/*i18n*/i18n._(\"Application Name\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"description\",children:/*i18n*/i18n._(\"Description\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"scope\",children:/*i18n*/i18n._(\"Scope\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"expires\",children:/*i18n*/i18n._(\"Expires\")})]}),renderRow:function renderRow(token,index){return/*#__PURE__*/_jsx(UserTokensListItem,{token:token,onSelect:function onSelect(){handleSelect(token);},isSelected:selected.some(function(row){return row.id===token.id;}),rowIndex:index},token.id);},emptyStateControls:canAdd?/*#__PURE__*/_jsx(ToolbarAddButton,{linkTo:\"\".concat(location.pathname,\"/add\")},\"add\"):null}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"danger\",title:/*i18n*/i18n._(\"Error!\"),onClose:clearDeletionError,children:[/*i18n*/i18n._(\"Failed to delete one or more user tokens.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default UserTokenList;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/User/UserTokenList/UserTokenList.js"],"names":["React","useCallback","useEffect","useLocation","useParams","getQSConfig","parseQueryString","PaginatedTable","HeaderRow","HeaderCell","ToolbarAddButton","ToolbarDeleteButton","getSearchableKeys","useSelected","useRequest","useDeleteItems","UsersAPI","TokensAPI","DataListToolbar","AlertModal","ErrorDetail","UserTokensListItem","QS_CONFIG","page","page_size","order_by","UserTokenList","location","id","params","search","Promise","all","readTokens","readTokenOptions","data","results","count","actionsResponse","modifiedResults","map","result","summary_fields","user","application","user_capabilities","delete","name","tokens","itemCount","relatedSearchableKeys","related_search_fields","val","slice","searchableKeys","actions","GET","error","isLoading","fetchTokens","request","selected","isAllSelected","handleSelect","clearSelected","selectAll","tokenId","destroy","qsConfig","allItemsSelected","fetchItems","isDeleteLoading","deleteTokens","deleteItems","deletionError","clearDeletionError","handleDelete","canAdd","modifiedSelected","item","key","isDefault","props","pathname","token","index","some","row"],"mappings":"4iBAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,SAA7B,KAA8C,OAA9C,CACA,OAASC,WAAT,CAAsBC,SAAtB,KAAuC,kBAAvC,CAGA,OAASC,WAAT,CAAsBC,gBAAtB,KAA8C,SAA9C,CACA,MAAOC,CAAAA,cAAP,EACEC,SADF,CAEEC,UAFF,CAGEC,gBAHF,CAIEC,mBAJF,CAKEC,iBALF,KAMO,2BANP,CAOA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CACA,MAAOC,CAAAA,UAAP,EAAqBC,cAArB,KAA2C,kBAA3C,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,KAApC,CACA,MAAOC,CAAAA,eAAP,KAA4B,4BAA5B,CACA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,qBAA/B,C,6IAEA,GAAMC,CAAAA,SAAS,CAAGjB,WAAW,CAAC,MAAD,CAAS,CACpCkB,IAAI,CAAE,CAD8B,CAEpCC,SAAS,CAAE,EAFyB,CAGpCC,QAAQ,CAAE,mBAH0B,CAAT,CAA7B,CAKA,QAASC,CAAAA,aAAT,EAAyB,CACvB,GAAMC,CAAAA,QAAQ,CAAGxB,WAAW,EAA5B,CACA,eAAeC,SAAS,EAAxB,CAAQwB,EAAR,YAAQA,EAAR,CAEA,gBAKId,UAAU,CACZb,WAAW,sEAAC,ySACJ4B,MADI,CACKvB,gBAAgB,CAACgB,SAAD,CAAYK,QAAQ,CAACG,MAArB,CADrB,uBAOAC,CAAAA,OAAO,CAACC,GAAR,CAAY,CACpBhB,QAAQ,CAACiB,UAAT,CAAoBL,EAApB,CAAwBC,MAAxB,CADoB,CAEpBb,QAAQ,CAACkB,gBAAT,CAA0BN,EAA1B,CAFoB,CAAZ,CAPA,8IAINO,IAJM,CAIEC,OAJF,sBAIEA,OAJF,CAIWC,KAJX,sBAIWA,KAJX,CAMRC,eANQ,wBAWJC,eAXI,CAWcH,OAAO,CAACI,GAAR,CAAY,SAACC,MAAD,CAAY,2BAC9CA,MAAM,CAACC,cAAP,CAAwB,CACtBC,IAAI,CAAEF,MAAM,CAACC,cAAP,CAAsBC,IADN,CAEtBC,WAAW,CAAEH,MAAM,CAACC,cAAP,CAAsBE,WAFb,CAGtBC,iBAAiB,CAAE,CAAEC,MAAM,CAAE,IAAV,CAHG,CAAxB,CAKAL,MAAM,CAACM,IAAP,wBAAcN,MAAM,CAACC,cAAP,CAAsBE,WAApC,gDAAc,sBAAmCG,IAAjD,CACA,MAAON,CAAAA,MAAP,CACD,CARuB,CAXd,iCAoBH,CACLO,MAAM,CAAET,eADH,CAELU,SAAS,CAAEZ,KAFN,CAGLa,qBAAqB,CAAE,CACrB,CAAAZ,eAAe,OAAf,EAAAA,eAAe,SAAf,+BAAAA,eAAe,CAAEH,IAAjB,sEAAuBgB,qBAAvB,GAAgD,EAD3B,EAErBX,GAFqB,CAEjB,SAACY,GAAD,QAASA,CAAAA,GAAG,CAACC,KAAJ,CAAU,CAAV,CAAa,CAAC,CAAd,CAAT,EAFiB,CAHlB,CAMLC,cAAc,CAAE1C,iBAAiB,yBAAC0B,eAAe,CAACH,IAAhB,CAAqBoB,OAAtB,iDAAC,uBAA8BC,GAA/B,CAN5B,CApBG,yDAAD,GA4BR,CAAC5B,EAAD,CAAKD,QAAQ,CAACG,MAAd,CA5BQ,CADC,CA8BZ,CAAEkB,MAAM,CAAE,EAAV,CAAcC,SAAS,CAAE,CAAzB,CAA4BC,qBAAqB,CAAE,EAAnD,CAAuDI,cAAc,CAAE,EAAvE,CA9BY,CALd,CACEG,KADF,aACEA,KADF,CAEEC,SAFF,aAEEA,SAFF,CAGWC,WAHX,aAGEC,OAHF,gCAIEnB,MAJF,CAIYO,MAJZ,oBAIYA,MAJZ,CAIoBC,SAJpB,oBAIoBA,SAJpB,CAI+BC,qBAJ/B,oBAI+BA,qBAJ/B,CAIsDI,cAJtD,oBAIsDA,cAJtD,CAsCApD,SAAS,CAAC,UAAM,CACdyD,WAAW,GACZ,CAFQ,CAEN,CAACA,WAAD,CAFM,CAAT,CAIA,iBACE9C,WAAW,CAACmC,MAAD,CADb,CAAQa,QAAR,cAAQA,QAAR,CAAkBC,aAAlB,cAAkBA,aAAlB,CAAiCC,YAAjC,cAAiCA,YAAjC,CAA+CC,aAA/C,cAA+CA,aAA/C,CAA8DC,SAA9D,cAA8DA,SAA9D,CAGA,oBAKIlD,cAAc,CAChBd,WAAW,CACT,iBACE8B,CAAAA,OAAO,CAACC,GAAR,CACE6B,QAAQ,CAACrB,GAAT,CAAa,mBAAO0B,CAAAA,OAAP,OAAGtC,EAAH,OAAqBX,CAAAA,SAAS,CAACkD,OAAV,CAAkBD,OAAlB,CAArB,EAAb,CADF,CADF,EADS,CAKT,CAACL,QAAD,CALS,CADK,CAQhB,CACEO,QAAQ,CAAE9C,SADZ,CAEE+C,gBAAgB,CAAEP,aAFpB,CAGEQ,UAAU,CAAEX,WAHd,CARgB,CALlB,CACaY,eADb,iBACEb,SADF,CAEec,YAFf,iBAEEC,WAFF,CAGEC,aAHF,iBAGEA,aAHF,CAIEC,kBAJF,iBAIEA,kBAJF,CAmBA,GAAMC,CAAAA,YAAY,2FAAG,+JACbJ,CAAAA,YAAY,EADC,QAEnBR,aAAa,GAFM,wDAAH,kBAAZY,CAAAA,YAAY,2CAAlB,CAKA,GAAMC,CAAAA,MAAM,CAAG,IAAf,CAEA,GAAMC,CAAAA,gBAAgB,CAAGjB,QAAQ,CAACrB,GAAT,CAAa,SAACuC,IAAD,CAAU,CAC9C,GAAIA,IAAI,CAACnC,WAAL,GAAqB,IAAzB,CAA+B,CAC7B,sCACKmC,IADL,MAEEhC,IAAI,SAAE,+BAFR,GAID,CACD,MAAOgC,CAAAA,IAAP,CACD,CARwB,CAAzB,CAUA,mBACE,wCACE,KAAC,cAAD,EACE,YAAY,CAAEtB,KADhB,CAEE,iBAAiB,CAAEC,SAAS,EAAIa,eAFlC,CAGE,KAAK,CAAEvB,MAHT,CAIE,SAAS,CAAEC,SAJb,CAKE,kBAAkB,SAAE,gBALtB,CAME,QAAQ,CAAE3B,SANZ,CAOE,aAAa,CAAE0C,aAPjB,CAQE,oBAAoB,CAAE,CACpB,CACEjB,IAAI,SAAE,0BADR,CAEEiC,GAAG,CAAE,8BAFP,CAGEC,SAAS,CAAE,IAHb,CADoB,CAMpB,CACElC,IAAI,SAAE,qBADR,CAEEiC,GAAG,CAAE,wBAFP,CANoB,CARxB,CAmBE,kBAAkB,CAAE,CAClB,CACEjC,IAAI,SAAE,0BADR,CAEEiC,GAAG,CAAE,mBAFP,CADkB,CAKlB,CACEjC,IAAI,SAAE,qBADR,CAEEiC,GAAG,CAAE,aAFP,CALkB,CASlB,CACEjC,IAAI,SAAE,eADR,CAEEiC,GAAG,CAAE,OAFP,CATkB,CAalB,CACEjC,IAAI,SAAE,iBADR,CAEEiC,GAAG,CAAE,SAFP,CAbkB,CAiBlB,CACEjC,IAAI,SAAE,iBADR,CAEEiC,GAAG,CAAE,SAFP,CAjBkB,CAqBlB,CACEjC,IAAI,SAAE,kBADR,CAEEiC,GAAG,CAAE,UAFP,CArBkB,CAnBtB,CA6CE,qBAAqB,CAAE1B,cA7CzB,CA8CE,4BAA4B,CAAEJ,qBA9ChC,CA+CE,aAAa,CAAE,uBAACgC,KAAD,qBACb,KAAC,eAAD,gCACMA,KADN,MAEE,aAAa,CAAEpB,aAFjB,CAGE,QAAQ,CAAExC,SAHZ,CAIE,WAAW,CAAE2C,SAJf,CAKE,kBAAkB,8BACZY,MAAM,CACN,cACE,KAAC,gBAAD,EAEE,MAAM,WAAKlD,QAAQ,CAACwD,QAAd,QAFR,EACM,KADN,CADF,CADM,CAON,EARY,gBAShB,KAAC,mBAAD,EACE,MAAM,CAAC,0BADT,CAGE,QAAQ,CAAEP,YAHZ,CAIE,aAAa,CAAEE,gBAJjB,CAKE,kBAAkB,SAAE,qBALtB,EAEM,QAFN,CATgB,EALpB,GADa,EA/CjB,CAwEE,SAAS,cACP,MAAC,SAAD,EAAW,QAAQ,CAAExD,SAArB,wBACE,KAAC,UAAD,EAAY,OAAO,CAAC,mBAApB,kBAAyC,0BAAzC,EADF,cAEE,KAAC,UAAD,EAAY,OAAO,CAAC,aAApB,kBAAmC,qBAAnC,EAFF,cAGE,KAAC,UAAD,EAAY,OAAO,CAAC,OAApB,kBAA6B,eAA7B,EAHF,cAIE,KAAC,UAAD,EAAY,OAAO,CAAC,SAApB,kBAA+B,iBAA/B,EAJF,GAzEJ,CAgFE,SAAS,CAAE,mBAAC8D,KAAD,CAAQC,KAAR,qBACT,KAAC,kBAAD,EAEE,KAAK,CAAED,KAFT,CAGE,QAAQ,CAAE,mBAAM,CACdrB,YAAY,CAACqB,KAAD,CAAZ,CACD,CALH,CAME,UAAU,CAAEvB,QAAQ,CAACyB,IAAT,CAAc,SAACC,GAAD,QAASA,CAAAA,GAAG,CAAC3D,EAAJ,GAAWwD,KAAK,CAACxD,EAA1B,EAAd,CANd,CAOE,QAAQ,CAAEyD,KAPZ,EACOD,KAAK,CAACxD,EADb,CADS,EAhFb,CA2FE,kBAAkB,CAChBiD,MAAM,cACJ,KAAC,gBAAD,EAA4B,MAAM,WAAKlD,QAAQ,CAACwD,QAAd,QAAlC,EAAsB,KAAtB,CADI,CAEF,IA9FR,EADF,CAkGGT,aAAa,eACZ,MAAC,UAAD,EACE,MAAM,CAAEA,aADV,CAEE,OAAO,CAAC,QAFV,CAGE,KAAK,SAAE,gBAHT,CAIE,OAAO,CAAEC,kBAJX,mBAMG,mDANH,cAOE,KAAC,WAAD,EAAa,KAAK,CAAED,aAApB,EAPF,GAnGJ,GADF,CAgHD,CAED,cAAehD,CAAAA,aAAf","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { useLocation, useParams } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  ToolbarAddButton,\n  ToolbarDeleteButton,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport useSelected from 'hooks/useSelected';\nimport useRequest, { useDeleteItems } from 'hooks/useRequest';\nimport { UsersAPI, TokensAPI } from 'api';\nimport DataListToolbar from 'components/DataListToolbar';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport UserTokensListItem from './UserTokenListItem';\n\nconst QS_CONFIG = getQSConfig('user', {\n  page: 1,\n  page_size: 20,\n  order_by: 'application__name',\n});\nfunction UserTokenList() {\n  const location = useLocation();\n  const { id } = useParams();\n\n  const {\n    error,\n    isLoading,\n    request: fetchTokens,\n    result: { tokens, itemCount, relatedSearchableKeys, searchableKeys },\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const [\n        {\n          data: { results, count },\n        },\n        actionsResponse,\n      ] = await Promise.all([\n        UsersAPI.readTokens(id, params),\n        UsersAPI.readTokenOptions(id),\n      ]);\n      const modifiedResults = results.map((result) => {\n        result.summary_fields = {\n          user: result.summary_fields.user,\n          application: result.summary_fields.application,\n          user_capabilities: { delete: true },\n        };\n        result.name = result.summary_fields.application?.name;\n        return result;\n      });\n      return {\n        tokens: modifiedResults,\n        itemCount: count,\n        relatedSearchableKeys: (\n          actionsResponse?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(actionsResponse.data.actions?.GET),\n      };\n    }, [id, location.search]),\n    { tokens: [], itemCount: 0, relatedSearchableKeys: [], searchableKeys: [] }\n  );\n\n  useEffect(() => {\n    fetchTokens();\n  }, [fetchTokens]);\n\n  const { selected, isAllSelected, handleSelect, clearSelected, selectAll } =\n    useSelected(tokens);\n\n  const {\n    isLoading: isDeleteLoading,\n    deleteItems: deleteTokens,\n    deletionError,\n    clearDeletionError,\n  } = useDeleteItems(\n    useCallback(\n      () =>\n        Promise.all(\n          selected.map(({ id: tokenId }) => TokensAPI.destroy(tokenId))\n        ),\n      [selected]\n    ),\n    {\n      qsConfig: QS_CONFIG,\n      allItemsSelected: isAllSelected,\n      fetchItems: fetchTokens,\n    }\n  );\n  const handleDelete = async () => {\n    await deleteTokens();\n    clearSelected();\n  };\n\n  const canAdd = true;\n\n  const modifiedSelected = selected.map((item) => {\n    if (item.application === null) {\n      return {\n        ...item,\n        name: t`Personal Access Token`,\n      };\n    }\n    return item;\n  });\n\n  return (\n    <>\n      <PaginatedTable\n        contentError={error}\n        hasContentLoading={isLoading || isDeleteLoading}\n        items={tokens}\n        itemCount={itemCount}\n        pluralizedItemName={t`Tokens`}\n        qsConfig={QS_CONFIG}\n        clearSelected={clearSelected}\n        toolbarSearchColumns={[\n          {\n            name: t`Application name`,\n            key: 'application__name__icontains',\n            isDefault: true,\n          },\n          {\n            name: t`Description`,\n            key: 'description__icontains',\n          },\n        ]}\n        toolbarSortColumns={[\n          {\n            name: t`Application name`,\n            key: 'application__name',\n          },\n          {\n            name: t`Description`,\n            key: 'description',\n          },\n          {\n            name: t`Scope`,\n            key: 'scope',\n          },\n          {\n            name: t`Expires`,\n            key: 'expires',\n          },\n          {\n            name: t`Created`,\n            key: 'created',\n          },\n          {\n            name: t`Modified`,\n            key: 'modified',\n          },\n        ]}\n        toolbarSearchableKeys={searchableKeys}\n        toolbarRelatedSearchableKeys={relatedSearchableKeys}\n        renderToolbar={(props) => (\n          <DataListToolbar\n            {...props}\n            isAllSelected={isAllSelected}\n            qsConfig={QS_CONFIG}\n            onSelectAll={selectAll}\n            additionalControls={[\n              ...(canAdd\n                ? [\n                    <ToolbarAddButton\n                      key=\"add\"\n                      linkTo={`${location.pathname}/add`}\n                    />,\n                  ]\n                : []),\n              <ToolbarDeleteButton\n                ouiaId=\"user-token-delete-button\"\n                key=\"delete\"\n                onDelete={handleDelete}\n                itemsToDelete={modifiedSelected}\n                pluralizedItemName={t`User tokens`}\n              />,\n            ]}\n          />\n        )}\n        headerRow={\n          <HeaderRow qsConfig={QS_CONFIG}>\n            <HeaderCell sortKey=\"application__name\">{t`Application Name`}</HeaderCell>\n            <HeaderCell sortKey=\"description\">{t`Description`}</HeaderCell>\n            <HeaderCell sortKey=\"scope\">{t`Scope`}</HeaderCell>\n            <HeaderCell sortKey=\"expires\">{t`Expires`}</HeaderCell>\n          </HeaderRow>\n        }\n        renderRow={(token, index) => (\n          <UserTokensListItem\n            key={token.id}\n            token={token}\n            onSelect={() => {\n              handleSelect(token);\n            }}\n            isSelected={selected.some((row) => row.id === token.id)}\n            rowIndex={index}\n          />\n        )}\n        emptyStateControls={\n          canAdd ? (\n            <ToolbarAddButton key=\"add\" linkTo={`${location.pathname}/add`} />\n          ) : null\n        }\n      />\n      {deletionError && (\n        <AlertModal\n          isOpen={deletionError}\n          variant=\"danger\"\n          title={t`Error!`}\n          onClose={clearDeletionError}\n        >\n          {t`Failed to delete one or more user tokens.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nexport default UserTokenList;\n"]},"metadata":{},"sourceType":"module"}