{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{useLocation}from'react-router-dom';import{FormGroup,Tooltip}from'@patternfly/react-core';import{ExecutionEnvironmentsAPI,ProjectsAPI}from'api';import{getSearchableKeys}from'components/PaginatedTable';import{ExecutionEnvironment}from'types';import{getQSConfig,parseQueryString,mergeParams}from'util/qs';import useRequest from'hooks/useRequest';import Popover from'../Popover';import OptionsList from'../OptionsList';import Lookup from'./Lookup';import LookupErrorMessage from'./shared/LookupErrorMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('execution_environments',{page:1,page_size:5,order_by:'name'});function ExecutionEnvironmentLookup(_ref){var id=_ref.id,globallyAvailable=_ref.globallyAvailable,helperTextInvalid=_ref.helperTextInvalid,isDisabled=_ref.isDisabled,isValid=_ref.isValid,onBlur=_ref.onBlur,onChange=_ref.onChange,organizationId=_ref.organizationId,popoverContent=_ref.popoverContent,projectId=_ref.projectId,tooltip=_ref.tooltip,validate=_ref.validate,value=_ref.value,fieldName=_ref.fieldName,overrideLabel=_ref.overrideLabel;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$ProjectsAPI$re,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(projectId){_context.next=2;break;}return _context.abrupt(\"return\",{});case 2:_context.next=4;return ProjectsAPI.readDetail(projectId);case 4:_yield$ProjectsAPI$re=_context.sent;data=_yield$ProjectsAPI$re.data;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}}},_callee);})),[projectId]),{project:null,isLoading:true}),fetchProject=_useRequest.request,fetchProjectError=_useRequest.error,isProjectLoading=_useRequest.isLoading,project=_useRequest.result;useEffect(function(){fetchProject();},[fetchProject]);var _useRequest2=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _actionsResponse$data,_actionsResponse$data2;var params,globallyAvailableParams,organizationIdParams,projectIdParams,_yield$Promise$all,_yield$Promise$all2,data,actionsResponse;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!isProjectLoading){_context2.next=2;break;}return _context2.abrupt(\"return\",{executionEnvironments:[],count:0});case 2:params=parseQueryString(QS_CONFIG,location.search);globallyAvailableParams=globallyAvailable?{or__organization__isnull:'True'}:{};organizationIdParams=organizationId?{or__organization__id:organizationId}:{};projectIdParams=projectId&&project!==null&&project!==void 0&&project.organization?{or__organization__id:project.organization}:{};_context2.next=8;return Promise.all([ExecutionEnvironmentsAPI.read(mergeParams(params,_objectSpread(_objectSpread(_objectSpread({},globallyAvailableParams),organizationIdParams),projectIdParams))),ExecutionEnvironmentsAPI.readOptions()]);case 8:_yield$Promise$all=_context2.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);data=_yield$Promise$all2[0].data;actionsResponse=_yield$Promise$all2[1];return _context2.abrupt(\"return\",{executionEnvironments:data.results,count:data.count,relatedSearchableKeys:((actionsResponse===null||actionsResponse===void 0?void 0:(_actionsResponse$data=actionsResponse.data)===null||_actionsResponse$data===void 0?void 0:_actionsResponse$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_actionsResponse$data2=actionsResponse.data.actions)===null||_actionsResponse$data2===void 0?void 0:_actionsResponse$data2.GET)});case 13:case\"end\":return _context2.stop();}}},_callee2);})),[location,globallyAvailable,organizationId,projectId,project,isProjectLoading]),{executionEnvironments:[],count:0,relatedSearchableKeys:[],searchableKeys:[]}),_useRequest2$result=_useRequest2.result,executionEnvironments=_useRequest2$result.executionEnvironments,count=_useRequest2$result.count,relatedSearchableKeys=_useRequest2$result.relatedSearchableKeys,searchableKeys=_useRequest2$result.searchableKeys,fetchExecutionEnvironments=_useRequest2.request,error=_useRequest2.error,isLoading=_useRequest2.isLoading;var checkExecutionEnvironmentName=useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name){var _yield$ExecutionEnvir,_yield$ExecutionEnvir2,nameMatchResults,nameMatchCount;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(name){_context3.next=3;break;}onChange(null);return _context3.abrupt(\"return\");case 3:_context3.prev=3;_context3.next=6;return ExecutionEnvironmentsAPI.read({name:name});case 6:_yield$ExecutionEnvir=_context3.sent;_yield$ExecutionEnvir2=_yield$ExecutionEnvir.data;nameMatchResults=_yield$ExecutionEnvir2.results;nameMatchCount=_yield$ExecutionEnvir2.count;onChange(nameMatchCount?nameMatchResults[0]:null);_context3.next=16;break;case 13:_context3.prev=13;_context3.t0=_context3[\"catch\"](3);onChange(null);case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[3,13]]);}));return function(_x){return _ref4.apply(this,arguments);};}(),[onChange]);useEffect(function(){fetchExecutionEnvironments();},[fetchExecutionEnvironments]);var renderLookup=function renderLookup(){return/*#__PURE__*/_jsx(Lookup,{id:id,header:/*i18n*/i18n._(\"Execution Environment\"),value:value,onBlur:onBlur,onChange:onChange,onUpdate:fetchExecutionEnvironments,onDebounce:checkExecutionEnvironmentName,fieldName:fieldName,validate:validate,qsConfig:QS_CONFIG,isLoading:isLoading||isProjectLoading,isDisabled:isDisabled,renderOptionsList:function renderOptionsList(_ref5){var state=_ref5.state,dispatch=_ref5.dispatch,canDelete=_ref5.canDelete;return/*#__PURE__*/_jsx(OptionsList,{value:state.selectedItems,options:executionEnvironments,optionCount:count,searchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true}],sortColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name'}],searchableKeys:searchableKeys,relatedSearchableKeys:relatedSearchableKeys,multiple:state.multiple,header:/*i18n*/i18n._(\"Execution Environment\"),name:\"executionEnvironments\",qsConfig:QS_CONFIG,readOnly:!canDelete,selectItem:function selectItem(item){return dispatch({type:'SELECT_ITEM',item:item});},deselectItem:function deselectItem(item){return dispatch({type:'DESELECT_ITEM',item:item});}});}});};var renderLabel=function renderLabel(){if(overrideLabel){return null;}return(/*i18n*/i18n._(\"Execution Environment\"));};return/*#__PURE__*/_jsxs(FormGroup,{fieldId:id,label:renderLabel(),labelIcon:popoverContent&&/*#__PURE__*/_jsx(Popover,{content:popoverContent}),helperTextInvalid:helperTextInvalid,validated:isValid?'default':'error',children:[tooltip&&isDisabled?/*#__PURE__*/_jsx(Tooltip,{content:tooltip,children:renderLookup()}):renderLookup(),/*#__PURE__*/_jsx(LookupErrorMessage,{error:error||fetchProjectError})]});}ExecutionEnvironmentLookup.defaultProps={id:'execution-environments',popoverContent:'',value:null,projectId:null,organizationId:null,validate:function validate(){return undefined;},fieldName:'execution_environment',overrideLabel:false};export default ExecutionEnvironmentLookup;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/Lookup/ExecutionEnvironmentLookup.js"],"names":["React","useCallback","useEffect","useLocation","FormGroup","Tooltip","ExecutionEnvironmentsAPI","ProjectsAPI","getSearchableKeys","ExecutionEnvironment","getQSConfig","parseQueryString","mergeParams","useRequest","Popover","OptionsList","Lookup","LookupErrorMessage","QS_CONFIG","page","page_size","order_by","ExecutionEnvironmentLookup","id","globallyAvailable","helperTextInvalid","isDisabled","isValid","onBlur","onChange","organizationId","popoverContent","projectId","tooltip","validate","value","fieldName","overrideLabel","location","readDetail","data","project","isLoading","fetchProject","request","fetchProjectError","error","isProjectLoading","result","executionEnvironments","count","params","search","globallyAvailableParams","or__organization__isnull","organizationIdParams","or__organization__id","projectIdParams","organization","Promise","all","read","readOptions","actionsResponse","results","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","actions","GET","fetchExecutionEnvironments","checkExecutionEnvironmentName","name","nameMatchResults","nameMatchCount","renderLookup","state","dispatch","canDelete","selectedItems","key","isDefault","multiple","item","type","renderLabel","defaultProps","undefined"],"mappings":"6bAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,SAA7B,KAA8C,OAA9C,CAEA,OAASC,WAAT,KAA4B,kBAA5B,CAEA,OAASC,SAAT,CAAoBC,OAApB,KAAmC,wBAAnC,CACA,OAASC,wBAAT,CAAmCC,WAAnC,KAAsD,KAAtD,CACA,OAASC,iBAAT,KAAkC,2BAAlC,CACA,OAASC,oBAAT,KAAqC,OAArC,CACA,OAASC,WAAT,CAAsBC,gBAAtB,CAAwCC,WAAxC,KAA2D,SAA3D,CACA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,MAAOC,CAAAA,OAAP,KAAoB,YAApB,CACA,MAAOC,CAAAA,WAAP,KAAwB,gBAAxB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,6BAA/B,C,wFAEA,GAAMC,CAAAA,SAAS,CAAGR,WAAW,CAAC,wBAAD,CAA2B,CACtDS,IAAI,CAAE,CADgD,CAEtDC,SAAS,CAAE,CAF2C,CAGtDC,QAAQ,CAAE,MAH4C,CAA3B,CAA7B,CAMA,QAASC,CAAAA,0BAAT,MAgBG,IAfDC,CAAAA,EAeC,MAfDA,EAeC,CAdDC,iBAcC,MAdDA,iBAcC,CAbDC,iBAaC,MAbDA,iBAaC,CAZDC,UAYC,MAZDA,UAYC,CAXDC,OAWC,MAXDA,OAWC,CAVDC,MAUC,MAVDA,MAUC,CATDC,QASC,MATDA,QASC,CARDC,cAQC,MARDA,cAQC,CAPDC,cAOC,MAPDA,cAOC,CANDC,SAMC,MANDA,SAMC,CALDC,OAKC,MALDA,OAKC,CAJDC,QAIC,MAJDA,QAIC,CAHDC,KAGC,MAHDA,KAGC,CAFDC,SAEC,MAFDA,SAEC,CADDC,aACC,MADDA,aACC,CACD,GAAMC,CAAAA,QAAQ,CAAGnC,WAAW,EAA5B,CACA,gBAKIU,UAAU,CACZZ,WAAW,sEAAC,qKACL+B,SADK,yDAED,EAFC,+BAIazB,CAAAA,WAAW,CAACgC,UAAZ,CAAuBP,SAAvB,CAJb,4CAIFQ,IAJE,uBAIFA,IAJE,iCAKHA,IALG,wDAAD,GAMR,CAACR,SAAD,CANQ,CADC,CAQZ,CACES,OAAO,CAAE,IADX,CAEEC,SAAS,CAAE,IAFb,CARY,CALd,CACWC,YADX,aACEC,OADF,CAESC,iBAFT,aAEEC,KAFF,CAGaC,gBAHb,aAGEL,SAHF,CAIUD,OAJV,aAIEO,MAJF,CAmBA9C,SAAS,CAAC,UAAM,CACdyC,YAAY,GACb,CAFQ,CAEN,CAACA,YAAD,CAFM,CAAT,CAIA,iBAUI9B,UAAU,CACZZ,WAAW,sEAAC,iUACN8C,gBADM,2DAED,CACLE,qBAAqB,CAAE,EADlB,CAELC,KAAK,CAAE,CAFF,CAFC,SAOJC,MAPI,CAOKxC,gBAAgB,CAACO,SAAD,CAAYoB,QAAQ,CAACc,MAArB,CAPrB,CAQJC,uBARI,CAQsB7B,iBAAiB,CAC7C,CAAE8B,wBAAwB,CAAE,MAA5B,CAD6C,CAE7C,EAVM,CAWJC,oBAXI,CAWmBzB,cAAc,CACvC,CAAE0B,oBAAoB,CAAE1B,cAAxB,CADuC,CAEvC,EAbM,CAcJ2B,eAdI,CAeRzB,SAAS,EAAIS,OAAJ,SAAIA,OAAJ,WAAIA,OAAO,CAAEiB,YAAtB,CACI,CACEF,oBAAoB,CAAEf,OAAO,CAACiB,YADhC,CADJ,CAII,EAnBI,wBAoBgCC,CAAAA,OAAO,CAACC,GAAR,CAAY,CACpDtD,wBAAwB,CAACuD,IAAzB,CACEjD,WAAW,CAACuC,MAAD,8CACNE,uBADM,EAENE,oBAFM,EAGNE,eAHM,EADb,CADoD,CAQpDnD,wBAAwB,CAACwD,WAAzB,EARoD,CAAZ,CApBhC,mGAoBDtB,IApBC,wBAoBDA,IApBC,CAoBOuB,eApBP,yDA8BH,CACLd,qBAAqB,CAAET,IAAI,CAACwB,OADvB,CAELd,KAAK,CAAEV,IAAI,CAACU,KAFP,CAGLe,qBAAqB,CAAE,CACrB,CAAAF,eAAe,OAAf,EAAAA,eAAe,SAAf,+BAAAA,eAAe,CAAEvB,IAAjB,sEAAuB0B,qBAAvB,GAAgD,EAD3B,EAErBC,GAFqB,CAEjB,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,KAAJ,CAAU,CAAV,CAAa,CAAC,CAAd,CAAT,EAFiB,CAHlB,CAMLC,cAAc,CAAE9D,iBAAiB,yBAACuD,eAAe,CAACvB,IAAhB,CAAqB+B,OAAtB,iDAAC,uBAA8BC,GAA/B,CAN5B,CA9BG,2DAAD,GAsCR,CACDlC,QADC,CAEDd,iBAFC,CAGDM,cAHC,CAIDE,SAJC,CAKDS,OALC,CAMDM,gBANC,CAtCQ,CADC,CA+CZ,CACEE,qBAAqB,CAAE,EADzB,CAEEC,KAAK,CAAE,CAFT,CAGEe,qBAAqB,CAAE,EAHzB,CAIEK,cAAc,CAAE,EAJlB,CA/CY,CAVd,kCACEtB,MADF,CAEIC,qBAFJ,qBAEIA,qBAFJ,CAGIC,KAHJ,qBAGIA,KAHJ,CAIIe,qBAJJ,qBAIIA,qBAJJ,CAKIK,cALJ,qBAKIA,cALJ,CAOWG,0BAPX,cAOE7B,OAPF,CAQEE,KARF,cAQEA,KARF,CASEJ,SATF,cASEA,SATF,CAiEA,GAAMgC,CAAAA,6BAA6B,CAAGzE,WAAW,2FAC/C,kBAAO0E,IAAP,0MACOA,IADP,0BAEI9C,QAAQ,CAAC,IAAD,CAAR,CAFJ,iFAScvB,CAAAA,wBAAwB,CAACuD,IAAzB,CAA8B,CAAEc,IAAI,CAAJA,IAAF,CAA9B,CATd,0FAQMnC,IARN,CAQuBoC,gBARvB,wBAQcZ,OARd,CAQgDa,cARhD,wBAQyC3B,KARzC,CAUIrB,QAAQ,CAACgD,cAAc,CAAGD,gBAAgB,CAAC,CAAD,CAAnB,CAAyB,IAAxC,CAAR,CAVJ,qFAYI/C,QAAQ,CAAC,IAAD,CAAR,CAZJ,uEAD+C,gEAgB/C,CAACA,QAAD,CAhB+C,CAAjD,CAmBA3B,SAAS,CAAC,UAAM,CACduE,0BAA0B,GAC3B,CAFQ,CAEN,CAACA,0BAAD,CAFM,CAAT,CAIA,GAAMK,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,sBACnB,KAAC,MAAD,EACE,EAAE,CAAEvD,EADN,CAEE,MAAM,SAAE,+BAFV,CAGE,KAAK,CAAEY,KAHT,CAIE,MAAM,CAAEP,MAJV,CAKE,QAAQ,CAAEC,QALZ,CAME,QAAQ,CAAE4C,0BANZ,CAOE,UAAU,CAAEC,6BAPd,CAQE,SAAS,CAAEtC,SARb,CASE,QAAQ,CAAEF,QATZ,CAUE,QAAQ,CAAEhB,SAVZ,CAWE,SAAS,CAAEwB,SAAS,EAAIK,gBAX1B,CAYE,UAAU,CAAErB,UAZd,CAaE,iBAAiB,CAAE,qCAAGqD,CAAAA,KAAH,OAAGA,KAAH,CAAUC,QAAV,OAAUA,QAAV,CAAoBC,SAApB,OAAoBA,SAApB,oBACjB,KAAC,WAAD,EACE,KAAK,CAAEF,KAAK,CAACG,aADf,CAEE,OAAO,CAAEjC,qBAFX,CAGE,WAAW,CAAEC,KAHf,CAIE,aAAa,CAAE,CACb,CACEyB,IAAI,SAAE,cADR,CAEEQ,GAAG,CAAE,iBAFP,CAGEC,SAAS,CAAE,IAHb,CADa,CAJjB,CAWE,WAAW,CAAE,CACX,CACET,IAAI,SAAE,cADR,CAEEQ,GAAG,CAAE,MAFP,CADW,CAXf,CAiBE,cAAc,CAAEb,cAjBlB,CAkBE,qBAAqB,CAAEL,qBAlBzB,CAmBE,QAAQ,CAAEc,KAAK,CAACM,QAnBlB,CAoBE,MAAM,SAAE,+BApBV,CAqBE,IAAI,CAAC,uBArBP,CAsBE,QAAQ,CAAEnE,SAtBZ,CAuBE,QAAQ,CAAE,CAAC+D,SAvBb,CAwBE,UAAU,CAAE,oBAACK,IAAD,QAAUN,CAAAA,QAAQ,CAAC,CAAEO,IAAI,CAAE,aAAR,CAAuBD,IAAI,CAAJA,IAAvB,CAAD,CAAlB,EAxBd,CAyBE,YAAY,CAAE,sBAACA,IAAD,QAAUN,CAAAA,QAAQ,CAAC,CAAEO,IAAI,CAAE,eAAR,CAAyBD,IAAI,CAAJA,IAAzB,CAAD,CAAlB,EAzBhB,EADiB,EAbrB,EADmB,EAArB,CA8CA,GAAME,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAInD,aAAJ,CAAmB,CACjB,MAAO,KAAP,CACD,CACD,eAAO,+BAAP,EACD,CALD,CAOA,mBACE,MAAC,SAAD,EACE,OAAO,CAAEd,EADX,CAEE,KAAK,CAAEiE,WAAW,EAFpB,CAGE,SAAS,CAAEzD,cAAc,eAAI,KAAC,OAAD,EAAS,OAAO,CAAEA,cAAlB,EAH/B,CAIE,iBAAiB,CAAEN,iBAJrB,CAKE,SAAS,CAAEE,OAAO,CAAG,SAAH,CAAe,OALnC,WAOGM,OAAO,EAAIP,UAAX,cACC,KAAC,OAAD,EAAS,OAAO,CAAEO,OAAlB,UAA4B6C,YAAY,EAAxC,EADD,CAGCA,YAAY,EAVhB,cAaE,KAAC,kBAAD,EAAoB,KAAK,CAAEhC,KAAK,EAAID,iBAApC,EAbF,GADF,CAiBD,CAcDvB,0BAA0B,CAACmE,YAA3B,CAA0C,CACxClE,EAAE,CAAE,wBADoC,CAExCQ,cAAc,CAAE,EAFwB,CAGxCI,KAAK,CAAE,IAHiC,CAIxCH,SAAS,CAAE,IAJ6B,CAKxCF,cAAc,CAAE,IALwB,CAMxCI,QAAQ,CAAE,0BAAMwD,CAAAA,SAAN,EAN8B,CAOxCtD,SAAS,CAAE,uBAP6B,CAQxCC,aAAa,CAAE,KARyB,CAA1C,CAWA,cAAef,CAAAA,0BAAf","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { string, func, bool, oneOfType, number } from 'prop-types';\nimport { useLocation } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport { FormGroup, Tooltip } from '@patternfly/react-core';\nimport { ExecutionEnvironmentsAPI, ProjectsAPI } from 'api';\nimport { getSearchableKeys } from 'components/PaginatedTable';\nimport { ExecutionEnvironment } from 'types';\nimport { getQSConfig, parseQueryString, mergeParams } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport Popover from '../Popover';\nimport OptionsList from '../OptionsList';\n\nimport Lookup from './Lookup';\nimport LookupErrorMessage from './shared/LookupErrorMessage';\n\nconst QS_CONFIG = getQSConfig('execution_environments', {\n  page: 1,\n  page_size: 5,\n  order_by: 'name',\n});\n\nfunction ExecutionEnvironmentLookup({\n  id,\n  globallyAvailable,\n  helperTextInvalid,\n  isDisabled,\n  isValid,\n  onBlur,\n  onChange,\n  organizationId,\n  popoverContent,\n  projectId,\n  tooltip,\n  validate,\n  value,\n  fieldName,\n  overrideLabel,\n}) {\n  const location = useLocation();\n  const {\n    request: fetchProject,\n    error: fetchProjectError,\n    isLoading: isProjectLoading,\n    result: project,\n  } = useRequest(\n    useCallback(async () => {\n      if (!projectId) {\n        return {};\n      }\n      const { data } = await ProjectsAPI.readDetail(projectId);\n      return data;\n    }, [projectId]),\n    {\n      project: null,\n      isLoading: true,\n    }\n  );\n\n  useEffect(() => {\n    fetchProject();\n  }, [fetchProject]);\n\n  const {\n    result: {\n      executionEnvironments,\n      count,\n      relatedSearchableKeys,\n      searchableKeys,\n    },\n    request: fetchExecutionEnvironments,\n    error,\n    isLoading,\n  } = useRequest(\n    useCallback(async () => {\n      if (isProjectLoading) {\n        return {\n          executionEnvironments: [],\n          count: 0,\n        };\n      }\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const globallyAvailableParams = globallyAvailable\n        ? { or__organization__isnull: 'True' }\n        : {};\n      const organizationIdParams = organizationId\n        ? { or__organization__id: organizationId }\n        : {};\n      const projectIdParams =\n        projectId && project?.organization\n          ? {\n              or__organization__id: project.organization,\n            }\n          : {};\n      const [{ data }, actionsResponse] = await Promise.all([\n        ExecutionEnvironmentsAPI.read(\n          mergeParams(params, {\n            ...globallyAvailableParams,\n            ...organizationIdParams,\n            ...projectIdParams,\n          })\n        ),\n        ExecutionEnvironmentsAPI.readOptions(),\n      ]);\n      return {\n        executionEnvironments: data.results,\n        count: data.count,\n        relatedSearchableKeys: (\n          actionsResponse?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(actionsResponse.data.actions?.GET),\n      };\n    }, [\n      location,\n      globallyAvailable,\n      organizationId,\n      projectId,\n      project,\n      isProjectLoading,\n    ]),\n    {\n      executionEnvironments: [],\n      count: 0,\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  const checkExecutionEnvironmentName = useCallback(\n    async (name) => {\n      if (!name) {\n        onChange(null);\n        return;\n      }\n\n      try {\n        const {\n          data: { results: nameMatchResults, count: nameMatchCount },\n        } = await ExecutionEnvironmentsAPI.read({ name });\n        onChange(nameMatchCount ? nameMatchResults[0] : null);\n      } catch {\n        onChange(null);\n      }\n    },\n    [onChange]\n  );\n\n  useEffect(() => {\n    fetchExecutionEnvironments();\n  }, [fetchExecutionEnvironments]);\n\n  const renderLookup = () => (\n    <Lookup\n      id={id}\n      header={t`Execution Environment`}\n      value={value}\n      onBlur={onBlur}\n      onChange={onChange}\n      onUpdate={fetchExecutionEnvironments}\n      onDebounce={checkExecutionEnvironmentName}\n      fieldName={fieldName}\n      validate={validate}\n      qsConfig={QS_CONFIG}\n      isLoading={isLoading || isProjectLoading}\n      isDisabled={isDisabled}\n      renderOptionsList={({ state, dispatch, canDelete }) => (\n        <OptionsList\n          value={state.selectedItems}\n          options={executionEnvironments}\n          optionCount={count}\n          searchColumns={[\n            {\n              name: t`Name`,\n              key: 'name__icontains',\n              isDefault: true,\n            },\n          ]}\n          sortColumns={[\n            {\n              name: t`Name`,\n              key: 'name',\n            },\n          ]}\n          searchableKeys={searchableKeys}\n          relatedSearchableKeys={relatedSearchableKeys}\n          multiple={state.multiple}\n          header={t`Execution Environment`}\n          name=\"executionEnvironments\"\n          qsConfig={QS_CONFIG}\n          readOnly={!canDelete}\n          selectItem={(item) => dispatch({ type: 'SELECT_ITEM', item })}\n          deselectItem={(item) => dispatch({ type: 'DESELECT_ITEM', item })}\n        />\n      )}\n    />\n  );\n\n  const renderLabel = () => {\n    if (overrideLabel) {\n      return null;\n    }\n    return t`Execution Environment`;\n  };\n\n  return (\n    <FormGroup\n      fieldId={id}\n      label={renderLabel()}\n      labelIcon={popoverContent && <Popover content={popoverContent} />}\n      helperTextInvalid={helperTextInvalid}\n      validated={isValid ? 'default' : 'error'}\n    >\n      {tooltip && isDisabled ? (\n        <Tooltip content={tooltip}>{renderLookup()}</Tooltip>\n      ) : (\n        renderLookup()\n      )}\n\n      <LookupErrorMessage error={error || fetchProjectError} />\n    </FormGroup>\n  );\n}\n\nExecutionEnvironmentLookup.propTypes = {\n  id: string,\n  value: ExecutionEnvironment,\n  popoverContent: string,\n  onChange: func.isRequired,\n  projectId: oneOfType([number, string]),\n  organizationId: oneOfType([number, string]),\n  validate: func,\n  fieldName: string,\n  overrideLabel: bool,\n};\n\nExecutionEnvironmentLookup.defaultProps = {\n  id: 'execution-environments',\n  popoverContent: '',\n  value: null,\n  projectId: null,\n  organizationId: null,\n  validate: () => undefined,\n  fieldName: 'execution_environment',\n  overrideLabel: false,\n};\n\nexport default ExecutionEnvironmentLookup;\n"]},"metadata":{},"sourceType":"module"}