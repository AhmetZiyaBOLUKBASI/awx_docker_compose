{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{Link,Switch,Route,Redirect,useRouteMatch,useLocation}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{InventoriesAPI}from'api';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import JobList from'components/JobList';import{ResourceAccessList}from'components/ResourceAccessList';import RoutedTabs from'components/RoutedTabs';import RelatedTemplateList from'components/RelatedTemplateList';import SmartInventoryDetail from'./SmartInventoryDetail';import SmartInventoryEdit from'./SmartInventoryEdit';import SmartInventoryHosts from'./SmartInventoryHosts';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SmartInventory(_ref){var setBreadcrumb=_ref.setBreadcrumb;var location=useLocation();var match=useRouteMatch('/inventories/smart_inventory/:id');var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InventoriesAPI,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InventoriesAPI.readDetail(match.params.id);case 2:_yield$InventoriesAPI=_context.sent;data=_yield$InventoriesAPI.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[match.params.id]),null),inventory=_useRequest.result,contentError=_useRequest.error,hasContentLoading=_useRequest.isLoading,fetchInventory=_useRequest.request;useEffect(function(){fetchInventory();},[fetchInventory,location.pathname]);useEffect(function(){if(inventory){setBreadcrumb(inventory);}},[inventory,setBreadcrumb]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Inventories\")]}),link:\"/inventories\",id:99},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(match.url,\"/details\"),id:0},{name:/*i18n*/i18n._(\"Access\"),link:\"\".concat(match.url,\"/access\"),id:1},{name:/*i18n*/i18n._(\"Hosts\"),link:\"\".concat(match.url,\"/hosts\"),id:2},{name:/*i18n*/i18n._(\"Jobs\"),link:\"\".concat(match.url,\"/jobs\"),id:3},{name:/*i18n*/i18n._(\"Job Templates\"),link:\"\".concat(match.url,\"/job_templates\"),id:4}];if(hasContentLoading){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentLoading,{})})});}if(contentError){var _contentError$respons;return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:contentError,children:(contentError===null||contentError===void 0?void 0:(_contentError$respons=contentError.response)===null||_contentError$respons===void 0?void 0:_contentError$respons.status)===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Smart Inventory not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/inventories\",children:/*i18n*/i18n._(\"View all Inventories.\")})]})})})});}if((inventory===null||inventory===void 0?void 0:inventory.kind)===''){return/*#__PURE__*/_jsx(Redirect,{to:\"/inventories/inventory/\".concat(inventory.id,\"/details\")});}var showCardHeader=true;if(['edit','hosts/'].some(function(name){return location.pathname.includes(name);})){showCardHeader=false;}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/inventories/smart_inventory/:id\",to:\"/inventories/smart_inventory/:id/details\",exact:true}),inventory&&[/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/details\",children:/*#__PURE__*/_jsx(SmartInventoryDetail,{isLoading:hasContentLoading,inventory:inventory})},\"details\"),/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/edit\",children:/*#__PURE__*/_jsx(SmartInventoryEdit,{inventory:inventory})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/access\",children:/*#__PURE__*/_jsx(ResourceAccessList,{resource:inventory,apiModel:InventoriesAPI})},\"access\"),/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/hosts\",children:/*#__PURE__*/_jsx(SmartInventoryHosts,{inventory:inventory,setBreadcrumb:setBreadcrumb})},\"hosts\"),/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/jobs\",children:/*#__PURE__*/_jsx(JobList,{defaultParams:{or__job__inventory:inventory.id,or__adhoccommand__inventory:inventory.id,or__inventoryupdate__inventory_source__inventory:inventory.id,or__workflowjob__inventory:inventory.id}})},\"jobs\"),/*#__PURE__*/_jsx(Route,{path:\"/inventories/smart_inventory/:id/job_templates\",children:/*#__PURE__*/_jsx(RelatedTemplateList,{searchParams:{inventory__id:inventory.id}})},\"job_templates\"),/*#__PURE__*/_jsx(Route,{path:\"*\",children:!hasContentLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:match.params.id&&/*#__PURE__*/_jsx(Link,{to:\"/inventories/smart_inventory/\".concat(match.params.id,\"/details\"),children:/*i18n*/i18n._(\"View Inventory Details\")})})},\"not-found\")]]})]})});}export{SmartInventory as _SmartInventory};export default SmartInventory;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/SmartInventory.js"],"names":["React","useCallback","useEffect","Link","Switch","Route","Redirect","useRouteMatch","useLocation","CaretLeftIcon","Card","PageSection","useRequest","InventoriesAPI","ContentError","ContentLoading","JobList","ResourceAccessList","RoutedTabs","RelatedTemplateList","SmartInventoryDetail","SmartInventoryEdit","SmartInventoryHosts","SmartInventory","setBreadcrumb","location","match","readDetail","params","id","data","inventory","result","contentError","error","hasContentLoading","isLoading","fetchInventory","request","pathname","tabsArray","name","link","url","response","status","kind","showCardHeader","some","includes","or__job__inventory","or__adhoccommand__inventory","or__inventoryupdate__inventory_source__inventory","or__workflowjob__inventory","inventory__id","_SmartInventory"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { t } from '@lingui/macro';\nimport {\n  Link,\n  Switch,\n  Route,\n  Redirect,\n  useRouteMatch,\n  useLocation,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\n\nimport useRequest from 'hooks/useRequest';\nimport { InventoriesAPI } from 'api';\n\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport JobList from 'components/JobList';\nimport { ResourceAccessList } from 'components/ResourceAccessList';\nimport RoutedTabs from 'components/RoutedTabs';\nimport RelatedTemplateList from 'components/RelatedTemplateList';\nimport SmartInventoryDetail from './SmartInventoryDetail';\nimport SmartInventoryEdit from './SmartInventoryEdit';\nimport SmartInventoryHosts from './SmartInventoryHosts';\n\nfunction SmartInventory({ setBreadcrumb }) {\n  const location = useLocation();\n  const match = useRouteMatch('/inventories/smart_inventory/:id');\n\n  const {\n    result: inventory,\n    error: contentError,\n    isLoading: hasContentLoading,\n    request: fetchInventory,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await InventoriesAPI.readDetail(match.params.id);\n      return data;\n    }, [match.params.id]),\n\n    null\n  );\n\n  useEffect(() => {\n    fetchInventory();\n  }, [fetchInventory, location.pathname]);\n\n  useEffect(() => {\n    if (inventory) {\n      setBreadcrumb(inventory);\n    }\n  }, [inventory, setBreadcrumb]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Inventories`}\n        </>\n      ),\n      link: `/inventories`,\n      id: 99,\n    },\n    { name: t`Details`, link: `${match.url}/details`, id: 0 },\n    { name: t`Access`, link: `${match.url}/access`, id: 1 },\n    { name: t`Hosts`, link: `${match.url}/hosts`, id: 2 },\n    {\n      name: t`Jobs`,\n      link: `${match.url}/jobs`,\n      id: 3,\n    },\n    { name: t`Job Templates`, link: `${match.url}/job_templates`, id: 4 },\n  ];\n\n  if (hasContentLoading) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentLoading />\n        </Card>\n      </PageSection>\n    );\n  }\n\n  if (contentError) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={contentError}>\n            {contentError?.response?.status === 404 && (\n              <span>\n                {t`Smart Inventory not found.`}{' '}\n                <Link to=\"/inventories\">{t`View all Inventories.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  if (inventory?.kind === '') {\n    return <Redirect to={`/inventories/inventory/${inventory.id}/details`} />;\n  }\n\n  let showCardHeader = true;\n\n  if (['edit', 'hosts/'].some((name) => location.pathname.includes(name))) {\n    showCardHeader = false;\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n        <Switch>\n          <Redirect\n            from=\"/inventories/smart_inventory/:id\"\n            to=\"/inventories/smart_inventory/:id/details\"\n            exact\n          />\n          {inventory && [\n            <Route\n              key=\"details\"\n              path=\"/inventories/smart_inventory/:id/details\"\n            >\n              <SmartInventoryDetail\n                isLoading={hasContentLoading}\n                inventory={inventory}\n              />\n            </Route>,\n            <Route key=\"edit\" path=\"/inventories/smart_inventory/:id/edit\">\n              <SmartInventoryEdit inventory={inventory} />\n            </Route>,\n            <Route key=\"access\" path=\"/inventories/smart_inventory/:id/access\">\n              <ResourceAccessList\n                resource={inventory}\n                apiModel={InventoriesAPI}\n              />\n            </Route>,\n            <Route key=\"hosts\" path=\"/inventories/smart_inventory/:id/hosts\">\n              <SmartInventoryHosts\n                inventory={inventory}\n                setBreadcrumb={setBreadcrumb}\n              />\n            </Route>,\n            <Route key=\"jobs\" path=\"/inventories/smart_inventory/:id/jobs\">\n              <JobList\n                defaultParams={{\n                  or__job__inventory: inventory.id,\n                  or__adhoccommand__inventory: inventory.id,\n                  or__inventoryupdate__inventory_source__inventory:\n                    inventory.id,\n                  or__workflowjob__inventory: inventory.id,\n                }}\n              />\n            </Route>,\n            <Route\n              key=\"job_templates\"\n              path=\"/inventories/smart_inventory/:id/job_templates\"\n            >\n              <RelatedTemplateList\n                searchParams={{ inventory__id: inventory.id }}\n              />\n            </Route>,\n            <Route key=\"not-found\" path=\"*\">\n              {!hasContentLoading && (\n                <ContentError isNotFound>\n                  {match.params.id && (\n                    <Link\n                      to={`/inventories/smart_inventory/${match.params.id}/details`}\n                    >\n                      {t`View Inventory Details`}\n                    </Link>\n                  )}\n                </ContentError>\n              )}\n            </Route>,\n          ]}\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport { SmartInventory as _SmartInventory };\nexport default SmartInventory;\n"]},"metadata":{},"sourceType":"module"}