{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{Link,useHistory}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Host}from'types';import{CardBody,CardActionsRow}from'components/Card';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import Sparkline from'components/Sparkline';import DeleteButton from'components/DeleteButton';import{HostsAPI}from'api';import HostToggle from'components/HostToggle';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _StyledHostToggle=_styled(HostToggle).withConfig({displayName:\"InventoryHostDetail___StyledHostToggle\",componentId:\"rej13i-0\"})([\"padding-bottom:40px\"]);function InventoryHostDetail(_ref){var host=_ref.host;var created=host.created,description=host.description,id=host.id,modified=host.modified,name=host.name,variables=host.variables,_host$summary_fields=host.summary_fields,inventory=_host$summary_fields.inventory,recent_jobs=_host$summary_fields.recent_jobs,created_by=_host$summary_fields.created_by,modified_by=_host$summary_fields.modified_by,user_capabilities=_host$summary_fields.user_capabilities;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsloading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deletionError=_useState4[0],setDeletionError=_useState4[1];var history=useHistory();var handleHostDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsloading(true);_context.prev=1;_context.next=4;return HostsAPI.destroy(id);case 4:history.push(\"/inventories/inventory/\".concat(inventory.id,\"/hosts\"));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);setDeletionError(_context.t0);case 10:_context.prev=10;setIsloading(false);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,7,10,13]]);}));return function handleHostDelete(){return _ref2.apply(this,arguments);};}();if(!isLoading&&deletionError){return/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(false);},children:[/*i18n*/i18n._(\"Failed to delete {name}.\",{name:name}),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]});}var recentPlaybookJobs=recent_jobs.map(function(job){return _objectSpread(_objectSpread({},job),{},{type:'job'});});return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(_StyledHostToggle,{host:host}),/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Activity\"),value:/*#__PURE__*/_jsx(Sparkline,{jobs:recentPlaybookJobs}),isEmpty:(recentPlaybookJobs===null||recentPlaybookJobs===void 0?void 0:recentPlaybookJobs.length)===0}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(UserDateDetail,{date:created,label:/*i18n*/i18n._(\"Created\"),user:created_by}),/*#__PURE__*/_jsx(UserDateDetail,{date:modified,label:/*i18n*/i18n._(\"Last Modified\"),user:modified_by}),/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Variables\"),rows:4,value:variables,name:\"variables\",dataCy:\"inventory-host-detail-variables\"})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.edit)&&/*#__PURE__*/_jsx(Button,{ouiaId:\"inventory-host-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"edit\"),component:Link,to:\"/inventories/inventory/\".concat(inventory.id,\"/hosts/\").concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.delete)&&/*#__PURE__*/_jsx(DeleteButton,{name:name,modalTitle:/*i18n*/i18n._(\"Delete Host\"),onConfirm:function onConfirm(){return handleHostDelete();}})]}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(null);},children:[/*i18n*/i18n._(\"Failed to delete host.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default InventoryHostDetail;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventoryHostDetail/InventoryHostDetail.js"],"names":["React","useState","Link","useHistory","Button","Host","CardBody","CardActionsRow","AlertModal","ErrorDetail","DetailList","Detail","UserDateDetail","VariablesDetail","Sparkline","DeleteButton","HostsAPI","HostToggle","InventoryHostDetail","host","created","description","id","modified","name","variables","summary_fields","inventory","recent_jobs","created_by","modified_by","user_capabilities","isLoading","setIsloading","deletionError","setDeletionError","history","handleHostDelete","destroy","push","recentPlaybookJobs","map","job","type","length","edit","delete"],"mappings":"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","sourcesContent":["import 'styled-components/macro';\nimport React, { useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { Host } from 'types';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport Sparkline from 'components/Sparkline';\nimport DeleteButton from 'components/DeleteButton';\nimport { HostsAPI } from 'api';\nimport HostToggle from 'components/HostToggle';\n\nfunction InventoryHostDetail({ host }) {\n  const {\n    created,\n    description,\n    id,\n    modified,\n    name,\n    variables,\n    summary_fields: {\n      inventory,\n      recent_jobs,\n      created_by,\n      modified_by,\n      user_capabilities,\n    },\n  } = host;\n\n  const [isLoading, setIsloading] = useState(false);\n  const [deletionError, setDeletionError] = useState(false);\n  const history = useHistory();\n\n  const handleHostDelete = async () => {\n    setIsloading(true);\n    try {\n      await HostsAPI.destroy(id);\n      history.push(`/inventories/inventory/${inventory.id}/hosts`);\n    } catch (err) {\n      setDeletionError(err);\n    } finally {\n      setIsloading(false);\n    }\n  };\n\n  if (!isLoading && deletionError) {\n    return (\n      <AlertModal\n        isOpen={deletionError}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => setDeletionError(false)}\n      >\n        {t`Failed to delete ${name}.`}\n        <ErrorDetail error={deletionError} />\n      </AlertModal>\n    );\n  }\n\n  const recentPlaybookJobs = recent_jobs.map((job) => ({\n    ...job,\n    type: 'job',\n  }));\n\n  return (\n    <CardBody>\n      <HostToggle host={host} css=\"padding-bottom: 40px\" />\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} />\n        <Detail\n          label={t`Activity`}\n          value={<Sparkline jobs={recentPlaybookJobs} />}\n          isEmpty={recentPlaybookJobs?.length === 0}\n        />\n        <Detail label={t`Description`} value={description} />\n        <UserDateDetail date={created} label={t`Created`} user={created_by} />\n        <UserDateDetail\n          date={modified}\n          label={t`Last Modified`}\n          user={modified_by}\n        />\n        <VariablesDetail\n          label={t`Variables`}\n          rows={4}\n          value={variables}\n          name=\"variables\"\n          dataCy=\"inventory-host-detail-variables\"\n        />\n      </DetailList>\n      <CardActionsRow>\n        {user_capabilities?.edit && (\n          <Button\n            ouiaId=\"inventory-host-detail-edit-button\"\n            aria-label={t`edit`}\n            component={Link}\n            to={`/inventories/inventory/${inventory.id}/hosts/${id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {user_capabilities?.delete && (\n          <DeleteButton\n            name={name}\n            modalTitle={t`Delete Host`}\n            onConfirm={() => handleHostDelete()}\n          />\n        )}\n      </CardActionsRow>\n      {deletionError && (\n        <AlertModal\n          isOpen={deletionError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={() => setDeletionError(null)}\n        >\n          {t`Failed to delete host.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nInventoryHostDetail.propTypes = {\n  host: Host.isRequired,\n};\n\nexport default InventoryHostDetail;\n"]},"metadata":{},"sourceType":"module"}