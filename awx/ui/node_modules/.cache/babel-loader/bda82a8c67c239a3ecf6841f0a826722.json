{"ast":null,"code":"import _createForOfIteratorHelper from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";function isEqual(array1,array2){return array1.length===array2.length&&array1.every(function(element,index){return element.id===array2[index].id;});}var InstanceGroupsMixin=function InstanceGroupsMixin(parent){return/*#__PURE__*/function(_parent){_inherits(_class,_parent);var _super=_createSuper(_class);function _class(){_classCallCheck(this,_class);return _super.apply(this,arguments);}_createClass(_class,[{key:\"readInstanceGroups\",value:function readInstanceGroups(resourceId,params){return this.http.get(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{params:params});}},{key:\"associateInstanceGroup\",value:function associateInstanceGroup(resourceId,instanceGroupId){return this.http.post(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{id:instanceGroupId});}},{key:\"disassociateInstanceGroup\",value:function disassociateInstanceGroup(resourceId,instanceGroupId){return this.http.post(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{id:instanceGroupId,disassociate:true});}},{key:\"orderInstanceGroups\",value:function(){var _orderInstanceGroups=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resourceId,current,original){var _iterator,_step,group,_iterator2,_step2,_group;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isEqual(current,original)){_context.next=35;break;}_iterator=_createForOfIteratorHelper(original);_context.prev=2;_iterator.s();case 4:if((_step=_iterator.n()).done){_context.next=10;break;}group=_step.value;_context.next=8;return this.disassociateInstanceGroup(resourceId,group.id);case 8:_context.next=4;break;case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);_iterator.e(_context.t0);case 15:_context.prev=15;_iterator.f();return _context.finish(15);case 18:_iterator2=_createForOfIteratorHelper(current);_context.prev=19;_iterator2.s();case 21:if((_step2=_iterator2.n()).done){_context.next=27;break;}_group=_step2.value;_context.next=25;return this.associateInstanceGroup(resourceId,_group.id);case 25:_context.next=21;break;case 27:_context.next=32;break;case 29:_context.prev=29;_context.t1=_context[\"catch\"](19);_iterator2.e(_context.t1);case 32:_context.prev=32;_iterator2.f();return _context.finish(32);case 35:case\"end\":return _context.stop();}}},_callee,this,[[2,12,15,18],[19,29,32,35]]);}));function orderInstanceGroups(_x,_x2,_x3){return _orderInstanceGroups.apply(this,arguments);}return orderInstanceGroups;}()/* eslint-enable no-await-in-loop, no-restricted-syntax */}]);return _class;}(parent);};export default InstanceGroupsMixin;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/api/mixins/InstanceGroups.mixin.js"],"names":["isEqual","array1","array2","length","every","element","index","id","InstanceGroupsMixin","parent","resourceId","params","http","get","baseUrl","instanceGroupId","post","disassociate","current","original","group","disassociateInstanceGroup","associateInstanceGroup"],"mappings":"4tBAAA,QAASA,CAAAA,OAAT,CAAiBC,MAAjB,CAAyBC,MAAzB,CAAiC,CAC/B,MACED,CAAAA,MAAM,CAACE,MAAP,GAAkBD,MAAM,CAACC,MAAzB,EACAF,MAAM,CAACG,KAAP,CAAa,SAACC,OAAD,CAAUC,KAAV,QAAoBD,CAAAA,OAAO,CAACE,EAAR,GAAeL,MAAM,CAACI,KAAD,CAAN,CAAcC,EAAjD,EAAb,CAFF,CAID,CAED,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACC,MAAD,0OAExB,4BAAmBC,UAAnB,CAA+BC,MAA/B,CAAuC,CACrC,MAAO,MAAKC,IAAL,CAAUC,GAAV,WAAiB,KAAKC,OAAtB,SAAgCJ,UAAhC,sBAA+D,CACpEC,MAAM,CAANA,MADoE,CAA/D,CAAP,CAGD,CANuB,sCAQxB,gCAAuBD,UAAvB,CAAmCK,eAAnC,CAAoD,CAClD,MAAO,MAAKH,IAAL,CAAUI,IAAV,WAAkB,KAAKF,OAAvB,SAAiCJ,UAAjC,sBAAgE,CACrEH,EAAE,CAAEQ,eADiE,CAAhE,CAAP,CAGD,CAZuB,yCAcxB,mCAA0BL,UAA1B,CAAsCK,eAAtC,CAAuD,CACrD,MAAO,MAAKH,IAAL,CAAUI,IAAV,WAAkB,KAAKF,OAAvB,SAAiCJ,UAAjC,sBAAgE,CACrEH,EAAE,CAAEQ,eADiE,CAErEE,YAAY,CAAE,IAFuD,CAAhE,CAAP,CAID,CAnBuB,+HAqBxB,iBAA0BP,UAA1B,CAAsCQ,OAAtC,CAA+CC,QAA/C,wKAGOnB,OAAO,CAACkB,OAAD,CAAUC,QAAV,CAHd,+DAIwBA,QAJxB,8FAIeC,KAJf,mCAKY,MAAKC,yBAAL,CAA+BX,UAA/B,CAA2CU,KAAK,CAACb,EAAjD,CALZ,gQAOwBW,OAPxB,mGAOeE,MAPf,qCAQY,MAAKE,sBAAL,CAA4BZ,UAA5B,CAAwCU,MAAK,CAACb,EAA9C,CARZ,gTArBwB,6HAiCxB,0DAjCwB,oBACZE,MADY,GAA5B,CAoCA,cAAeD,CAAAA,mBAAf","sourcesContent":["function isEqual(array1, array2) {\n  return (\n    array1.length === array2.length &&\n    array1.every((element, index) => element.id === array2[index].id)\n  );\n}\n\nconst InstanceGroupsMixin = (parent) =>\n  class extends parent {\n    readInstanceGroups(resourceId, params) {\n      return this.http.get(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        params,\n      });\n    }\n\n    associateInstanceGroup(resourceId, instanceGroupId) {\n      return this.http.post(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        id: instanceGroupId,\n      });\n    }\n\n    disassociateInstanceGroup(resourceId, instanceGroupId) {\n      return this.http.post(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        id: instanceGroupId,\n        disassociate: true,\n      });\n    }\n\n    async orderInstanceGroups(resourceId, current, original) {\n      /* eslint-disable no-await-in-loop, no-restricted-syntax */\n      // Resolve Promises sequentially to maintain order and avoid race condition\n      if (!isEqual(current, original)) {\n        for (const group of original) {\n          await this.disassociateInstanceGroup(resourceId, group.id);\n        }\n        for (const group of current) {\n          await this.associateInstanceGroup(resourceId, group.id);\n        }\n      }\n    }\n    /* eslint-enable no-await-in-loop, no-restricted-syntax */\n  };\n\nexport default InstanceGroupsMixin;\n"]},"metadata":{},"sourceType":"module"}