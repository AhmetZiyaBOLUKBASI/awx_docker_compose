{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import{i18n}from\"@lingui/core\";import React,{useReducer,useEffect,useState}from'react';import{withRouter}from'react-router-dom';import{useField}from'formik';import{SearchIcon}from'@patternfly/react-icons';import{Button,ButtonVariant,Chip,InputGroup,Modal,TextInput}from'@patternfly/react-core';import styled from'styled-components';import useDebounce from'hooks/useDebounce';import{QSConfig}from'types';import ChipGroup from'../ChipGroup';import reducer,{initReducer}from'./shared/reducer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ChipHolder=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  --pf-c-form-control--Height: auto;\\n  background-color: \",\";\\n\"])),function(props){return props.isDisabled?'var(--pf-global--disabled-color--300)':null;});function Lookup(props){var _state$selectedItems;var id=props.id,header=props.header,onChange=props.onChange,onBlur=props.onBlur,isLoading=props.isLoading,value=props.value,multiple=props.multiple,required=props.required,qsConfig=props.qsConfig,renderItemChip=props.renderItemChip,renderOptionsList=props.renderOptionsList,history=props.history,isDisabled=props.isDisabled,onDebounce=props.onDebounce,fieldName=props.fieldName,_validate=props.validate,modalDescription=props.modalDescription,onUpdate=props.onUpdate;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),typedText=_useState2[0],setTypedText=_useState2[1];var debounceRequest=useDebounce(onDebounce,1000);useField({name:fieldName,validate:function validate(val){if(!multiple&&!val&&typedText&&typedText!==''){return(/*i18n*/i18n._(\"That value was not found. Please enter or select a valid value.\"));}return _validate(val);}});var _useReducer=useReducer(reducer,{value:value,multiple:multiple,required:required},initReducer),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){dispatch({type:'SET_MULTIPLE',value:multiple});},[multiple]);useEffect(function(){dispatch({type:'SET_VALUE',value:value});if(value!==null&&value!==void 0&&value.name){setTypedText(value.name);}else{setTypedText('');}},[value,multiple]);useEffect(function(){if(!multiple){setTypedText(state.selectedItems[0]?state.selectedItems[0].name:'');}},[state.selectedItems,multiple]);var clearQSParams=function clearQSParams(){if(!history.location.search){// This prevents \"Warning: Hash history cannot PUSH the same path;\n// a new entry will not be added to the history stack\" from appearing in the console.\nreturn;}var parts=history.location.search.replace(/^\\?/,'').split('&');var ns=qsConfig.namespace;var otherParts=parts.filter(function(param){return!param.startsWith(\"\".concat(ns,\".\"));});history.push(\"\".concat(history.location.pathname,\"?\").concat(otherParts.join('&')));};var save=function save(){var selectedItems=state.selectedItems;if(multiple){onChange(selectedItems);}else{onChange(selectedItems[0]||null);}clearQSParams();dispatch({type:'CLOSE_MODAL'});};var removeItem=function removeItem(item){return onChange(value.filter(function(i){return i.id!==item.id;}));};var closeModal=function closeModal(){clearQSParams();dispatch({type:'CLOSE_MODAL'});};var onClick=function onClick(){onUpdate();dispatch({type:'TOGGLE_MODAL'});};var isModalOpen=state.isModalOpen,selectedItems=state.selectedItems;var canDelete=(!required||multiple&&value.length>1)&&!isDisabled;var items=[];if(multiple){items=value;}else if(value){items.push(value);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(InputGroup,{onBlur:onBlur,children:[/*#__PURE__*/_jsx(Button,{\"aria-label\":/*i18n*/i18n._(\"Search\"),id:\"\".concat(id,\"-open\"),ouiaId:\"\".concat(id,\"-open\"),onClick:onClick,variant:ButtonVariant.control,isDisabled:isLoading||isDisabled,children:/*#__PURE__*/_jsx(SearchIcon,{})}),multiple?/*#__PURE__*/_jsx(ChipHolder,{isDisabled:isDisabled,className:\"pf-c-form-control\",children:/*#__PURE__*/_jsx(ChipGroup,{numChips:5,totalChips:items.length,ouiaId:\"\".concat(id,\"-chips\"),children:items.map(function(item){return renderItemChip({item:item,removeItem:removeItem,canDelete:canDelete});})})}):/*#__PURE__*/_jsx(TextInput,{id:id,ouiaId:\"\".concat(id,\"-input\"),value:typedText,onChange:function onChange(inputValue){setTypedText(inputValue);if((value===null||value===void 0?void 0:value.name)!==inputValue){debounceRequest(inputValue);}},isDisabled:isLoading||isDisabled})]}),/*#__PURE__*/_jsx(Modal,{variant:\"large\",title:/*i18n*/i18n._(\"Select {0}\",{0:header||t(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"Items\"])))}),\"aria-label\":/*i18n*/i18n._(\"Lookup modal\"),isOpen:isModalOpen,onClose:closeModal,description:(state===null||state===void 0?void 0:(_state$selectedItems=state.selectedItems)===null||_state$selectedItems===void 0?void 0:_state$selectedItems.length)>0&&modalDescription,ouiaId:\"\".concat(id,\"-modal\"),actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"modal-select-button\",variant:\"primary\",onClick:save,isDisabled:required&&selectedItems.length===0,children:/*i18n*/i18n._(\"Select\")},\"select\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"modal-cancel-button\",variant:\"link\",onClick:closeModal,\"aria-label\":/*i18n*/i18n._(\"Cancel lookup\"),children:/*i18n*/i18n._(\"Cancel\")},\"cancel\")],children:renderOptionsList({state:state,dispatch:dispatch,canDelete:canDelete})})]});}Lookup.defaultProps={id:'lookup-search',header:null,value:null,multiple:false,required:false,modalDescription:'',onBlur:function onBlur(){},renderItemChip:function renderItemChip(_ref){var item=_ref.item,removeItem=_ref.removeItem,canDelete=_ref.canDelete;return/*#__PURE__*/_jsx(Chip,{onClick:function onClick(){return removeItem(item);},isReadOnly:!canDelete,children:item.name},item.id);},validate:function validate(){return undefined;},onDebounce:function onDebounce(){return undefined;},onUpdate:function onUpdate(){},isDisabled:false};export{Lookup as _Lookup};export default withRouter(Lookup);","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/Lookup/Lookup.js"],"names":["React","useReducer","useEffect","useState","withRouter","useField","SearchIcon","Button","ButtonVariant","Chip","InputGroup","Modal","TextInput","styled","useDebounce","QSConfig","ChipGroup","reducer","initReducer","ChipHolder","div","props","isDisabled","Lookup","id","header","onChange","onBlur","isLoading","value","multiple","required","qsConfig","renderItemChip","renderOptionsList","history","onDebounce","fieldName","validate","modalDescription","onUpdate","typedText","setTypedText","debounceRequest","name","val","state","dispatch","type","selectedItems","clearQSParams","location","search","parts","replace","split","ns","namespace","otherParts","filter","param","startsWith","push","pathname","join","save","removeItem","item","i","closeModal","onClick","isModalOpen","canDelete","length","items","control","map","inputValue","t","defaultProps","undefined","_Lookup"],"mappings":"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","sourcesContent":["import React, { useReducer, useEffect, useState } from 'react';\nimport {\n  string,\n  bool,\n  arrayOf,\n  func,\n  number,\n  oneOfType,\n  shape,\n  node,\n  object,\n} from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useField } from 'formik';\nimport { SearchIcon } from '@patternfly/react-icons';\nimport {\n  Button,\n  ButtonVariant,\n  Chip,\n  InputGroup,\n  Modal,\n  TextInput,\n} from '@patternfly/react-core';\nimport { t } from '@lingui/macro';\nimport styled from 'styled-components';\nimport useDebounce from 'hooks/useDebounce';\nimport { QSConfig } from 'types';\nimport ChipGroup from '../ChipGroup';\nimport reducer, { initReducer } from './shared/reducer';\n\nconst ChipHolder = styled.div`\n  --pf-c-form-control--Height: auto;\n  background-color: ${(props) =>\n    props.isDisabled ? 'var(--pf-global--disabled-color--300)' : null};\n`;\nfunction Lookup(props) {\n  const {\n    id,\n    header,\n    onChange,\n    onBlur,\n    isLoading,\n    value,\n    multiple,\n    required,\n    qsConfig,\n    renderItemChip,\n    renderOptionsList,\n    history,\n    isDisabled,\n    onDebounce,\n    fieldName,\n    validate,\n    modalDescription,\n    onUpdate,\n  } = props;\n  const [typedText, setTypedText] = useState('');\n  const debounceRequest = useDebounce(onDebounce, 1000);\n  useField({\n    name: fieldName,\n    validate: (val) => {\n      if (!multiple && !val && typedText && typedText !== '') {\n        return t`That value was not found. Please enter or select a valid value.`;\n      }\n      return validate(val);\n    },\n  });\n\n  const [state, dispatch] = useReducer(\n    reducer,\n    { value, multiple, required },\n    initReducer\n  );\n\n  useEffect(() => {\n    dispatch({ type: 'SET_MULTIPLE', value: multiple });\n  }, [multiple]);\n\n  useEffect(() => {\n    dispatch({ type: 'SET_VALUE', value });\n    if (value?.name) {\n      setTypedText(value.name);\n    } else {\n      setTypedText('');\n    }\n  }, [value, multiple]);\n\n  useEffect(() => {\n    if (!multiple) {\n      setTypedText(state.selectedItems[0] ? state.selectedItems[0].name : '');\n    }\n  }, [state.selectedItems, multiple]);\n\n  const clearQSParams = () => {\n    if (!history.location.search) {\n      // This prevents \"Warning: Hash history cannot PUSH the same path;\n      // a new entry will not be added to the history stack\" from appearing in the console.\n      return;\n    }\n    const parts = history.location.search.replace(/^\\?/, '').split('&');\n    const ns = qsConfig.namespace;\n    const otherParts = parts.filter((param) => !param.startsWith(`${ns}.`));\n    history.push(`${history.location.pathname}?${otherParts.join('&')}`);\n  };\n\n  const save = () => {\n    const { selectedItems } = state;\n    if (multiple) {\n      onChange(selectedItems);\n    } else {\n      onChange(selectedItems[0] || null);\n    }\n    clearQSParams();\n    dispatch({ type: 'CLOSE_MODAL' });\n  };\n\n  const removeItem = (item) => onChange(value.filter((i) => i.id !== item.id));\n\n  const closeModal = () => {\n    clearQSParams();\n    dispatch({ type: 'CLOSE_MODAL' });\n  };\n\n  const onClick = () => {\n    onUpdate();\n    dispatch({ type: 'TOGGLE_MODAL' });\n  };\n\n  const { isModalOpen, selectedItems } = state;\n  const canDelete =\n    (!required || (multiple && value.length > 1)) && !isDisabled;\n  let items = [];\n  if (multiple) {\n    items = value;\n  } else if (value) {\n    items.push(value);\n  }\n\n  return (\n    <>\n      <InputGroup onBlur={onBlur}>\n        <Button\n          aria-label={t`Search`}\n          id={`${id}-open`}\n          ouiaId={`${id}-open`}\n          onClick={onClick}\n          variant={ButtonVariant.control}\n          isDisabled={isLoading || isDisabled}\n        >\n          <SearchIcon />\n        </Button>\n        {multiple ? (\n          <ChipHolder isDisabled={isDisabled} className=\"pf-c-form-control\">\n            <ChipGroup\n              numChips={5}\n              totalChips={items.length}\n              ouiaId={`${id}-chips`}\n            >\n              {items.map((item) =>\n                renderItemChip({\n                  item,\n                  removeItem,\n                  canDelete,\n                })\n              )}\n            </ChipGroup>\n          </ChipHolder>\n        ) : (\n          <TextInput\n            id={id}\n            ouiaId={`${id}-input`}\n            value={typedText}\n            onChange={(inputValue) => {\n              setTypedText(inputValue);\n              if (value?.name !== inputValue) {\n                debounceRequest(inputValue);\n              }\n            }}\n            isDisabled={isLoading || isDisabled}\n          />\n        )}\n      </InputGroup>\n\n      <Modal\n        variant=\"large\"\n        title={t`Select ${header || t`Items`}`}\n        aria-label={t`Lookup modal`}\n        isOpen={isModalOpen}\n        onClose={closeModal}\n        description={state?.selectedItems?.length > 0 && modalDescription}\n        ouiaId={`${id}-modal`}\n        actions={[\n          <Button\n            ouiaId=\"modal-select-button\"\n            key=\"select\"\n            variant=\"primary\"\n            onClick={save}\n            isDisabled={required && selectedItems.length === 0}\n          >\n            {t`Select`}\n          </Button>,\n          <Button\n            ouiaId=\"modal-cancel-button\"\n            key=\"cancel\"\n            variant=\"link\"\n            onClick={closeModal}\n            aria-label={t`Cancel lookup`}\n          >\n            {t`Cancel`}\n          </Button>,\n        ]}\n      >\n        {renderOptionsList({\n          state,\n          dispatch,\n          canDelete,\n        })}\n      </Modal>\n    </>\n  );\n}\n\nconst Item = shape({\n  id: number.isRequired,\n});\n\nLookup.propTypes = {\n  id: string,\n  header: string,\n  modalDescription: oneOfType([string, node]),\n  onChange: func.isRequired,\n  onUpdate: func,\n  value: oneOfType([Item, arrayOf(Item), object]),\n  multiple: bool,\n  required: bool,\n  onBlur: func,\n  qsConfig: QSConfig.isRequired,\n  renderItemChip: func,\n  renderOptionsList: func.isRequired,\n  fieldName: string.isRequired,\n  validate: func,\n  onDebounce: func,\n  isDisabled: bool,\n};\n\nLookup.defaultProps = {\n  id: 'lookup-search',\n  header: null,\n  value: null,\n  multiple: false,\n  required: false,\n  modalDescription: '',\n  onBlur: () => {},\n  renderItemChip: ({ item, removeItem, canDelete }) => (\n    <Chip\n      key={item.id}\n      onClick={() => removeItem(item)}\n      isReadOnly={!canDelete}\n    >\n      {item.name}\n    </Chip>\n  ),\n  validate: () => undefined,\n  onDebounce: () => undefined,\n  onUpdate: () => {},\n  isDisabled: false,\n};\n\nexport { Lookup as _Lookup };\nexport default withRouter(Lookup);\n"]},"metadata":{},"sourceType":"module"}