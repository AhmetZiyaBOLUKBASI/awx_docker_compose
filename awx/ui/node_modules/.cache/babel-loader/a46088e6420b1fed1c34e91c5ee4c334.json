{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import React,{useState,useEffect}from'react';import{withRouter}from'react-router-dom';import{Button,Nav,NavList,Page,PageHeader as PFPageHeader,PageHeaderTools,PageHeaderToolsGroup,PageHeaderToolsItem,PageSidebar}from'@patternfly/react-core';import styled from'styled-components';import{useConfig,useAuthorizedPath}from'contexts/Config';import{useSession}from'contexts/Session';import issuePendoIdentity from'util/issuePendoIdentity';import About from'../About';import BrandLogo from'./BrandLogo';import NavExpandableGroup from'./NavExpandableGroup';import PageHeaderToolbar from'./PageHeaderToolbar';import AlertModal from'../AlertModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PageHeader=styled(PFPageHeader)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  & .pf-c-page__header-brand-link {\\n    color: inherit;\\n    &:hover {\\n      color: inherit;\\n    }\\n  }\\n\"])));function AppContainer(_ref){var _config$license_info;var _ref$navRouteConfig=_ref.navRouteConfig,navRouteConfig=_ref$navRouteConfig===void 0?[]:_ref$navRouteConfig,children=_ref.children;var config=useConfig();var _useSession=useSession(),logout=_useSession.logout,handleSessionContinue=_useSession.handleSessionContinue,sessionCountdown=_useSession.sessionCountdown;var isReady=!!config.license_info;var isSidebarVisible=useAuthorizedPath();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAboutModalOpen=_useState2[0],setIsAboutModalOpen=_useState2[1];var handleAboutModalOpen=function handleAboutModalOpen(){return setIsAboutModalOpen(true);};var handleAboutModalClose=function handleAboutModalClose(){return setIsAboutModalOpen(false);};useEffect(function(){if('analytics_status'in config){issuePendoIdentity(config);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[config.analytics_status]);var brandName=config===null||config===void 0?void 0:(_config$license_info=config.license_info)===null||_config$license_info===void 0?void 0:_config$license_info.product_name;var alt=brandName?/*i18n*/i18n._(\"{brandName} logo\",{brandName:brandName}):/*i18n*/i18n._(\"brand logo\");var header=/*#__PURE__*/_jsx(PageHeader,{showNavToggle:true,logo:/*#__PURE__*/_jsx(BrandLogo,{alt:alt}),logoProps:{href:'/'},headerTools:/*#__PURE__*/_jsx(PageHeaderToolbar,{loggedInUser:config===null||config===void 0?void 0:config.me,isAboutDisabled:!(config!==null&&config!==void 0&&config.version),onAboutClick:handleAboutModalOpen,onLogoutClick:logout})});var simpleHeader=config.isLoading?null:/*#__PURE__*/_jsx(PageHeader,{logo:/*#__PURE__*/_jsx(BrandLogo,{alt:alt}),headerTools:/*#__PURE__*/_jsx(PageHeaderTools,{children:/*#__PURE__*/_jsx(PageHeaderToolsGroup,{children:/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Button,{onClick:logout,variant:\"tertiary\",ouiaId:\"logout\",children:/*i18n*/i18n._(\"Logout\")})})})})});var sidebar=/*#__PURE__*/_jsx(PageSidebar,{theme:\"dark\",nav:/*#__PURE__*/_jsx(Nav,{\"aria-label\":/*i18n*/i18n._(\"Navigation\"),theme:\"dark\",ouiaId:\"sidebar-navigation\",children:/*#__PURE__*/_jsx(NavList,{children:navRouteConfig.map(function(_ref2){var groupId=_ref2.groupId,groupTitle=_ref2.groupTitle,routes=_ref2.routes;return/*#__PURE__*/_jsx(NavExpandableGroup,{groupId:groupId,groupTitle:groupTitle,routes:routes},groupId);})})})});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Page,{isManagedSidebar:isSidebarVisible,header:isSidebarVisible?header:simpleHeader,sidebar:isSidebarVisible&&sidebar,children:isReady?children:null}),/*#__PURE__*/_jsx(About,{version:config===null||config===void 0?void 0:config.version,isOpen:isAboutModalOpen,onClose:handleAboutModalClose}),/*#__PURE__*/_jsx(AlertModal,{ouiaId:\"session-expiration-modal\",title:/*i18n*/i18n._(\"Your session is about to expire\"),isOpen:sessionCountdown&&sessionCountdown>0,onClose:logout,showClose:false,variant:\"warning\",actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"session-expiration-continue-button\",variant:\"primary\",onClick:handleSessionContinue,children:/*i18n*/i18n._(\"Continue\")},\"confirm\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"session-expiration-logout-button\",variant:\"secondary\",onClick:logout,children:/*i18n*/i18n._(\"Logout\")},\"logout\")],children:/*#__PURE__*/_jsx(Trans,{id:\"{sessionCountdown, plural, one {You will be logged out in # second due to inactivity} other {You will be logged out in # seconds due to inactivity}}\",values:{sessionCountdown:sessionCountdown}})})]});}export{AppContainer as _AppContainer};export default withRouter(AppContainer);","map":{"version":3,"sources":["/awx_devel/awx/ui/src/components/AppContainer/AppContainer.js"],"names":["React","useState","useEffect","withRouter","Button","Nav","NavList","Page","PageHeader","PFPageHeader","PageHeaderTools","PageHeaderToolsGroup","PageHeaderToolsItem","PageSidebar","styled","useConfig","useAuthorizedPath","useSession","issuePendoIdentity","About","BrandLogo","NavExpandableGroup","PageHeaderToolbar","AlertModal","AppContainer","navRouteConfig","children","config","logout","handleSessionContinue","sessionCountdown","isReady","license_info","isSidebarVisible","isAboutModalOpen","setIsAboutModalOpen","handleAboutModalOpen","handleAboutModalClose","analytics_status","brandName","product_name","alt","header","href","me","version","simpleHeader","isLoading","sidebar","map","groupId","groupTitle","routes","_AppContainer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport {\n  Button,\n  Nav,\n  NavList,\n  Page,\n  PageHeader as PFPageHeader,\n  PageHeaderTools,\n  PageHeaderToolsGroup,\n  PageHeaderToolsItem,\n  PageSidebar,\n} from '@patternfly/react-core';\nimport { t, Plural } from '@lingui/macro';\n\nimport styled from 'styled-components';\n\nimport { useConfig, useAuthorizedPath } from 'contexts/Config';\nimport { useSession } from 'contexts/Session';\nimport issuePendoIdentity from 'util/issuePendoIdentity';\nimport About from '../About';\nimport BrandLogo from './BrandLogo';\nimport NavExpandableGroup from './NavExpandableGroup';\nimport PageHeaderToolbar from './PageHeaderToolbar';\nimport AlertModal from '../AlertModal';\n\nconst PageHeader = styled(PFPageHeader)`\n  & .pf-c-page__header-brand-link {\n    color: inherit;\n    &:hover {\n      color: inherit;\n    }\n  }\n`;\n\nfunction AppContainer({ navRouteConfig = [], children }) {\n  const config = useConfig();\n  const { logout, handleSessionContinue, sessionCountdown } = useSession();\n\n  const isReady = !!config.license_info;\n  const isSidebarVisible = useAuthorizedPath();\n  const [isAboutModalOpen, setIsAboutModalOpen] = useState(false);\n\n  const handleAboutModalOpen = () => setIsAboutModalOpen(true);\n  const handleAboutModalClose = () => setIsAboutModalOpen(false);\n\n  useEffect(() => {\n    if ('analytics_status' in config) {\n      issuePendoIdentity(config);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [config.analytics_status]);\n\n  const brandName = config?.license_info?.product_name;\n  const alt = brandName ? t`${brandName} logo` : t`brand logo`;\n\n  const header = (\n    <PageHeader\n      showNavToggle\n      logo={<BrandLogo alt={alt} />}\n      logoProps={{ href: '/' }}\n      headerTools={\n        <PageHeaderToolbar\n          loggedInUser={config?.me}\n          isAboutDisabled={!config?.version}\n          onAboutClick={handleAboutModalOpen}\n          onLogoutClick={logout}\n        />\n      }\n    />\n  );\n\n  const simpleHeader = config.isLoading ? null : (\n    <PageHeader\n      logo={<BrandLogo alt={alt} />}\n      headerTools={\n        <PageHeaderTools>\n          <PageHeaderToolsGroup>\n            <PageHeaderToolsItem>\n              <Button onClick={logout} variant=\"tertiary\" ouiaId=\"logout\">\n                {t`Logout`}\n              </Button>\n            </PageHeaderToolsItem>\n          </PageHeaderToolsGroup>\n        </PageHeaderTools>\n      }\n    />\n  );\n\n  const sidebar = (\n    <PageSidebar\n      theme=\"dark\"\n      nav={\n        <Nav\n          aria-label={t`Navigation`}\n          theme=\"dark\"\n          ouiaId=\"sidebar-navigation\"\n        >\n          <NavList>\n            {navRouteConfig.map(({ groupId, groupTitle, routes }) => (\n              <NavExpandableGroup\n                key={groupId}\n                groupId={groupId}\n                groupTitle={groupTitle}\n                routes={routes}\n              />\n            ))}\n          </NavList>\n        </Nav>\n      }\n    />\n  );\n\n  return (\n    <>\n      <Page\n        isManagedSidebar={isSidebarVisible}\n        header={isSidebarVisible ? header : simpleHeader}\n        sidebar={isSidebarVisible && sidebar}\n      >\n        {isReady ? children : null}\n      </Page>\n      <About\n        version={config?.version}\n        isOpen={isAboutModalOpen}\n        onClose={handleAboutModalClose}\n      />\n      <AlertModal\n        ouiaId=\"session-expiration-modal\"\n        title={t`Your session is about to expire`}\n        isOpen={sessionCountdown && sessionCountdown > 0}\n        onClose={logout}\n        showClose={false}\n        variant=\"warning\"\n        actions={[\n          <Button\n            ouiaId=\"session-expiration-continue-button\"\n            key=\"confirm\"\n            variant=\"primary\"\n            onClick={handleSessionContinue}\n          >\n            {t`Continue`}\n          </Button>,\n          <Button\n            ouiaId=\"session-expiration-logout-button\"\n            key=\"logout\"\n            variant=\"secondary\"\n            onClick={logout}\n          >\n            {t`Logout`}\n          </Button>,\n        ]}\n      >\n        <Plural\n          value={sessionCountdown}\n          one=\"You will be logged out in # second due to inactivity\"\n          other=\"You will be logged out in # seconds due to inactivity\"\n        />\n      </AlertModal>\n    </>\n  );\n}\n\nexport { AppContainer as _AppContainer };\nexport default withRouter(AppContainer);\n"]},"metadata":{},"sourceType":"module"}