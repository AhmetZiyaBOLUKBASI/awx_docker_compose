{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{useLocation}from'react-router-dom';import{OrganizationsAPI}from'api';import PaginatedTable,{HeaderRow,HeaderCell,getSearchableKeys}from'components/PaginatedTable';import{getQSConfig,parseQueryString}from'util/qs';import useRequest from'hooks/useRequest';import OrganizationTeamListItem from'./OrganizationTeamListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('team',{page:1,page_size:5,order_by:'name'});function OrganizationTeamList(_ref){var id=_ref.id;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _actionsResponse$data,_actionsResponse$data2;var params,_yield$Promise$all,_yield$Promise$all2,response,actionsResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([OrganizationsAPI.readTeams(id,params),OrganizationsAPI.readTeamsOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);response=_yield$Promise$all2[0];actionsResponse=_yield$Promise$all2[1];return _context.abrupt(\"return\",{teams:response.data.results,count:response.data.count,relatedSearchableKeys:((actionsResponse===null||actionsResponse===void 0?void 0:(_actionsResponse$data=actionsResponse.data)===null||_actionsResponse$data===void 0?void 0:_actionsResponse$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_actionsResponse$data2=actionsResponse.data.actions)===null||_actionsResponse$data2===void 0?void 0:_actionsResponse$data2.GET)});case 8:case\"end\":return _context.stop();}}},_callee);})),[id,location]),{teams:[],count:0,relatedSearchableKeys:[],searchableKeys:[]}),_useRequest$result=_useRequest.result,teams=_useRequest$result.teams,count=_useRequest$result.count,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys,error=_useRequest.error,isLoading=_useRequest.isLoading,fetchTeams=_useRequest.request;useEffect(function(){fetchTeams();},[fetchTeams]);return/*#__PURE__*/_jsx(PaginatedTable,{contentError:error,hasContentLoading:isLoading,items:teams,itemCount:count,pluralizedItemName:/*i18n*/i18n._(\"Teams\"),qsConfig:QS_CONFIG,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Created by (username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified by (username)\"),key:'modified_by__username__icontains'}],toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Actions\")})]}),renderRow:function renderRow(item){return/*#__PURE__*/_jsx(OrganizationTeamListItem,{value:item.name,team:item,detailUrl:\"/teams/\".concat(item.id)},item.id);}});}export{OrganizationTeamList as _OrganizationTeamList};export default OrganizationTeamList;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Organization/OrganizationTeams/OrganizationTeamList.js"],"names":["React","useCallback","useEffect","useLocation","OrganizationsAPI","PaginatedTable","HeaderRow","HeaderCell","getSearchableKeys","getQSConfig","parseQueryString","useRequest","OrganizationTeamListItem","QS_CONFIG","page","page_size","order_by","OrganizationTeamList","id","location","params","search","Promise","all","readTeams","readTeamsOptions","response","actionsResponse","teams","data","results","count","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","actions","GET","result","error","isLoading","fetchTeams","request","name","key","isDefault","item","_OrganizationTeamList"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useLocation } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { OrganizationsAPI } from 'api';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport OrganizationTeamListItem from './OrganizationTeamListItem';\n\nconst QS_CONFIG = getQSConfig('team', {\n  page: 1,\n  page_size: 5,\n  order_by: 'name',\n});\n\nfunction OrganizationTeamList({ id }) {\n  const location = useLocation();\n\n  const {\n    result: { teams, count, relatedSearchableKeys, searchableKeys },\n    error,\n    isLoading,\n    request: fetchTeams,\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const [response, actionsResponse] = await Promise.all([\n        OrganizationsAPI.readTeams(id, params),\n        OrganizationsAPI.readTeamsOptions(id),\n      ]);\n      return {\n        teams: response.data.results,\n        count: response.data.count,\n        relatedSearchableKeys: (\n          actionsResponse?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(actionsResponse.data.actions?.GET),\n      };\n    }, [id, location]),\n    {\n      teams: [],\n      count: 0,\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchTeams();\n  }, [fetchTeams]);\n\n  return (\n    <PaginatedTable\n      contentError={error}\n      hasContentLoading={isLoading}\n      items={teams}\n      itemCount={count}\n      pluralizedItemName={t`Teams`}\n      qsConfig={QS_CONFIG}\n      toolbarSearchColumns={[\n        {\n          name: t`Name`,\n          key: 'name__icontains',\n          isDefault: true,\n        },\n        {\n          name: t`Created by (username)`,\n          key: 'created_by__username__icontains',\n        },\n        {\n          name: t`Modified by (username)`,\n          key: 'modified_by__username__icontains',\n        },\n      ]}\n      toolbarSearchableKeys={searchableKeys}\n      toolbarRelatedSearchableKeys={relatedSearchableKeys}\n      headerRow={\n        <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n          <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n          <HeaderCell>{t`Actions`}</HeaderCell>\n        </HeaderRow>\n      }\n      renderRow={(item) => (\n        <OrganizationTeamListItem\n          key={item.id}\n          value={item.name}\n          team={item}\n          detailUrl={`/teams/${item.id}`}\n        />\n      )}\n    />\n  );\n}\n\nOrganizationTeamList.propTypes = {\n  id: PropTypes.number.isRequired,\n};\n\nexport { OrganizationTeamList as _OrganizationTeamList };\nexport default OrganizationTeamList;\n"]},"metadata":{},"sourceType":"module"}