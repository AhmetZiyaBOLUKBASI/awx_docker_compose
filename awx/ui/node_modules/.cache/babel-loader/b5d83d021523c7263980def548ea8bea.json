{"ast":null,"code":"import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{i18n}from\"@lingui/core\";import React from'react';import{Link}from'react-router-dom';import{Button,Tooltip}from'@patternfly/react-core';import{Tr,Td}from'@patternfly/react-table';import{ExclamationTriangleIcon as PFExclamationTriangleIcon,PencilAltIcon}from'@patternfly/react-icons';import styled from'styled-components';import{ActionsTd,ActionItem,TdBreakWord}from'components/PaginatedTable';import StatusLabel from'components/StatusLabel';import JobCancelButton from'components/JobCancelButton';import{formatDateString}from'util/dates';import{isJobRunning}from'util/jobs';import InventorySourceSyncButton from'../shared/InventorySourceSyncButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ExclamationTriangleIcon=styled(PFExclamationTriangleIcon)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  color: var(--pf-global--warning-color--100);\\n  margin-left: 18px;\\n\"])));function InventorySourceListItem(_ref){var _source$summary_field,_source$summary_field2,_job,_source$summary_field3,_source$summary_field4,_source$summary_field5,_source$summary_field6;var source=_ref.source,isSelected=_ref.isSelected,onSelect=_ref.onSelect,detailUrl=_ref.detailUrl,label=_ref.label,rowIndex=_ref.rowIndex;var generateLastJobTooltip=function generateLastJobTooltip(job){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*i18n*/i18n._(\"MOST RECENT SYNC\")}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"JOB ID:\"),\" \",job.id]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"STATUS:\"),\" \",job.status.toUpperCase()]}),job.finished&&/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"FINISHED:\"),\" \",formatDateString(job.finished)]})]});};var missingExecutionEnvironment=source.custom_virtualenv&&!source.execution_environment;var job=null;if((_source$summary_field=source.summary_fields)!==null&&_source$summary_field!==void 0&&_source$summary_field.current_job){job=source.summary_fields.current_job;}else if((_source$summary_field2=source.summary_fields)!==null&&_source$summary_field2!==void 0&&_source$summary_field2.last_job){job=source.summary_fields.last_job;}return/*#__PURE__*/_jsxs(Tr,{id:\"source-row-\".concat(source.id),ouiaId:\"source-row-\".concat(source.id),children:[/*#__PURE__*/_jsx(Td,{\"data-cy\":\"check-action-\".concat(source.id),select:{rowIndex:rowIndex,isSelected:isSelected,onSelect:onSelect,disable:isJobRunning(source.status)}}),/*#__PURE__*/_jsxs(TdBreakWord,{dataLabel:/*i18n*/i18n._(\"Name\"),children:[/*#__PURE__*/_jsx(Link,{to:\"\".concat(detailUrl,\"/details\"),children:/*#__PURE__*/_jsx(\"b\",{children:source.name})}),missingExecutionEnvironment&&/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Tooltip,{className:\"missing-execution-environment\",content:/*i18n*/i18n._(\"Custom virtual environment {0} must be replaced by an execution environment.\",{0:source.custom_virtualenv}),position:\"right\",children:/*#__PURE__*/_jsx(ExclamationTriangleIcon,{})})})]}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Status\"),children:job&&/*#__PURE__*/_jsx(Tooltip,{position:\"top\",content:generateLastJobTooltip(job),children:/*#__PURE__*/_jsx(Link,{to:\"/jobs/inventory/\".concat(job.id),children:/*#__PURE__*/_jsx(StatusLabel,{status:job.status})})},job.id)}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Type\"),children:label}),/*#__PURE__*/_jsxs(ActionsTd,{dataLabel:/*i18n*/i18n._(\"Actions\"),children:[['running','pending','waiting'].includes((_job=job)===null||_job===void 0?void 0:_job.status)?/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.start,children:((_source$summary_field3=source.summary_fields)===null||_source$summary_field3===void 0?void 0:(_source$summary_field4=_source$summary_field3.current_job)===null||_source$summary_field4===void 0?void 0:_source$summary_field4.id)&&/*#__PURE__*/_jsx(JobCancelButton,{job:{type:'inventory_update',id:source===null||source===void 0?void 0:(_source$summary_field5=source.summary_fields)===null||_source$summary_field5===void 0?void 0:(_source$summary_field6=_source$summary_field5.current_job)===null||_source$summary_field6===void 0?void 0:_source$summary_field6.id},errorTitle:/*i18n*/i18n._(\"Inventory Source Sync Error\"),errorMessage:/*i18n*/i18n._(\"Failed to cancel Inventory Source Sync\"),title:/*i18n*/i18n._(\"Cancel Inventory Source Sync\"),showIconButton:true})}):/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.start,tooltip:/*i18n*/i18n._(\"Sync\"),children:/*#__PURE__*/_jsx(InventorySourceSyncButton,{source:source})}),/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.edit,tooltip:/*i18n*/i18n._(\"Edit\"),children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(source.id,\"-edit-button\"),\"aria-label\":/*i18n*/i18n._(\"Edit Source\"),variant:\"plain\",component:Link,to:\"\".concat(detailUrl,\"/edit\"),children:/*#__PURE__*/_jsx(PencilAltIcon,{})})})]})]});}export default InventorySourceListItem;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventorySources/InventorySourceListItem.js"],"names":["React","Link","Button","Tooltip","Tr","Td","ExclamationTriangleIcon","PFExclamationTriangleIcon","PencilAltIcon","styled","ActionsTd","ActionItem","TdBreakWord","StatusLabel","JobCancelButton","formatDateString","isJobRunning","InventorySourceSyncButton","InventorySourceListItem","source","isSelected","onSelect","detailUrl","label","rowIndex","generateLastJobTooltip","job","id","status","toUpperCase","finished","missingExecutionEnvironment","custom_virtualenv","execution_environment","summary_fields","current_job","last_job","disable","name","includes","user_capabilities","start","type","edit"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport { Button, Tooltip } from '@patternfly/react-core';\nimport { Tr, Td } from '@patternfly/react-table';\nimport {\n  ExclamationTriangleIcon as PFExclamationTriangleIcon,\n  PencilAltIcon,\n} from '@patternfly/react-icons';\nimport styled from 'styled-components';\n\nimport { ActionsTd, ActionItem, TdBreakWord } from 'components/PaginatedTable';\nimport StatusLabel from 'components/StatusLabel';\nimport JobCancelButton from 'components/JobCancelButton';\nimport { formatDateString } from 'util/dates';\nimport { isJobRunning } from 'util/jobs';\nimport InventorySourceSyncButton from '../shared/InventorySourceSyncButton';\n\nconst ExclamationTriangleIcon = styled(PFExclamationTriangleIcon)`\n  color: var(--pf-global--warning-color--100);\n  margin-left: 18px;\n`;\n\nfunction InventorySourceListItem({\n  source,\n  isSelected,\n  onSelect,\n  detailUrl,\n  label,\n  rowIndex,\n}) {\n  const generateLastJobTooltip = (job) => (\n    <>\n      <div>{t`MOST RECENT SYNC`}</div>\n      <div>\n        {t`JOB ID:`} {job.id}\n      </div>\n      <div>\n        {t`STATUS:`} {job.status.toUpperCase()}\n      </div>\n      {job.finished && (\n        <div>\n          {t`FINISHED:`} {formatDateString(job.finished)}\n        </div>\n      )}\n    </>\n  );\n\n  const missingExecutionEnvironment =\n    source.custom_virtualenv && !source.execution_environment;\n\n  let job = null;\n\n  if (source.summary_fields?.current_job) {\n    job = source.summary_fields.current_job;\n  } else if (source.summary_fields?.last_job) {\n    job = source.summary_fields.last_job;\n  }\n\n  return (\n    <Tr id={`source-row-${source.id}`} ouiaId={`source-row-${source.id}`}>\n      <Td\n        data-cy={`check-action-${source.id}`}\n        select={{\n          rowIndex,\n          isSelected,\n          onSelect,\n          disable: isJobRunning(source.status),\n        }}\n      />\n      <TdBreakWord dataLabel={t`Name`}>\n        <Link to={`${detailUrl}/details`}>\n          <b>{source.name}</b>\n        </Link>\n        {missingExecutionEnvironment && (\n          <span>\n            <Tooltip\n              className=\"missing-execution-environment\"\n              content={t`Custom virtual environment ${source.custom_virtualenv} must be replaced by an execution environment.`}\n              position=\"right\"\n            >\n              <ExclamationTriangleIcon />\n            </Tooltip>\n          </span>\n        )}\n      </TdBreakWord>\n      <Td dataLabel={t`Status`}>\n        {job && (\n          <Tooltip\n            position=\"top\"\n            content={generateLastJobTooltip(job)}\n            key={job.id}\n          >\n            <Link to={`/jobs/inventory/${job.id}`}>\n              <StatusLabel status={job.status} />\n            </Link>\n          </Tooltip>\n        )}\n      </Td>\n      <Td dataLabel={t`Type`}>{label}</Td>\n      <ActionsTd dataLabel={t`Actions`}>\n        {['running', 'pending', 'waiting'].includes(job?.status) ? (\n          <ActionItem visible={source.summary_fields.user_capabilities.start}>\n            {source.summary_fields?.current_job?.id && (\n              <JobCancelButton\n                job={{\n                  type: 'inventory_update',\n                  id: source?.summary_fields?.current_job?.id,\n                }}\n                errorTitle={t`Inventory Source Sync Error`}\n                errorMessage={t`Failed to cancel Inventory Source Sync`}\n                title={t`Cancel Inventory Source Sync`}\n                showIconButton\n              />\n            )}\n          </ActionItem>\n        ) : (\n          <ActionItem\n            visible={source.summary_fields.user_capabilities.start}\n            tooltip={t`Sync`}\n          >\n            <InventorySourceSyncButton source={source} />\n          </ActionItem>\n        )}\n        <ActionItem\n          visible={source.summary_fields.user_capabilities.edit}\n          tooltip={t`Edit`}\n        >\n          <Button\n            ouiaId={`${source.id}-edit-button`}\n            aria-label={t`Edit Source`}\n            variant=\"plain\"\n            component={Link}\n            to={`${detailUrl}/edit`}\n          >\n            <PencilAltIcon />\n          </Button>\n        </ActionItem>\n      </ActionsTd>\n    </Tr>\n  );\n}\nexport default InventorySourceListItem;\n"]},"metadata":{},"sourceType":"module"}