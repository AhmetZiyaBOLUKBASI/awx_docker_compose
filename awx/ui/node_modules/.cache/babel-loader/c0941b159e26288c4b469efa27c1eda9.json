{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled4 from\"styled-components\";import _styled3 from\"styled-components\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import styled from'styled-components';import{useField}from'formik';import{Alert,Form,FormGroup,TextInput,Select,SelectVariant,SelectOption}from'@patternfly/react-core';import{required}from'util/validators';import{FormColumnLayout,FormFullWidthLayout}from'components/FormLayout';import Popover from'components/Popover';import AnsibleSelect from'components/AnsibleSelect';import FormField from'components/FormField';import getDocsBaseUrl from'util/getDocsBaseUrl';import{useConfig,useUserProfile}from'contexts/Config';import InventorySourcesList from'./InventorySourcesList';import JobTemplatesList from'./JobTemplatesList';import ProjectsList from'./ProjectsList';import SystemJobTemplatesList from'./SystemJobTemplatesList';import WorkflowJobTemplatesList from'./WorkflowJobTemplatesList';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NodeTypeErrorAlert=styled(Alert).withConfig({displayName:\"NodeTypeStep__NodeTypeErrorAlert\",componentId:\"by2mqr-0\"})([\"margin-bottom:20px;\"]);var TimeoutInput=styled(TextInput).withConfig({displayName:\"NodeTypeStep__TimeoutInput\",componentId:\"by2mqr-1\"})([\"width:200px !important;:not(:first-of-type){margin-left:20px;}\"]);TimeoutInput.displayName='TimeoutInput';var TimeoutLabel=styled.p.withConfig({displayName:\"NodeTypeStep__TimeoutLabel\",componentId:\"by2mqr-2\"})([\"margin-left:10px;min-width:fit-content;\"]);var _StyledDiv=styled(\"div\").withConfig({displayName:\"NodeTypeStep___StyledDiv\",componentId:\"by2mqr-3\"})([\"display:flex;align-items:center;margin-bottom:20px;\"]);var _StyledB=styled(\"b\").withConfig({displayName:\"NodeTypeStep___StyledB\",componentId:\"by2mqr-4\"})([\"margin-right:24px\"]);var _StyledForm=styled(Form).withConfig({displayName:\"NodeTypeStep___StyledForm\",componentId:\"by2mqr-5\"})([\"margin-top:20px;\"]);var _StyledDiv2=styled(\"div\").withConfig({displayName:\"NodeTypeStep___StyledDiv2\",componentId:\"by2mqr-6\"})([\"display:flex;align-items:center;\"]);function NodeTypeStep(_ref){var isIdentifierRequired=_ref.isIdentifierRequired;var _useUserProfile=useUserProfile(),isSuperUser=_useUserProfile.isSuperUser;var _useField=useField('nodeType'),_useField2=_slicedToArray(_useField,3),nodeTypeField=_useField2[0],nodeTypeHelpers=_useField2[2];var _useField3=useField('nodeResource'),_useField4=_slicedToArray(_useField3,3),nodeResourceField=_useField4[0],nodeResourceMeta=_useField4[1],nodeResourceHelpers=_useField4[2];var _useField5=useField('approvalName'),_useField6=_slicedToArray(_useField5,3),approvalNameMeta=_useField6[1],approvalNameHelpers=_useField6[2];var _useField7=useField('approvalDescription'),_useField8=_slicedToArray(_useField7,3),approvalDescriptionHelpers=_useField8[2];var _useField9=useField('timeoutMinutes'),_useField10=_slicedToArray(_useField9,3),timeoutMinutesField=_useField10[0],timeoutMinutesHelpers=_useField10[2];var _useField11=useField('timeoutSeconds'),_useField12=_slicedToArray(_useField11,3),timeoutSecondsField=_useField12[0],timeoutSecondsHelpers=_useField12[2];var _useField13=useField('convergence'),_useField14=_slicedToArray(_useField13,3),convergenceField=_useField14[0],convergenceFieldHelpers=_useField14[2];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isConvergenceOpen=_useState2[0],setIsConvergenceOpen=_useState2[1];var config=useConfig();var isValid=!approvalNameMeta.touched||!approvalNameMeta.error;var nodeTypeChoices=[{key:'workflow_approval_template',value:'workflow_approval_template',label:/*i18n*/i18n._(\"Approval\"),isDisabled:false},{key:'inventory_source',value:'inventory_source',label:/*i18n*/i18n._(\"Inventory Source Sync\"),isDisabled:false},{key:'job_template',value:'job_template',label:/*i18n*/i18n._(\"Job Template\"),isDisabled:false},{key:'project',value:'project',label:/*i18n*/i18n._(\"Project Sync\"),isDisabled:false},{key:'workflow_job_template',value:'workflow_job_template',label:/*i18n*/i18n._(\"Workflow Job Template\"),isDisabled:false}];var modifiedNodeTypeChoices=isSuperUser?[].concat(nodeTypeChoices,[{key:'system_job_template',value:'system_job_template',label:/*i18n*/i18n._(\"Management Job\"),isDisabled:false}]):nodeTypeChoices;return/*#__PURE__*/_jsxs(_Fragment,{children:[nodeResourceMeta.error&&/*#__PURE__*/_jsx(NodeTypeErrorAlert,{variant:\"danger\",isInline:true,title:nodeResourceMeta.error}),/*#__PURE__*/_jsxs(_StyledDiv,{children:[/*#__PURE__*/_jsx(_StyledB,{children:/*i18n*/i18n._(\"Node Type\")}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(AnsibleSelect,{id:\"nodeResource-select\",label:/*i18n*/i18n._(\"Select a Node Type\"),data:modifiedNodeTypeChoices,value:nodeTypeField.value,onChange:function onChange(e,val){nodeTypeHelpers.setValue(val);nodeResourceHelpers.setValue(null);approvalNameHelpers.setValue('');approvalDescriptionHelpers.setValue('');timeoutMinutesHelpers.setValue(0);timeoutSecondsHelpers.setValue(0);convergenceFieldHelpers.setValue('any');}})})]}),nodeTypeField.value==='job_template'&&/*#__PURE__*/_jsx(JobTemplatesList,{nodeResource:nodeResourceField.value,onUpdateNodeResource:nodeResourceHelpers.setValue}),nodeTypeField.value==='project'&&/*#__PURE__*/_jsx(ProjectsList,{nodeResource:nodeResourceField.value,onUpdateNodeResource:nodeResourceHelpers.setValue}),nodeTypeField.value==='inventory_source'&&/*#__PURE__*/_jsx(InventorySourcesList,{nodeResource:nodeResourceField.value,onUpdateNodeResource:nodeResourceHelpers.setValue}),nodeTypeField.value==='system_job_template'&&/*#__PURE__*/_jsx(SystemJobTemplatesList,{nodeResource:nodeResourceField.value,onUpdateNodeResource:nodeResourceHelpers.setValue}),nodeTypeField.value==='workflow_job_template'&&/*#__PURE__*/_jsx(WorkflowJobTemplatesList,{nodeResource:nodeResourceField.value,onUpdateNodeResource:nodeResourceHelpers.setValue}),/*#__PURE__*/_jsx(_StyledForm,{children:/*#__PURE__*/_jsx(FormColumnLayout,{children:/*#__PURE__*/_jsxs(FormFullWidthLayout,{children:[nodeTypeField.value==='workflow_approval_template'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FormField,{name:\"approvalName\",id:\"approval-name\",isRequired:true,validate:required(null),validated:isValid?'default':'error',label:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(FormField,{name:\"approvalDescription\",id:\"approval-description\",label:/*i18n*/i18n._(\"Description\")}),/*#__PURE__*/_jsx(FormGroup,{label:/*i18n*/i18n._(\"Timeout\"),fieldId:\"approval-timeout\",name:\"timeout\",children:/*#__PURE__*/_jsxs(_StyledDiv2,{children:[/*#__PURE__*/_jsx(TimeoutInput,_objectSpread(_objectSpread({},timeoutMinutesField),{},{\"aria-label\":/*i18n*/i18n._(\"Timeout minutes\"),id:\"approval-timeout-minutes\",min:\"0\",onChange:function onChange(value,event){timeoutMinutesField.onChange(event);},step:\"1\",type:\"number\"})),/*#__PURE__*/_jsx(TimeoutLabel,{children:/*#__PURE__*/_jsx(Trans,{id:\"min\"})}),/*#__PURE__*/_jsx(TimeoutInput,_objectSpread(_objectSpread({},timeoutSecondsField),{},{\"aria-label\":/*i18n*/i18n._(\"Timeout seconds\"),id:\"approval-timeout-seconds\",min:\"0\",onChange:function onChange(value,event){timeoutSecondsField.onChange(event);},step:\"1\",type:\"number\"})),/*#__PURE__*/_jsx(TimeoutLabel,{children:/*#__PURE__*/_jsx(Trans,{id:\"sec\"})})]})})]}),/*#__PURE__*/_jsx(FormGroup,{fieldId:\"convergence\",label:/*i18n*/i18n._(\"Convergence\"),isRequired:true,labelIcon:/*#__PURE__*/_jsx(Popover,{content:/*#__PURE__*/_jsxs(_Fragment,{children:[/*i18n*/i18n._(\"Preconditions for running this node when there are multiple parents. Refer to the\"),' ',/*#__PURE__*/_jsx(\"a\",{href:\"\".concat(getDocsBaseUrl(config),\"/html/userguide/workflow_templates.html#convergence-node\"),target:\"_blank\",rel:\"noopener noreferrer\",children:/*i18n*/i18n._(\"documentation\")}),' ',/*i18n*/i18n._(\"for more info.\")]})}),children:/*#__PURE__*/_jsxs(Select,{variant:SelectVariant.single,isOpen:isConvergenceOpen,selections:convergenceField.value,onToggle:setIsConvergenceOpen,onSelect:function onSelect(event,selection){convergenceFieldHelpers.setValue(selection);setIsConvergenceOpen(false);},\"aria-label\":/*i18n*/i18n._(\"Convergence select\"),typeAheadAriaLabel:/*i18n*/i18n._(\"Convergence select\"),className:\"convergenceSelect\",ouiaId:\"convergenceSelect\",noResultsFoundText:/*i18n*/i18n._(\"No results found\"),children:[/*#__PURE__*/_jsx(SelectOption,{value:\"any\",id:\"select-option-any\",children:/*i18n*/i18n._(\"Any\")},\"any\"),/*#__PURE__*/_jsx(SelectOption,{value:\"all\",id:\"select-option-all\",children:/*i18n*/i18n._(\"All\")},\"all\")]})}),/*#__PURE__*/_jsx(FormField,{id:\"node-alias\",name:\"identifier\",\"aria-label\":/*i18n*/i18n._(\"Node Alias\"),label:/*i18n*/i18n._(\"Node Alias\"),tooltip:/*i18n*/i18n._(\"If specified, this field will be shown on the node instead of the resource name when viewing the workflow\"),isRequired:isIdentifierRequired,validate:isIdentifierRequired?required(null):null,validated:isValid?'default':'error'})]})})})]});}export default NodeTypeStep;","map":{"version":3,"sources":["/awx_devel/awx/ui/src/screens/Template/WorkflowJobTemplateVisualizer/Modals/NodeModals/NodeTypeStep/NodeTypeStep.js"],"names":["React","useState","styled","useField","Alert","Form","FormGroup","TextInput","Select","SelectVariant","SelectOption","required","FormColumnLayout","FormFullWidthLayout","Popover","AnsibleSelect","FormField","getDocsBaseUrl","useConfig","useUserProfile","InventorySourcesList","JobTemplatesList","ProjectsList","SystemJobTemplatesList","WorkflowJobTemplatesList","NodeTypeErrorAlert","TimeoutInput","displayName","TimeoutLabel","p","NodeTypeStep","isIdentifierRequired","isSuperUser","nodeTypeField","nodeTypeHelpers","nodeResourceField","nodeResourceMeta","nodeResourceHelpers","approvalNameMeta","approvalNameHelpers","approvalDescriptionHelpers","timeoutMinutesField","timeoutMinutesHelpers","timeoutSecondsField","timeoutSecondsHelpers","convergenceField","convergenceFieldHelpers","isConvergenceOpen","setIsConvergenceOpen","config","isValid","touched","error","nodeTypeChoices","key","value","label","isDisabled","modifiedNodeTypeChoices","e","val","setValue","event","onChange","single","selection"],"mappings":"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","sourcesContent":["import 'styled-components/macro';\nimport React, { useState } from 'react';\nimport { t, Trans } from '@lingui/macro';\nimport styled from 'styled-components';\nimport { useField } from 'formik';\nimport {\n  Alert,\n  Form,\n  FormGroup,\n  TextInput,\n  Select,\n  SelectVariant,\n  SelectOption,\n} from '@patternfly/react-core';\nimport { required } from 'util/validators';\n\nimport { FormColumnLayout, FormFullWidthLayout } from 'components/FormLayout';\nimport Popover from 'components/Popover';\nimport AnsibleSelect from 'components/AnsibleSelect';\nimport FormField from 'components/FormField';\nimport getDocsBaseUrl from 'util/getDocsBaseUrl';\nimport { useConfig, useUserProfile } from 'contexts/Config';\nimport InventorySourcesList from './InventorySourcesList';\nimport JobTemplatesList from './JobTemplatesList';\nimport ProjectsList from './ProjectsList';\nimport SystemJobTemplatesList from './SystemJobTemplatesList';\nimport WorkflowJobTemplatesList from './WorkflowJobTemplatesList';\n\nconst NodeTypeErrorAlert = styled(Alert)`\n  margin-bottom: 20px;\n`;\n\nconst TimeoutInput = styled(TextInput)`\n  width: 200px !important;\n  :not(:first-of-type) {\n    margin-left: 20px;\n  }\n`;\nTimeoutInput.displayName = 'TimeoutInput';\n\nconst TimeoutLabel = styled.p`\n  margin-left: 10px;\n  min-width: fit-content;\n`;\n\nfunction NodeTypeStep({ isIdentifierRequired }) {\n  const { isSuperUser } = useUserProfile();\n  const [nodeTypeField, , nodeTypeHelpers] = useField('nodeType');\n  const [nodeResourceField, nodeResourceMeta, nodeResourceHelpers] =\n    useField('nodeResource');\n  const [, approvalNameMeta, approvalNameHelpers] = useField('approvalName');\n  const [, , approvalDescriptionHelpers] = useField('approvalDescription');\n  const [timeoutMinutesField, , timeoutMinutesHelpers] =\n    useField('timeoutMinutes');\n  const [timeoutSecondsField, , timeoutSecondsHelpers] =\n    useField('timeoutSeconds');\n  const [convergenceField, , convergenceFieldHelpers] = useField('convergence');\n\n  const [isConvergenceOpen, setIsConvergenceOpen] = useState(false);\n  const config = useConfig();\n\n  const isValid = !approvalNameMeta.touched || !approvalNameMeta.error;\n  const nodeTypeChoices = [\n    {\n      key: 'workflow_approval_template',\n      value: 'workflow_approval_template',\n      label: t`Approval`,\n      isDisabled: false,\n    },\n    {\n      key: 'inventory_source',\n      value: 'inventory_source',\n      label: t`Inventory Source Sync`,\n      isDisabled: false,\n    },\n    {\n      key: 'job_template',\n      value: 'job_template',\n      label: t`Job Template`,\n      isDisabled: false,\n    },\n    {\n      key: 'project',\n      value: 'project',\n      label: t`Project Sync`,\n      isDisabled: false,\n    },\n    {\n      key: 'workflow_job_template',\n      value: 'workflow_job_template',\n      label: t`Workflow Job Template`,\n      isDisabled: false,\n    },\n  ];\n\n  const modifiedNodeTypeChoices = isSuperUser\n    ? [\n        ...nodeTypeChoices,\n        {\n          key: 'system_job_template',\n          value: 'system_job_template',\n          label: t`Management Job`,\n          isDisabled: false,\n        },\n      ]\n    : nodeTypeChoices;\n\n  return (\n    <>\n      {nodeResourceMeta.error && (\n        <NodeTypeErrorAlert\n          variant=\"danger\"\n          isInline\n          title={nodeResourceMeta.error}\n        />\n      )}\n      <div css=\"display: flex; align-items: center; margin-bottom: 20px;\">\n        <b css=\"margin-right: 24px\">{t`Node Type`}</b>\n        <div>\n          <AnsibleSelect\n            id=\"nodeResource-select\"\n            label={t`Select a Node Type`}\n            data={modifiedNodeTypeChoices}\n            value={nodeTypeField.value}\n            onChange={(e, val) => {\n              nodeTypeHelpers.setValue(val);\n              nodeResourceHelpers.setValue(null);\n              approvalNameHelpers.setValue('');\n              approvalDescriptionHelpers.setValue('');\n              timeoutMinutesHelpers.setValue(0);\n              timeoutSecondsHelpers.setValue(0);\n              convergenceFieldHelpers.setValue('any');\n            }}\n          />\n        </div>\n      </div>\n      {nodeTypeField.value === 'job_template' && (\n        <JobTemplatesList\n          nodeResource={nodeResourceField.value}\n          onUpdateNodeResource={nodeResourceHelpers.setValue}\n        />\n      )}\n      {nodeTypeField.value === 'project' && (\n        <ProjectsList\n          nodeResource={nodeResourceField.value}\n          onUpdateNodeResource={nodeResourceHelpers.setValue}\n        />\n      )}\n      {nodeTypeField.value === 'inventory_source' && (\n        <InventorySourcesList\n          nodeResource={nodeResourceField.value}\n          onUpdateNodeResource={nodeResourceHelpers.setValue}\n        />\n      )}\n      {nodeTypeField.value === 'system_job_template' && (\n        <SystemJobTemplatesList\n          nodeResource={nodeResourceField.value}\n          onUpdateNodeResource={nodeResourceHelpers.setValue}\n        />\n      )}\n      {nodeTypeField.value === 'workflow_job_template' && (\n        <WorkflowJobTemplatesList\n          nodeResource={nodeResourceField.value}\n          onUpdateNodeResource={nodeResourceHelpers.setValue}\n        />\n      )}\n      <Form css=\"margin-top: 20px;\">\n        <FormColumnLayout>\n          <FormFullWidthLayout>\n            {nodeTypeField.value === 'workflow_approval_template' && (\n              <>\n                <FormField\n                  name=\"approvalName\"\n                  id=\"approval-name\"\n                  isRequired\n                  validate={required(null)}\n                  validated={isValid ? 'default' : 'error'}\n                  label={t`Name`}\n                />\n                <FormField\n                  name=\"approvalDescription\"\n                  id=\"approval-description\"\n                  label={t`Description`}\n                />\n                <FormGroup\n                  label={t`Timeout`}\n                  fieldId=\"approval-timeout\"\n                  name=\"timeout\"\n                >\n                  <div css=\"display: flex;align-items: center;\">\n                    <TimeoutInput\n                      {...timeoutMinutesField}\n                      aria-label={t`Timeout minutes`}\n                      id=\"approval-timeout-minutes\"\n                      min=\"0\"\n                      onChange={(value, event) => {\n                        timeoutMinutesField.onChange(event);\n                      }}\n                      step=\"1\"\n                      type=\"number\"\n                    />\n                    <TimeoutLabel>\n                      <Trans>min</Trans>\n                    </TimeoutLabel>\n                    <TimeoutInput\n                      {...timeoutSecondsField}\n                      aria-label={t`Timeout seconds`}\n                      id=\"approval-timeout-seconds\"\n                      min=\"0\"\n                      onChange={(value, event) => {\n                        timeoutSecondsField.onChange(event);\n                      }}\n                      step=\"1\"\n                      type=\"number\"\n                    />\n                    <TimeoutLabel>\n                      <Trans>sec</Trans>\n                    </TimeoutLabel>\n                  </div>\n                </FormGroup>\n              </>\n            )}\n            <FormGroup\n              fieldId=\"convergence\"\n              label={t`Convergence`}\n              isRequired\n              labelIcon={\n                <Popover\n                  content={\n                    <>\n                      {t`Preconditions for running this node when there are multiple parents. Refer to the`}{' '}\n                      <a\n                        href={`${getDocsBaseUrl(\n                          config\n                        )}/html/userguide/workflow_templates.html#convergence-node`}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                      >\n                        {t`documentation`}\n                      </a>{' '}\n                      {t`for more info.`}\n                    </>\n                  }\n                />\n              }\n            >\n              <Select\n                variant={SelectVariant.single}\n                isOpen={isConvergenceOpen}\n                selections={convergenceField.value}\n                onToggle={setIsConvergenceOpen}\n                onSelect={(event, selection) => {\n                  convergenceFieldHelpers.setValue(selection);\n                  setIsConvergenceOpen(false);\n                }}\n                aria-label={t`Convergence select`}\n                typeAheadAriaLabel={t`Convergence select`}\n                className=\"convergenceSelect\"\n                ouiaId=\"convergenceSelect\"\n                noResultsFoundText={t`No results found`}\n              >\n                <SelectOption key=\"any\" value=\"any\" id=\"select-option-any\">\n                  {t`Any`}\n                </SelectOption>\n                <SelectOption key=\"all\" value=\"all\" id=\"select-option-all\">\n                  {t`All`}\n                </SelectOption>\n              </Select>\n            </FormGroup>\n            <FormField\n              id=\"node-alias\"\n              name=\"identifier\"\n              aria-label={t`Node Alias`}\n              label={t`Node Alias`}\n              tooltip={t`If specified, this field will be shown on the node instead of the resource name when viewing the workflow`}\n              isRequired={isIdentifierRequired}\n              validate={isIdentifierRequired ? required(null) : null}\n              validated={isValid ? 'default' : 'error'}\n            />\n          </FormFullWidthLayout>\n        </FormColumnLayout>\n      </Form>\n    </>\n  );\n}\nexport default NodeTypeStep;\n"]},"metadata":{},"sourceType":"module"}